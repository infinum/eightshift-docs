# Async multi-select V2

import { ComponentShowcase } from '../components/component-showcase';
import { __AsyncMultiSelectNext } from '@eightshift/ui-components';
import { icons } from '@eightshift/ui-components/icons';
import { demoGetData, slugify } from './select-helpers';

:::info
This component is currently experimental. List of props is mostly stable, with no major changes expected.
However, there might be bugs, inconsistencies, or occasional layout issues.
<br />
Once fully stable, the component will be renamed to `AsyncMultiSelectNext`.
<br />
There are slight differences in behavior, compare to the previous `AsyncMultiSelect`:
- there are no remove buttons on each item, instead the items are removed by unselecting them in the dropdown
- `clearable` adds the *Clear* button below the list of options, instead of inline with the options
:::

<ComponentShowcase defaultValue={[]}>
	{(data, setData) => (
		<__AsyncMultiSelectNext
			value={data}
			onChange={setData}
			fetchUrl={(searchText) =>
				searchText?.length >= 3
					? `http://universities.hipolabs.com/search?limit=5&name=${searchText}`
					: 'http://universities.hipolabs.com/search?limit=5&country=croatia'
			}
			getLabel={(item) => item?.name}
			getValue={(item) => item?.value}
			getSubtitle={(item) => item?.country}
			getIcon={() => icons.emptyCircle}
			processLoadedOptions={(items) => items.map((item) => ({ ...item, value: slugify(item?.name) }))}
		/>
	)}
</ComponentShowcase>

```jsx
<__AsyncMultiSelectNext
	value={value}
	onChange={(value) => setValue(value)}
	fetchUrl={(searchText) =>
		searchText?.length >= 3 ? `http://example-api.com?limit=5&search=${searchText}` : 'http://example-api.com?limit=5'
	}
	getLabel={(item) => item?.name}
	getValue={(item) => item?.id}
/>
```

:::note
Props are mostly the same as for the [Single select](/components/es-ui-components/select-next),
with the exceptions of `options` and `simpleValue`.
:::

For the complete list of props, use your IDE's autocomplete functionality.

## Migration from `AsyncMultiSelect`

1. **Replace `loadOptions`**

	Custom loading functions are currently not supported.

	You can provide the URL to fetch the data from using the `fetchUrl` prop.
	It provides the search text as an argument.

	If you need to process data after fetching, use the `processLoadedOptions` prop.

2. **Define data points**

	To define how label, value, subtitle (optional), and icon (optional) are defined in the options,
	use `getLabel`, `getValue`, `getSubtitle`, `getIcon`.
