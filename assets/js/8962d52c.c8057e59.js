"use strict";(self.webpackChunk_eightshift_docs=self.webpackChunk_eightshift_docs||[]).push([[10454],{85763:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var s=t(74848),i=t(28453);const a={title:"Tips & useful features",description:"Various tips and useful features for your project included in Eightshift DevKit.",slug:"tips-useful-features",authors:"obradovic",date:new Date("2024-02-29T00:00:00.000Z"),tags:["eightshift","boilerplate","blocks","plugins","colors","images","classes"],hide_table_of_contents:!1},o=void 0,l={permalink:"/blog/tips-useful-features",source:"@site/blog/2024-02-29-tips-useful-features.md",title:"Tips & useful features",description:"Various tips and useful features for your project included in Eightshift DevKit.",date:"2024-02-29T00:00:00.000Z",tags:[{label:"eightshift",permalink:"/blog/tags/eightshift"},{label:"boilerplate",permalink:"/blog/tags/boilerplate"},{label:"blocks",permalink:"/blog/tags/blocks"},{label:"plugins",permalink:"/blog/tags/plugins"},{label:"colors",permalink:"/blog/tags/colors"},{label:"images",permalink:"/blog/tags/images"},{label:"classes",permalink:"/blog/tags/classes"}],readingTime:5.665,hasTruncateMarker:!0,authors:[{name:"Igor Obradovi\u0107",title:"WordPress Engineer",url:"https://github.com/iobrado",imageURL:"https://avatars.githubusercontent.com/u/23059501?v=4",key:"obradovic"}],frontMatter:{title:"Tips & useful features",description:"Various tips and useful features for your project included in Eightshift DevKit.",slug:"tips-useful-features",authors:"obradovic",date:"2024-02-29T00:00:00.000Z",tags:["eightshift","boilerplate","blocks","plugins","colors","images","classes"],hide_table_of_contents:!1},unlisted:!1,prevItem:{title:"Using inner blocks",permalink:"/blog/using-inner-blocks"},nextItem:{title:"Making your project multilingual",permalink:"/blog/making-your-project-multilingual"}},r={authorsImageUrls:[void 0]},c=[{value:"Using only Eightshift blocks",id:"using-only-eightshift-blocks",level:2},{value:"ModifyAdminAppearance class",id:"modifyadminappearance-class",level:2},{value:"EscapedView class",id:"escapedview-class",level:2},{value:"Media class",id:"media-class",level:2},{value:"Automatic WebP conversion",id:"automatic-webp-conversion",level:2},{value:"Dynamic cookies for WP Rocket",id:"dynamic-cookies-for-wp-rocket",level:2},{value:"Yoast SEO helper",id:"yoast-seo-helper",level:2},{value:"Linters and Coding Standards checks",id:"linters-and-coding-standards-checks",level:2}];function d(e){const n={admonition:"admonition",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Eightshift DevKit has lots of features that can make your development experience easier. These are mostly minor features which can\u2019t be a blog post of its own, so they\u2019ll be listed here. This isn\u2019t a complete list, so there may be a part 2 in the future."}),"\n",(0,s.jsx)(n.h2,{id:"using-only-eightshift-blocks",children:"Using only Eightshift blocks"}),"\n",(0,s.jsxs)(n.p,{children:["If you want to remove the default Gutenberg blocks and use only Eightshift blocks, it\u2019s as easy as adding the following code in your ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.em,{children:"src/Blocks/Blocks.php"})})," file:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Limits the usage of only custom project blocks.\n\\add_filter('allowed_block_types_all', [$this, 'getAllBlocksList'], 10, 2);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"modifyadminappearance-class",children:"ModifyAdminAppearance class"}),"\n",(0,s.jsxs)(n.p,{children:["When you have multiple environments (local, staging, production ...), you may accidentally change something on the wrong environment if you mix up your tabs. The ",(0,s.jsx)(n.code,{children:"ModifyAdminAppearance"})," class changes your WP Admin color scheme depending on the environment type defined with the ",(0,s.jsx)(n.code,{children:"WP_ENVIRONMENT_TYPE"})," constant. That way it\u2019s much easier to differentiate on which environment you are when you're in WP Admin."]}),"\n",(0,s.jsx)(n.p,{children:"Now when you get a call from the client asking you why the blog post they published isn\u2019t visible on the site, the first question you can ask is: \u201cWhat color is the admin area?\u201d \ud83d\ude04"}),"\n",(0,s.jsx)(n.p,{children:"To add it into your project, use the following WP-CLI command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"wp boilerplate create modify-admin-appearance\n"})}),"\n",(0,s.jsxs)(n.p,{children:["After adding this class to your project, all you have to do is define the proper environment type in the ",(0,s.jsx)(n.code,{children:"WP_ENVIRONMENT_TYPE"})," constant in ",(0,s.jsx)(n.em,{children:(0,s.jsx)(n.strong,{children:"wp-config.php."})})]}),"\n",(0,s.jsx)(n.p,{children:"The supported values are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"local"}),"\n",(0,s.jsx)(n.li,{children:"development"}),"\n",(0,s.jsx)(n.li,{children:"staging"}),"\n",(0,s.jsx)(n.li,{children:"production"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Different color schemes in WP Admin depending on the environment",src:t(59886).A+"",width:"1042",height:"562"})}),"\n",(0,s.jsxs)(n.p,{children:["If you want to change any of the colors, you can do so by modifying the values in ",(0,s.jsx)(n.code,{children:"COLOR_SCHEMES"})," array inside ",(0,s.jsx)(n.code,{children:"ModifyAdminAppearance"})," class. For the full list of available color schemes, you can navigate to ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.em,{children:"wp-admin/css/colors"})}),". The subfolders here represent the color schemes you can use. For example, if you want to change production environment color scheme to ",(0,s.jsx)(n.code,{children:"coffee"}),", you would do it like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"/**\n * List of admin color schemes.\n *\n * @var array<string, string>\n */\npublic const COLOR_SCHEMES = [\n\t'development' => 'fresh',\n\t'local' => 'fresh',\n\t'staging' => 'blue',\n\t'production' => 'coffee',\n];\n"})}),"\n",(0,s.jsx)(n.h2,{id:"escapedview-class",children:"EscapedView class"}),"\n",(0,s.jsx)(n.p,{children:"This class can be used to define which tags and attributes are escaped or allowed in your project. To add the class into your project, use the following WP-CLI command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"wp boilerplate create escaped-view\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Here\u2019s an example how to define the allowed tags so ",(0,s.jsx)(n.code,{children:"wp_kses"})," doesn\u2019t remove them:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\t/**\n\t * Add tags to allowed HTML list.\n\t *\n\t * @param array<string, array<mixed>> $tags Allowed tags.\n\t *\n\t * @return array<string, array<mixed>>\n\t */\n\tpublic function ksesAllowedHtml($tags): array\n\t{\n\t\t$tags['source'] = [\n\t\t\t'src' => [],\n\t\t\t'type' => [],\n\t\t];\n\n\t\t$tags['video'] = [\n\t\t\t'muted' => [],\n\t\t\t'src' => [],\n\t\t\t'autoplay' => [],\n\t\t\t// ...\n\t\t];\n\n\t\t$tags['div']['data-*'] = true;\n\n\t\treturn \\array_merge(\n\t\t\t$tags,\n\t\t\tstatic::SVG,\n\t\t\tstatic::FORM,\n\t\t\tstatic::IFRAME\n\t\t);\n\t}\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsx)(n.p,{children:"Please be wary of the attributes you allow, as this could expose your website to cross-site scripting (XSS) and similar attacks!"})}),"\n",(0,s.jsxs)(n.p,{children:["Don\u2019t forget to add this to the ",(0,s.jsx)(n.code,{children:"register"})," method:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\\add_filter('wp_kses_allowed_html', [$this, 'ksesAllowedHtml'], 20, 1);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"media-class",children:"Media class"}),"\n",(0,s.jsx)(n.p,{children:"To add the Media class to your project, use the following WP-CLI command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"wp boilerplate create media\n"})}),"\n",(0,s.jsx)(n.p,{children:"You can use the Media class to define new media sizes or allow uploads of the mime types that are not allowed by default."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\t/**\n\t * Allow additional types for uploads in media.\n\t *\n\t * @param array<string, string> $mimes Load all mimes types.\n\t *\n\t * @return array<string, string> Return original and updated.\n\t */\n\tpublic function enableMimeTypes(array $mimes): array\n\t{\n\t\t$mimes['svg']  = 'image/svg+xml';\n\t\t$mimes['zip']  = 'application/zip';\n\t\t$mimes['json'] = 'application/json';\n\n\t\treturn $mimes;\n\t}\n"})}),"\n",(0,s.jsx)(n.p,{children:"And register the filter:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\\add_filter('upload_mimes', [$this, 'enableMimeTypes']);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This class also supports converting your media into ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.em,{children:"WebP"})})," format, but more on that below."]}),"\n",(0,s.jsx)(n.h2,{id:"automatic-webp-conversion",children:"Automatic WebP conversion"}),"\n",(0,s.jsx)(n.p,{children:"The WebP file format is becoming more and more popular, with its smaller file sizes and better compression, it is a preferred replacement for .jpg and .png formats. Eightshift DevKit supports converting your existing files to WebP format."}),"\n",(0,s.jsx)(n.p,{children:"If you already have the Media class in your project, you need to run this WP-CLI command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"wp boilerplate create webp-media-column\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This command will add a new column in your ",(0,s.jsx)(n.em,{children:(0,s.jsx)(n.strong,{children:"List view"})})," in Media Library that shows if the media is converted to WebP or not."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"WebP column in Media Library",src:t(34564).A+"",width:"2100",height:"834"})}),"\n",(0,s.jsx)(n.p,{children:"To enable and convert existing media to WebP, run the following commands:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"wp boilerplate run use-webp-media\nwp boilerplate run regenerate-media\n"})}),"\n",(0,s.jsxs)(n.p,{children:["After running these commands, you\u2019ll have your images converted to WebP. Some formats like ",(0,s.jsx)(n.code,{children:"svg"})," will not be converted, this is intended."]}),"\n",(0,s.jsx)(n.p,{children:"Please note that the original files will not be deleted and you\u2019ll have to add additional logic to your Image component for replacing the URLs."}),"\n",(0,s.jsx)(n.p,{children:"Here\u2019s a simple example how to do it:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Check if webP is used from admin.\n$isWebPUsed = Components::isWebPMediaUsed();\n\n// If webP is used override the url for large.\nif ($isWebPUsed) {\n\t$sourceWebPLarge = Components::getWebPMedia($imageUrl['large'], Media::WEBP_ALLOWED_EXT);\n\n\tif ($sourceWebPLarge) {\n\t\t$imageUrl['large'] = $sourceWebPLarge['src'];\n\t}\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"dynamic-cookies-for-wp-rocket",children:"Dynamic cookies for WP Rocket"}),"\n",(0,s.jsx)(n.p,{children:"This is quite useful when you have a GDPR plugin and you have to take the cookie value into consideration when serving the cached version of the site."}),"\n",(0,s.jsx)(n.p,{children:"To add the GDPR cookie to the list of dynamic cookies, create a new class called Rocket with the following WP-CLI command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"wp boilerplate create service-example --folder=Plugins/Rocket --file_name=Rocket\n"})}),"\n",(0,s.jsx)(n.p,{children:"Add the following method to the Rocket class:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\t/**\n\t * List all dynamic cookies that will create new cached version.\n\t *\n\t * @param array<string> $items Items from the admin.\n\t *\n\t * @return array<string>\n\t */\n\tpublic function dynamicCookiesList(array $items): array\n\t{\n\t\t$items[] = 'gdpr';\n\n\t\treturn $items;\n\t}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Finally, add the following filter to the ",(0,s.jsx)(n.code,{children:"register"})," method:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\\add_filter('rocket_cache_dynamic_cookies', [$this, 'dynamicCookiesList']);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"yoast-seo-helper",children:"Yoast SEO helper"}),"\n",(0,s.jsx)(n.p,{children:"The content generated by Eightshift blocks may be difficult for Yoast SEO to interpret, but there is a Yoast SEO helper included in our DevKit that fixes the issue and makes the content readable to Yoast SEO. By default, Yoast SEO can't read the content from custom dynamic blocks, so this helper tells it how to parse the content from the blocks."}),"\n",(0,s.jsxs)(n.p,{children:["To enable this, you have to add the following in ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.em,{children:"src/Blocks/assets/scripts/application-blocks-editor.js"})}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import { yoastSeo } from '@eightshift/frontend-libs/scripts/plugins';\n\n// ...\n\nyoastSeo();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"linters-and-coding-standards-checks",children:"Linters and Coding Standards checks"}),"\n",(0,s.jsx)(n.p,{children:"Eightshift DevKit includes coding standards checks that will help you improve your code quality."}),"\n",(0,s.jsx)(n.p,{children:"To run these commands, you have to be in the theme root folder. Here\u2019s the list:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"npm run lintStyle"})," - check your CSS files with StyleLint"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"npm run lintJs"})," - check your JS files with ESLint"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"composer test:standards"})," - check PHP coding standards errors with PHPCS"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"composer test:types"})," - runs PHPStan static code analysis"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},59886:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/modify-admin-appearance-cc0e975f95d5dce4062cdeaf403a37d0.webp"},34564:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/webp-column-5f5ad6cace4b91fa19882b3060fda7b0.webp"},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var s=t(96540);const i={},a=s.createContext(i);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);