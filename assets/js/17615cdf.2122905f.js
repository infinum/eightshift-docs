"use strict";(self.webpackChunk_eightshift_docs=self.webpackChunk_eightshift_docs||[]).push([[57426],{28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var t=i(96540);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}},92725:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"migrations/13-14","title":"Version 13 to 14","description":"This migration guide contains migration instructions for:","source":"@site/docs/migrations/13-14.md","sourceDirName":"migrations","slug":"/migrations/13-14","permalink":"/docs/migrations/13-14","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"13-14","title":"Version 13 to 14"},"sidebar":"docs","previous":{"title":"Intro","permalink":"/docs/tutorials/intro"},"next":{"title":"Version 12 to 13","permalink":"/docs/migrations/12-13"}}');var s=i(74848),o=i(28453);const r={id:"13-14",title:"Version 13 to 14"},c=void 0,l={},a=[{value:"Eightshift Boilerplate Plugin",id:"eightshift-boilerplate-plugin",level:3},{value:"Eightshift Create repo",id:"eightshift-create-repo",level:3},{value:"Eightshift Boilerplate",id:"eightshift-boilerplate",level:3},{value:"Eightshift Libs",id:"eightshift-libs",level:2},{value:"<code>functions.php</code> file:",id:"functionsphp-file",level:3},{value:"<code>getViewComponent</code> method",id:"getviewcomponent-method",level:3},{value:"<code>classnames</code> method",id:"classnames-method",level:3},{value:"<code>Blocks.php</code> file:",id:"blocksphp-file",level:3},{value:"<code>Blocks&gt;manifest.json</code> file:",id:"blocksmanifestjson-file",level:3},{value:"<code>EnqueueAdmin.php</code> file:",id:"enqueueadminphp-file",level:3},{value:"<code>EnqueueTheme.php</code> file:",id:"enqueuethemephp-file",level:3},{value:"<code>EnqueueBlocks.php</code> file:",id:"enqueueblocksphp-file",level:3},{value:"Getting manifest data",id:"getting-manifest-data",level:3},{value:"<code>getProjectPaths</code> method",id:"getprojectpaths-method",level:3},{value:"Eightshift Frontend Libs / Tailwind",id:"eightshift-frontend-libs--tailwind",level:2},{value:"<code>webpack.config.js</code> file:",id:"webpackconfigjs-file",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"This migration guide contains migration instructions for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/infinum/eightshift-frontend-libs-tailwind/releases/tag/2.0.0",children:"eightshift/frontend-libs-tailwind"})," - ",(0,s.jsx)(n.strong,{children:"1+ --\x3e 2.0.0"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/infinum/eightshift-frontend-libs/releases/tag/13.0.0",children:"eightshift/frontend-libs"})," - ",(0,s.jsx)(n.strong,{children:"13-14+ --\x3e 15.0.0"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/infinum/eightshift-libs/releases/tag/8.0.0",children:"eightshift/libs"})," - ",(0,s.jsx)(n.strong,{children:"9+ --\x3e 10.0.0"})]}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{title:"Note",type:"caution",children:[(0,s.jsx)(n.p,{children:"This release is oriented in reducing the time and load necessary for maintaining the codebase. With this in mind we are discontinuing support for automatic project setup, initial block/components and all other scaffolding."}),(0,s.jsx)(n.h3,{id:"eightshift-boilerplate-plugin",children:"Eightshift Boilerplate Plugin"}),(0,s.jsxs)(n.p,{children:["We will discontinue the support for ",(0,s.jsx)(n.code,{children:"https://github.com/infinum/eightshift-boilerplate-plugin"})," and the contents of this repo will be archived. If you need scaffolding for plugin you can find it in the ",(0,s.jsx)(n.code,{children:"https://github.com/infinum/eightshift-boilerplate"})," repo."]}),(0,s.jsx)(n.h3,{id:"eightshift-create-repo",children:"Eightshift Create repo"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"https://github.com/infinum/eightshift-create"})," repo will be archived. All initial setup will be done manually. We will provide a guide on how to do this in the future."]}),(0,s.jsx)(n.h3,{id:"eightshift-boilerplate",children:"Eightshift Boilerplate"}),(0,s.jsxs)(n.p,{children:["In the future ",(0,s.jsx)(n.code,{children:"Eightshift Boilerplate"})," will probably not change in almost any way and it will be an empty setup that you can use or create manually."]}),(0,s.jsx)(n.p,{children:"We will provide WP-CLI commands that will help you with the setup of the boilerplate."})]}),"\n",(0,s.jsx)(n.h2,{id:"eightshift-libs",children:"Eightshift Libs"}),"\n",(0,s.jsxs)(n.h3,{id:"functionsphp-file",children:[(0,s.jsx)(n.code,{children:"functions.php"})," file:"]}),"\n",(0,s.jsx)(n.p,{children:"before"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"if (\\class_exists(ManifestCache::class)) {\n\t(new ManifestCache())->setAllCache();\n}\n\nif (\\class_exists(Main::class)) {\n\t(new Main($loader->getPrefixesPsr4(), __NAMESPACE__))->register();\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"after"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"if (\\class_exists(Main::class) && \\class_exists(ManifestCache::class)) {\n\t(new ManifestCache())->setAllCache();\n\t(new Main($loader->getPrefixesPsr4(), __NAMESPACE__))->register();\n}\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"getviewcomponent-method",children:[(0,s.jsx)(n.code,{children:"getViewComponent"})," method"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"getViewComponent"})," no longer automatically uses ",(0,s.jsx)(n.code,{children:"render"})," method, so if it is used in the project you need to render manually. Here are the changes you need to do:"]}),"\n",(0,s.jsx)(n.p,{children:"before"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"protected function getViewComponent(): string\n{\n\treturn 'admin-theme-options';\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"after"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"protected function getViewComponent(array $attributes): string\n{\n\treturn Helpers::render('admin-theme-options', $attributes);\n}\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"classnames-method",children:[(0,s.jsx)(n.code,{children:"classnames"})," method"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"classnames"})," helper method is deprecated and should be replaced with ",(0,s.jsx)(n.code,{children:"clsx"}),", the syntax remains the same."]}),"\n",(0,s.jsxs)(n.h3,{id:"blocksphp-file",children:[(0,s.jsx)(n.code,{children:"Blocks.php"})," file:"]}),"\n",(0,s.jsx)(n.p,{children:"There are significant changes in the backend on how blocks are registered so you can remove some filters. Here are the changes you need to do:"}),"\n",(0,s.jsx)(n.p,{children:"remove"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\\add_action('init', [$this, 'getBlocksDataFullRaw'], 10);\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"blocksmanifestjson-file",children:[(0,s.jsx)(n.code,{children:"Blocks>manifest.json"})," file:"]}),"\n",(0,s.jsxs)(n.p,{children:["You can remove some configuration keys if you are using ",(0,s.jsx)(n.code,{children:"@infinum/eightshift-frontend-libs"})," package. Here are the changes you should do:"]}),"\n",(0,s.jsx)(n.p,{children:"remove"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'"outputCssGlobally": true,\n"outputCssOptimize": true,\n"outputCssSelectorName": "esCssVariables",\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"enqueueadminphp-file",children:[(0,s.jsx)(n.code,{children:"EnqueueAdmin.php"})," file:"]}),"\n",(0,s.jsxs)(n.p,{children:["Abstract functions from ",(0,s.jsx)(n.code,{children:"AbstractEnqueueAdmin"})," have changed:"]}),"\n",(0,s.jsx)(n.p,{children:"before"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\\add_action('login_enqueue_scripts', [$this, 'enqueueStyles']);\n\\add_action('admin_enqueue_scripts', [$this, 'enqueueStyles'], 50);\n\\add_action('admin_enqueue_scripts', [$this, 'enqueueScripts']);\n"})}),"\n",(0,s.jsx)(n.p,{children:"after"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\\add_action('login_enqueue_scripts', [$this, 'enqueueAdminStyles']);\n\\add_action('admin_enqueue_scripts', [$this, 'enqueueAdminStyles'], 50);\n\\add_action('admin_enqueue_scripts', [$this, 'enqueueAdminScripts']);\n"})}),"\n",(0,s.jsx)(n.p,{children:"removed functions:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"isEnqueueStylesUsed\nisEnqueueScriptsUsed\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Changed functions",type:"caution",children:(0,s.jsx)(n.p,{children:"All action callback methods no longer have $hook param."})}),"\n",(0,s.jsxs)(n.h3,{id:"enqueuethemephp-file",children:[(0,s.jsx)(n.code,{children:"EnqueueTheme.php"})," file:"]}),"\n",(0,s.jsxs)(n.p,{children:["Abstract functions from ",(0,s.jsx)(n.code,{children:"AbstractEnqueueTheme"})," have changed:"]}),"\n",(0,s.jsx)(n.p,{children:"before"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\\add_action('wp_enqueue_scripts', [$this, 'enqueueStyles']);\n\\add_action('wp_enqueue_scripts', [$this, 'enqueueScripts']);\n"})}),"\n",(0,s.jsx)(n.p,{children:"after"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"\\add_action('wp_enqueue_scripts', [$this, 'enqueueThemeStyles']);\n\\add_action('wp_enqueue_scripts', [$this, 'enqueueThemeScripts']);\n"})}),"\n",(0,s.jsx)(n.p,{children:"removed functions:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"isEnqueueStylesUsed\nisEnqueueScriptsUsed\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Changed functions",type:"caution",children:(0,s.jsx)(n.p,{children:"All action callback methods no longer have $hook param."})}),"\n",(0,s.jsxs)(n.h3,{id:"enqueueblocksphp-file",children:[(0,s.jsx)(n.code,{children:"EnqueueBlocks.php"})," file:"]}),"\n",(0,s.jsxs)(n.p,{children:["Abstract functions from ",(0,s.jsx)(n.code,{children:"AbstractEnqueueBlocks"})," have changed:"]}),"\n",(0,s.jsx)(n.p,{children:"removed functions:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"isEnqueueBlockEditorScriptUsed\nisEnqueueBlockEditorStyleUsed\nisEnqueueBlockStyleUsed\nisEnqueueBlockFrontendScriptUsed\nisEnqueueBlockFrontendStyleUsed\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Changed functions",type:"caution",children:(0,s.jsx)(n.p,{children:"All action callback methods no longer have $hook param."})}),"\n",(0,s.jsx)(n.h3,{id:"getting-manifest-data",children:"Getting manifest data"}),"\n",(0,s.jsxs)(n.p,{children:["Every component and block now have ",(0,s.jsx)(n.code,{children:"$manifest"})," variable available by default."]}),"\n",(0,s.jsxs)(n.p,{children:["This means you can remove every instance of ",(0,s.jsx)(n.code,{children:"$manifest = Helpers::getManifestByDir(__DIR__);"})]}),"\n",(0,s.jsxs)(n.p,{children:["If you have a partial or need to get a manifest above in project file-tree e.g. ",(0,s.jsx)(n.code,{children:"$manifest = Helpers::getManifestByDir(dirname(__DIR__, 1));"})," you can replace the method with ",(0,s.jsx)(n.code,{children:"$manifest = Helpers::getBlock('{block-name}');"})," for a block or ",(0,s.jsx)(n.code,{children:"$manifest = Helpers::getComponent('{component-name}');"})," for a component."]}),"\n",(0,s.jsxs)(n.p,{children:["Also if you need global manifest it can be retrieved with ",(0,s.jsx)(n.code,{children:"getSettings"})," method from ",(0,s.jsx)(n.code,{children:"Helpers"})," class e.g. ",(0,s.jsx)(n.code,{children:"$globalManifest = Helpers::getSettings();"})]}),"\n",(0,s.jsxs)(n.p,{children:["PHPStan linter will report errors for the undefined ",(0,s.jsx)(n.code,{children:"$manifest"})," variable in all the modified files. This can be addressed by adding ",(0,s.jsx)(n.code,{children:"'#^Variable \\$manifest might not be defined\\.#'"})," to ",(0,s.jsx)(n.code,{children:"ignoreErrors"})," attribute of ",(0,s.jsx)(n.code,{children:"phpstan.neon.dist"})," file."]}),"\n",(0,s.jsxs)(n.h3,{id:"getprojectpaths-method",children:[(0,s.jsx)(n.code,{children:"getProjectPaths"})," method"]}),"\n",(0,s.jsxs)(n.p,{children:["If you had a ",(0,s.jsx)(n.code,{children:"Helpers::getProjectPaths('projectRoot')"})," replace it with ",(0,s.jsx)(n.code,{children:"Helpers::getProjectPaths('root')"}),";"]}),"\n",(0,s.jsx)(n.h2,{id:"eightshift-frontend-libs--tailwind",children:"Eightshift Frontend Libs / Tailwind"}),"\n",(0,s.jsxs)(n.p,{children:["Eightshift Frontend Libs repo is now dependant on the ",(0,s.jsx)(n.code,{children:"@infinum/eightshift-ui-components: 3.0.0+"})," package. You don't need to install it but if you are using any kind of Editor components from the ",(0,s.jsx)(n.code,{children:"@infinum/eightshift-frontend-libs"})," package you need to install it."]}),"\n",(0,s.jsxs)(n.h3,{id:"webpackconfigjs-file",children:[(0,s.jsx)(n.code,{children:"webpack.config.js"})," file:"]}),"\n",(0,s.jsxs)(n.p,{children:["All application files are now loaded from the ",(0,s.jsx)(n.code,{children:"src/Blocks>assets"})," folder. And the ",(0,s.jsx)(n.code,{children:"assets"})," folder is discontinued. You need to move all your files from the ",(0,s.jsx)(n.code,{children:"assets"})," folder to the ",(0,s.jsx)(n.code,{children:"src/Blocks>assets"})," folder or create a manual ",(0,s.jsx)(n.code,{children:"webpack.config.js"})," configuration for ",(0,s.jsx)(n.code,{children:"application"})," and ",(0,s.jsx)(n.code,{children:"applicationAdmin"})," entry points. We strongly recommend using the ",(0,s.jsx)(n.code,{children:"src/Blocks>assets"})," folder."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"webpack.config.js"})," should be renamed to ",(0,s.jsx)(n.code,{children:"webpack.config.mjs"})]}),"\n",(0,s.jsx)(n.p,{children:"before"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const path = require('path');\n\nmodule.exports = (env, argv) => {\n\n\tconst projectConfig = {\n\t\tconfig: {\n\t\t\tprojectDir: __dirname, // Current project directory absolute path.\n\t\t\tprojectPath: 'wp-content/themes/redesign', // Project path relative to project root.\n\t\t},\n\t};\n\n\t// Generate Webpack config for this project using options object.\n\tconst project = require('@eightshift/frontend-libs/webpack')(argv.mode, projectConfig);\n\n\treturn {\n\t\t...project,\n\t\tentry: {\n\t\t\t...project.entry,\n\t\t\tapplicationNoScript: path.join(projectConfig.config.projectDir, '/src/Blocks/assets/application-no-script.js'),\n\t\t},\n\t};\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:"after"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"import path from 'path';\nimport { fileURLToPath } from 'url';\nimport { eightshiftConfig } from '@eightshift/frontend-libs/webpack/index.mjs';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nexport default (_, argv) => {\n\tconst projectConfig = {\n\t\tconfig: {\n\t\t\tprojectDir: __dirname, // Current project directory absolute path.\n\t\t\tprojectPath: 'wp-content/themes/redesign', // Project path relative to project root.\n\t\t},\n\t};\n\n\t// Generate Webpack config for this project using options object.\n\tconst config = eightshiftConfig(argv.mode, projectConfig);\n\n\treturn {\n\t\t...config,\n\t\tentry: {\n\t\t\t...config.entry,\n\t\t\tapplicationNoScript: path.join(projectConfig.config.projectDir, '/src/Blocks/assets/application-no-script.js'),\n\t\t},\n\t};\n};\n"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);