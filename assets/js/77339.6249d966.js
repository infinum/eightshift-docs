/*! For license information please see 77339.6249d966.js.LICENSE.txt */
"use strict";(self.webpackChunk_eightshift_docs=self.webpackChunk_eightshift_docs||[]).push([[77339],{28453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>a});var n=r(96540);const s={},o=n.createContext(s);function i(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(o.Provider,{value:t},e.children)}},23271:(e,t,r)=>{r.d(t,{QH:()=>la,XT:()=>B,gT:()=>G});const n=typeof process<"u"&&"node"===(null==(s=process.release)?void 0:s.name)?"NODE":typeof window<"u"?"WEB":typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?"WORKER":"NODE";var s;if("NODE"===n){let e=function(e){return new Promise((function(t,r){e.onload=e.onerror=function(n){e.onload=e.onerror=null,"load"===n.type?t(e.result):r(new Error("Failed to read the blob/file"))}}))},t=function(){const e=new Uint8Array([1,2,3,4]),t=new File([e],"test").stream();try{return t.getReader({mode:"byob"}),!0}catch{return!1}};if(typeof File>"u"){class e extends Blob{constructor(e,t,r){let n;super(e),null!=r&&r.lastModified&&(n=new Date),(!n||isNaN(n.getFullYear()))&&(n=new Date),this.lastModifiedDate=n,this.lastModified=n.getMilliseconds(),this.name=t||""}}global.File=e}typeof Blob.prototype.arrayBuffer>"u"&&(Blob.prototype.arrayBuffer=function(){const t=new FileReader;return t.readAsArrayBuffer(this),e(t)}),typeof Blob.prototype.text>"u"&&(Blob.prototype.text=function(){const t=new FileReader;return t.readAsText(this),e(t)}),(typeof Blob.prototype.stream>"u"||!t())&&(Blob.prototype.stream=function(){let e=0;const t=this;return new ReadableStream({type:"bytes",autoAllocateChunkSize:524288,async pull(r){const n=r.byobRequest.view,s=await t.slice(e,e+n.byteLength).arrayBuffer(),o=new Uint8Array(s);new Uint8Array(n.buffer).set(o);const i=o.byteLength;r.byobRequest.respond(i),e+=i,e>=t.size&&r.close()}})})}if("NODE"===n&&typeof CustomEvent>"u"){class e extends Event{constructor(e,t={}){super(e,t),this.detail=t.detail}initCustomEvent(){}}globalThis.CustomEvent=e}const o=["db.php","plugins/akismet","plugins/hello.php","plugins/wordpress-importer","mu-plugins/sqlite-database-integration","mu-plugins/playground-includes","mu-plugins/0-playground.php","mu-plugins/0-sqlite.php","themes/twentytwenty","themes/twentytwentyone","themes/twentytwentytwo","themes/twentytwentythree","themes/twentytwentyfour","themes/twentytwentyfive","themes/twentytwentysix"],i=Symbol("SleepFinished");function a(e){return new Promise((t=>{setTimeout((()=>t(i)),e)}))}class c extends Error{constructor(){super("Acquiring lock timed out")}}class l{constructor({concurrency:e,timeout:t}){this._running=0,this.concurrency=e,this.timeout=t,this.queue=[]}get remaining(){return this.concurrency-this.running}get running(){return this._running}async acquire(){for(;;){if(!(this._running>=this.concurrency)){this._running++;let e=!1;return()=>{e||(e=!0,this._running--,this.queue.length>0&&this.queue.shift()())}}{const e=new Promise((e=>{this.queue.push(e)}));void 0!==this.timeout?await Promise.race([e,a(this.timeout)]).then((e=>{if(e===i)throw new c})):await e}}}async run(e){const t=await this.acquire();try{return await e()}finally{t()}}}function p(...e){let t=e.join("/");const r="/"===t[0],n="/"===t.substring(t.length-1);return t=u(t),!t&&!r&&(t="."),t&&n&&(t+="/"),t}function d(e){if("/"===e)return"/";const t=(e=u(e)).lastIndexOf("/");return-1===t?"":0===t?"/":e.substr(0,t)}function u(e){const t="/"===e[0];return e=function(e,t){let r=0;for(let n=e.length-1;n>=0;n--){const t=e[n];"."===t?e.splice(n,1):".."===t?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e}(e.split("/").filter((e=>!!e)),!t).join("/"),(t?"/":"")+e.replace(/\/$/,"")}function h(e=36,t="!@#$%^&*()_+=-[]/.,<>?"){const r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"+t;let n="";for(let s=e;s>0;--s)n+=r[Math.floor(Math.random()*r.length)];return n}function f(e){return`json_decode(base64_decode('${function(e){return function(e){const t=String.fromCodePoint(...e);return btoa(t)}((new TextEncoder).encode(e))}(JSON.stringify(e))}'), true)`}function m(e){const t={};for(const r in e)t[r]=f(e[r]);return t}const y=(e,...t)=>{b.dispatchEvent(new CustomEvent("playground-log",{detail:{log:e,args:t}}))},g=(e,...t)=>{switch("string"==typeof e.message?e.message=E(e.message):e.message.message&&"string"==typeof e.message.message&&(e.message.message=E(e.message.message)),e.severity){case"Debug":console.debug(e.message,...t);break;case"Info":console.info(e.message,...t);break;case"Warn":console.warn(e.message,...t);break;case"Error":case"Fatal":console.error(e.message,...t);break;default:console.log(e.message,...t)}},v=[],w=e=>{v.push(e)},$=e=>{if(!0===e.raw)w(e.message);else{const t=P("object"==typeof e.message?(e=>e instanceof Error?[e.message,e.stack].join("\n"):JSON.stringify(e,null,2))(e.message):e.message,e.severity??"Info",e.prefix??"JavaScript");w(t)}};class _ extends EventTarget{constructor(e=[]){super(),this.handlers=e,this.fatalErrorEvent="playground-fatal-error"}getLogs(){return this.handlers.includes($)?[...v]:(this.error("Logs aren't stored because the logToMemory handler isn't registered.\n\t\t\t\tIf you're using a custom logger instance, make sure to register logToMemory handler.\n\t\t\t"),[])}logMessage(e,...t){for(const r of this.handlers)r(e,...t)}log(e,...t){this.logMessage({message:e,severity:void 0,prefix:"JavaScript",raw:!1},...t)}debug(e,...t){this.logMessage({message:e,severity:"Debug",prefix:"JavaScript",raw:!1},...t)}info(e,...t){this.logMessage({message:e,severity:"Info",prefix:"JavaScript",raw:!1},...t)}warn(e,...t){this.logMessage({message:e,severity:"Warn",prefix:"JavaScript",raw:!1},...t)}error(e,...t){this.logMessage({message:e,severity:"Error",prefix:"JavaScript",raw:!1},...t)}}const b=new _((()=>{try{0}catch{}return[$,g,y]})()),E=e=>e.replace(/\t/g,""),P=(e,t,r)=>{const n=new Date;return`[${new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"short",day:"2-digit",timeZone:"UTC"}).format(n).replace(/ /g,"-")+" "+new Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"UTC",timeZoneName:"short"}).format(n)}] ${r} ${t}: ${e=E(e)}`};let S=0;const k="/wordpress/wp-content/debug.log",T=(e,t)=>{t.addEventListener("request.end",(async()=>{const r=await(async e=>await e.fileExists(k)?await e.readFileAsText(k):"")(t);if(r.length>S){const t=r.substring(S);e.logMessage({message:t,raw:!0}),S=r.length}})),t.addEventListener("request.error",(t=>{t.error&&(e.logMessage({message:`${t.error.message} ${t.error.stack}`,severity:"Fatal",prefix:"request"===t.source?"PHP":"WASM Crash"}),e.dispatchEvent(new CustomEvent(e.fatalErrorEvent,{detail:{logs:e.getLogs(),source:t.source}})))}))},C=async(e,{pluginPath:t,pluginName:r},n)=>{null==n||n.tracker.setCaption(`Activating ${r||t}`);const s=await e.documentRoot,o=await e.run({code:`<?php\n\t\t\tdefine( 'WP_ADMIN', true );\n\t\t\trequire_once( ${f(s)}. "/wp-load.php" );\n\t\t\trequire_once( ${f(s)}. "/wp-admin/includes/plugin.php" );\n\n\t\t\t// Set current user to admin\n\t\t\twp_set_current_user( get_users(array('role' => 'Administrator') )[0]->ID );\n\n\t\t\t$plugin_path = ${f(t)};\n\t\t\t$response = false;\n\t\t\tif (!is_dir($plugin_path)) {\n\t\t\t\t$response = activate_plugin($plugin_path);\n\t\t\t}\n\n\t\t\t// Activate plugin by name if activation by path wasn't successful\n\t\t\tif ( null !== $response ) {\n\t\t\t\tforeach ( ( glob( $plugin_path . '/*.php' ) ?: array() ) as $file ) {\n\t\t\t\t\t$info = get_plugin_data( $file, false, false );\n\t\t\t\t\tif ( ! empty( $info['Name'] ) ) {\n\t\t\t\t\t\t$response = activate_plugin( $file );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( null === $response ) {\n\t\t\t\tdie('Plugin activated successfully');\n\t\t\t} else if ( is_wp_error( $response ) ) {\n\t\t\t\tthrow new Exception( $response->get_error_message() );\n\t\t\t}\n\n\t\t\tthrow new Exception( 'Unable to activate plugin' );\n\t\t`});if("Plugin activated successfully"!==o.text)throw b.debug(o),new Error(`Plugin ${t} could not be activated \u2013 WordPress exited with no error. Sometimes, when $_SERVER or site options are not configured correctly, WordPress exits early with a 301 redirect. Inspect the "debug" logs in the console for more details`)},x=async(e,{themeFolderName:t},r)=>{null==r||r.tracker.setCaption(`Activating ${t}`);const n=await e.documentRoot,s=`${n}/wp-content/themes/${t}`;if(!await e.fileExists(s))throw new Error(`\n\t\t\tCouldn't activate theme ${t}.\n\t\t\tTheme not found at the provided theme path: ${s}.\n\t\t\tCheck the theme path to ensure it's correct.\n\t\t\tIf the theme is not installed, you can install it using the installTheme step.\n\t\t\tMore info can be found in the Blueprint documentation: https://wordpress.github.io/wordpress-playground/blueprints-api/steps/#ActivateThemeStep\n\t\t`);const o=await e.run({code:"<?php\n\t\t\tdefine( 'WP_ADMIN', true );\n\t\t\trequire_once( getenv('docroot') . \"/wp-load.php\" );\n\n\t\t\t// Set current user to admin\n\t\t\twp_set_current_user( get_users(array('role' => 'Administrator') )[0]->ID );\n\n\t\t\tswitch_theme( getenv('themeFolderName') );\n\n\t\t\tif( wp_get_theme()->get_stylesheet() !== getenv('themeFolderName') ) {\n\t\t\t\tthrow new Exception( 'Theme ' . getenv('themeFolderName') . ' could not be activated.' );\t\t\t\t\n\t\t\t}\n\t\t\tdie('Theme activated successfully');\n\t\t",env:{docroot:n,themeFolderName:t}});if("Theme activated successfully"!==o.text)throw b.debug(o),new Error(`Theme ${t} could not be activated \u2013 WordPress exited with no error. Sometimes, when $_SERVER or site options are not configured correctly, WordPress exits early with a 301 redirect. Inspect the "debug" logs in the console for more details`)},R=async(e,{path:t})=>{await e.unlink(t)},N=async(e,{request:t})=>{b.warn('Deprecated: The Blueprint step "request" is deprecated and will be removed in a future release.');const r=await e.request(t);if(r.httpStatusCode>399||r.httpStatusCode<200)throw b.warn("WordPress response was",{response:r}),new Error(`Request failed with status ${r.httpStatusCode}`);return r},j="<?php\n\n/**\n * Rewrites the wp-config.php file to ensure specific constants are defined\n * with specific values.\n * \n * Example:\n * \n * ```php\n * <?php\n * define('WP_DEBUG', true);\n * // The third define() argument is also supported:\n * define('SAVEQUERIES', false, true);\n * \n * // Expression\n * define(true ? 'WP_DEBUG_LOG' : 'WP_DEBUG_LOG', 123);\n * \n * // Guarded expressions shouldn't be wrapped twice\n * if(!defined(1 ? 'A' : 'B')) {\n *     define(1 ? 'A' : 'B', 0);\n * }\n * \n * // More advanced expression\n * define((function() use($x) {\n *     return [$x, 'a'];\n * })(), 123);\n * ```\n * \n * Rewritten with\n * \n *     $constants = [\n *        'WP_DEBUG' => false,\n *        'WP_DEBUG_LOG' => true,\n *        'SAVEQUERIES' => true,\n *        'NEW_CONSTANT' => \"new constant\",\n *     ];\n * \n * ```php\n * <?php\n * define('WP_DEBUG_LOG',true);\n * define('NEW_CONSTANT','new constant');\n * ?><?php\n * define('WP_DEBUG',false);\n * // The third define() argument is also supported:\n * define('SAVEQUERIES',true, true);\n * \n * // Expression\n * if(!defined($const ? 'WP_DEBUG_LOG' : 'WP_DEBUG_LOG')) {\n *      define($const ? 'WP_DEBUG_LOG' : 'WP_DEBUG_LOG', 123);\n * }\n * \n * // Guarded expressions shouldn't be wrapped twice\n * if(!defined(1 ? 'A' : 'B')) {\n *     define(1 ? 'A' : 'B', 0);\n * }\n * \n * // More advanced expression\n * if(!defined((function() use($x) {\n *    return [$x, 'a'];\n * })())) {\n *     define((function() use($x) {\n *         return [$x, 'a'];\n *     })(), 123);\n * }\n * ```\n * \n * @param mixed $content\n * @return string\n */\nfunction rewrite_wp_config_to_define_constants($content, $constants = [])\n{\n    $tokens = array_reverse(token_get_all($content));\n    $output = [];\n    $defined_expressions = [];\n\n    // Look through all the tokens and find the define calls\n    do {\n        $buffer = [];\n        $name_buffer = [];\n        $value_buffer = [];\n        $third_arg_buffer = [];\n\n        // Capture everything until the define call into output.\n        // Capturing the define call into a buffer.\n        // Example:\n        //     <?php echo 'a'; define  (\n        //     ^^^^^^^^^^^^^^^^^^^^^^\n        //           output   |buffer\n        while ($token = array_pop($tokens)) {\n            if (is_array($token) && $token[0] === T_STRING && (strtolower($token[1]) === 'define' || strtolower($token[1]) === 'defined')) {\n                $buffer[] = $token;\n                break;\n            }\n            $output[] = $token;\n        }\n\n        // Maybe we didn't find a define call and reached the end of the file?\n        if (!count($tokens)) {\n            break;\n        }\n\n        // Keep track of the \"defined\" expressions that are already accounted for\n        if($token[1] === 'defined') {\n            $output[] = $token;\n            $defined_expression = [];\n            $open_parenthesis = 0;\n            // Capture everything up to the opening parenthesis, including the parenthesis\n            // e.g. defined  (\n            //           ^^^^\n            while ($token = array_pop($tokens)) {\n                $output[] = $token;\n                if ($token === \"(\") {\n                    ++$open_parenthesis;\n                    break;\n                }\n            }\n\n            // Capture everything up to the closing parenthesis, including the parenthesis\n            // e.g. defined  (\n            //           ^^^^\n            while ($token = array_pop($tokens)) {\n                $output[] = $token;\n                if ($token === \")\") {\n                    --$open_parenthesis;\n                }\n                if ($open_parenthesis === 0) {\n                    break;\n                }\n                $defined_expression[] = $token;\n            }\n\n            $defined_expressions[] = stringify_tokens(skip_whitespace($defined_expression));\n            continue;\n        }\n\n        // Capture everything up to the opening parenthesis, including the parenthesis\n        // e.g. define  (\n        //           ^^^^\n        while ($token = array_pop($tokens)) {\n            $buffer[] = $token;\n            if ($token === \"(\") {\n                break;\n            }\n        }\n\n        // Capture the first argument \u2013 it's the first expression after the opening\n        // parenthesis and before the comma:\n        // Examples:\n        //     define(\"WP_DEBUG\", true);\n        //            ^^^^^^^^^^^\n        //\n        //     define(count([1,2]) > 2 ? 'WP_DEBUG' : 'FOO', true);\n        //            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        $open_parenthesis = 0;\n        while ($token = array_pop($tokens)) {\n            $buffer[] = $token;\n            if ($token === \"(\" || $token === \"[\" || $token === \"{\") {\n                ++$open_parenthesis;\n            } elseif ($token === \")\" || $token === \"]\" || $token === \"}\") {\n                --$open_parenthesis;\n            } elseif ($token === \",\" && $open_parenthesis === 0) {\n                break;\n            }\n\n            // Don't capture the comma as a part of the constant name\n            $name_buffer[] = $token;\n        }\n\n        // Capture everything until the closing parenthesis\n        //     define(\"WP_DEBUG\", true);\n        //                       ^^^^^^\n        $open_parenthesis = 0;\n        $is_second_argument = true;\n        while ($token = array_pop($tokens)) {\n            $buffer[] = $token;\n            if ($token === \")\" && $open_parenthesis === 0) {\n                // Final parenthesis of the define call.\n                break;\n            } else if ($token === \"(\" || $token === \"[\" || $token === \"{\") {\n                ++$open_parenthesis;\n            } elseif ($token === \")\" || $token === \"]\" || $token === \"}\") {\n                --$open_parenthesis;\n            } elseif ($token === \",\" && $open_parenthesis === 0) {\n                // This define call has more than 2 arguments! The third one is the\n                // boolean value indicating $is_case_insensitive. Let's continue capturing\n                // to $third_arg_buffer.\n                $is_second_argument = false;\n            }\n            if ($is_second_argument) {\n                $value_buffer[] = $token;\n            } else {\n                $third_arg_buffer[] = $token;\n            }\n        }\n\n        // Capture until the semicolon\n        //     define(\"WP_DEBUG\", true)  ;\n        //                             ^^^\n        while ($token = array_pop($tokens)) {\n            $buffer[] = $token;\n            if ($token === \";\") {\n                break;\n            }\n        }\n\n        // Decide whether $name_buffer is a constant name or an expression\n        $name_token = null;\n        $name_token_index = $token;\n        $name_is_literal = true;\n        foreach ($name_buffer as $k => $token) {\n            if (is_array($token)) {\n                if ($token[0] === T_WHITESPACE || $token[0] === T_COMMENT || $token[0] === T_DOC_COMMENT) {\n                    continue;\n                } else if ($token[0] === T_STRING || $token[0] === T_CONSTANT_ENCAPSED_STRING) {\n                    $name_token = $token;\n                    $name_token_index = $k;\n                } else {\n                    $name_is_literal = false;\n                    break;\n                }\n            } else if ($token !== \"(\" && $token !== \")\") {\n                $name_is_literal = false;\n                break;\n            }\n        }\n\n        // We can't handle expressions as constant names. Let's wrap that define\n        // call in an if(!defined()) statement, just in case it collides with\n        // a constant name.\n        if (!$name_is_literal) {\n            // Ensure the defined expression is not already accounted for\n            foreach ($defined_expressions as $defined_expression) {\n                if ($defined_expression === stringify_tokens(skip_whitespace($name_buffer))) {\n                    $output = array_merge($output, $buffer);\n                    continue 2;\n                }\n            }\n            $output = array_merge(\n                $output,\n                [\"if(!defined(\"],\n                $name_buffer,\n                [\")) {\\n     \"],\n                ['define('],\n                $name_buffer,\n                [','],\n                $value_buffer,\n                $third_arg_buffer,\n                [\");\"],\n                [\"\\n}\\n\"]\n            );\n            continue;\n        }\n\n        // Yay, we have a literal constant name in the buffer now. Let's\n        // get its value:\n        $name = eval('return ' . $name_token[1] . ';');\n\n        // If the constant name is not in the list of constants we're looking,\n        // we can ignore it.\n        if (!array_key_exists($name, $constants)) {\n            $output = array_merge($output, $buffer);\n            continue;\n        }\n\n        // We now have a define() call that defines a constant we're looking for.\n        // Let's rewrite its value to the one \n        $output = array_merge(\n            $output,\n            ['define('],\n            $name_buffer,\n            [','],\n            [var_export($constants[$name], true)],\n            $third_arg_buffer,\n            [\");\"]\n        );\n\n        // Remove the constant from the list so we can process any remaining\n        // constants later.\n        unset($constants[$name]);\n    } while (count($tokens));\n\n    // Add any constants that weren't found in the file\n    if (count($constants)) {\n        $prepend = [\n            \"<?php \\n\"\n        ];\n        foreach ($constants as $name => $value) {\n            $prepend = array_merge(\n                $prepend,\n                [\n                    \"define(\",\n                    var_export($name, true),\n                    ',',\n                    var_export($value, true),\n                    \");\\n\"\n                ]\n            );\n        }\n        $prepend[] = \"?>\";\n        $output = array_merge(\n            $prepend,\n            $output\n        );\n    }\n\n    // Translate the output tokens back into a string\n    return stringify_tokens($output);\n}\n\nfunction stringify_tokens($tokens) {\n    $output = '';\n    foreach ($tokens as $token) {\n        if (is_array($token)) {\n            $output .= $token[1];\n        } else {\n            $output .= $token;\n        }\n    }\n    return $output;\n}\n\nfunction skip_whitespace($tokens) {\n    $output = [];\n    foreach ($tokens as $token) {\n        if (is_array($token) && ($token[0] === T_WHITESPACE || $token[0] === T_COMMENT || $token[0] === T_DOC_COMMENT)) {\n            continue;\n        }\n        $output[] = $token;\n    }\n    return $output;\n}\n",O=async(e,{consts:t,method:r="define-before-run"})=>{switch(r){case"define-before-run":await async function(e,t){for(const r in t)await e.defineConstant(r,t[r])}(e,t);break;case"rewrite-wp-config":{const r=p(await e.documentRoot,"/wp-config.php"),n=await e.readFileAsText(r),s=await async function(e,t,r){await e.writeFile("/tmp/code.php",t);const n=m({consts:r});return await e.run({code:`${j}\n\t$wp_config_path = '/tmp/code.php';\n\t$wp_config = file_get_contents($wp_config_path);\n\t$new_wp_config = rewrite_wp_config_to_define_constants($wp_config, ${n.consts});\n\tfile_put_contents($wp_config_path, $new_wp_config);\n\t`}),await e.readFileAsText("/tmp/code.php")}(e,n,t);await e.writeFile(r,s);break}default:throw new Error(`Invalid method: ${r}`)}};const I=async(e,{username:t="admin",password:r="password"}={},n)=>{var s,o,i;null==n||n.tracker.setCaption((null==n?void 0:n.initialCaption)||"Logging in"),await e.request({url:"/wp-login.php"});const a=await e.request({url:"/wp-login.php",method:"POST",body:{log:t,pwd:r,rememberme:"forever"}});if(null==(i=null==(o=null==(s=a.headers)?void 0:s.location)?void 0:o[0])||!i.includes("/wp-admin/"))throw b.warn("WordPress response was",{response:a,text:a.text}),new Error(`Failed to log in as ${t} with password ${r}`)},A=async(e,{options:t})=>{const r=await e.documentRoot;await e.run({code:`<?php\n\t\tinclude ${f(r)} . '/wp-load.php';\n\t\t$site_options = ${f(t)};\n\t\tforeach($site_options as $name => $value) {\n\t\t\tupdate_option($name, $value);\n\t\t}\n\t\techo "Success";\n\t\t`})};function D(e){return e.pathname.startsWith("/scope:")}function M(e){return Object.keys(e).map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&")}const F=async(e,{path:t,data:r})=>{r instanceof File&&(r=new Uint8Array(await r.arrayBuffer())),t.startsWith("/wordpress/wp-content/mu-plugins")&&!await e.fileExists("/wordpress/wp-content/mu-plugins")&&await e.mkdir("/wordpress/wp-content/mu-plugins"),await e.writeFile(t,r)},L=async(e,{siteUrl:t})=>{await O(e,{consts:{WP_HOME:t,WP_SITEURL:t}})},q="/tmp/file.zip",U=async(e,{zipFile:t,zipPath:r,extractToPath:n})=>{if(r)b.warn('The "zipPath" option of the unzip() Blueprint step is deprecated and will be removed. Use "zipFile" instead.');else if(!t)throw new Error("Either zipPath or zipFile must be provided");await(async(e,t,r)=>{if(t instanceof File){const r=t;t=q,await e.writeFile(t,new Uint8Array(await r.arrayBuffer()))}const n=m({zipPath:t,extractToPath:r});await e.run({code:`<?php\n        function unzip($zipPath, $extractTo, $overwrite = true)\n        {\n            if (!is_dir($extractTo)) {\n                mkdir($extractTo, 0777, true);\n            }\n            $zip = new ZipArchive;\n            $res = $zip->open($zipPath);\n            if ($res === TRUE) {\n                $zip->extractTo($extractTo);\n                $zip->close();\n                chmod($extractTo, 0777);\n            } else {\n                throw new Exception("Could not unzip file");\n            }\n        }\n        unzip(${n.zipPath}, ${n.extractToPath});\n        `}),await e.fileExists(q)&&await e.unlink(q)})(e,t||r,n)};async function z(e,t){await e.fileExists(t)&&(await e.isDir(t)?await e.rmdir(t):await e.unlink(t))}async function V(e,{targetPath:t,zipFile:r,ifAlreadyInstalled:n="overwrite"}){const s=r.name.replace(/\.zip$/,""),o=p(await e.documentRoot,"wp-content"),i=p(o,h()),a=p(i,"assets",s);await e.fileExists(a)&&await e.rmdir(i,{recursive:!0}),await e.mkdir(i);try{await U(e,{zipFile:r,extractToPath:a});let o=await e.listFiles(a,{prependPath:!0});o=o.filter((e=>!e.endsWith("/__MACOSX")));const i=1===o.length&&await e.isDir(o[0]);let c,l="";i?(l=o[0],c=o[0].split("/").pop()):(l=a,c=s);const p=`${t}/${c}`;if(await e.fileExists(p)){if(!await e.isDir(p))throw new Error(`Cannot install asset ${c} to ${p} because a file with the same name already exists. Note it's a file, not a directory! Is this by mistake?`);if("overwrite"!==n){if("skip"===n)return{assetFolderPath:p,assetFolderName:c};throw new Error(`Cannot install asset ${c} to ${t} because it already exists and the ifAlreadyInstalled option was set to ${n}`)}await e.rmdir(p,{recursive:!0})}return await e.mv(l,p),{assetFolderPath:p,assetFolderName:c}}finally{await e.rmdir(i,{recursive:!0})}}function W(e){const t=e.split(".").shift().replace(/-/g," ");return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}const B=async(e,{themeZipFile:t,ifAlreadyInstalled:r,options:n={}},s)=>{const o=W(t.name);null==s||s.tracker.setCaption(`Installing the ${o} theme`);const{assetFolderName:i}=await V(e,{ifAlreadyInstalled:r,zipFile:t,targetPath:`${await e.documentRoot}/wp-content/themes`});(!("activate"in n)||n.activate)&&await x(e,{themeFolderName:i},s)},H="<?php\n\nfunction zipDir($root, $output, $options = array())\n{\n    $root = rtrim($root, '/');\n    $additionalPaths = array_key_exists('additional_paths', $options) ? $options['additional_paths'] : array();\n    $excludePaths = array_key_exists('exclude_paths', $options) ? $options['exclude_paths'] : array();\n    $zip_root = array_key_exists('zip_root', $options) ? $options['zip_root'] : $root;\n\n    $zip = new ZipArchive;\n    $res = $zip->open($output, ZipArchive::CREATE);\n    if ($res === TRUE) {\n        $directories = array(\n            $root . '/'\n        );\n        while (sizeof($directories)) {\n            $current_dir = array_pop($directories);\n\n            if ($handle = opendir($current_dir)) {\n                while (false !== ($entry = readdir($handle))) {\n                    if ($entry == '.' || $entry == '..') {\n                        continue;\n                    }\n\n                    $entry = join_paths($current_dir, $entry);\n                    if (in_array($entry, $excludePaths)) {\n                        continue;\n                    }\n\n                    if (is_dir($entry)) {\n                        $directory_path = $entry . '/';\n                        array_push($directories, $directory_path);\n                    } else if (is_file($entry)) {\n                        $zip->addFile($entry, substr($entry, strlen($zip_root)));\n                    }\n                }\n                closedir($handle);\n            }\n        }\n        foreach ($additionalPaths as $disk_path => $zip_path) {\n            $zip->addFile($disk_path, $zip_path);\n        }\n        $zip->close();\n        chmod($output, 0777);\n    }\n}\n\nfunction join_paths()\n{\n    $paths = array();\n\n    foreach (func_get_args() as $arg) {\n        if ($arg !== '') {\n            $paths[] = $arg;\n        }\n    }\n\n    return preg_replace('#/+#', '/', join('/', $paths));\n}\n";const G=async(e,{command:t,wpCliPath:r="/tmp/wp-cli.phar"})=>{if(!await e.fileExists(r))throw new Error(`wp-cli.phar not found at ${r}`);let n;if("string"==typeof t?n=function(e){let t=0,r="";const n=[];let s="";for(let o=0;o<e.length;o++){const i=e[o];0===t?'"'===i||"'"===i?(t=1,r=i):i.match(/\s/)?(s&&n.push(s),s=""):s+=i:1===t&&("\\"===i?(o++,s+=e[o]):i===r?(t=0,r=""):s+=i)}return s&&n.push(s),n}(t=t.trim()):n=t,"wp"!==n.shift())throw new Error('The first argument must be "wp".');await e.writeFile("/tmp/stdout",""),await e.writeFile("/tmp/stderr",""),await e.writeFile("/wordpress/run-cli.php",`<?php\n\t\t// Set up the environment to emulate a shell script\n\t\t// call.\n\n\t\t// Set SHELL_PIPE to 0 to ensure WP-CLI formats\n\t\t// the output as ASCII tables.\n\t\t// @see https://github.com/wp-cli/wp-cli/issues/1102\n\t\tputenv( 'SHELL_PIPE=0' );\n\n\t\t// Set the argv global.\n\t\t$GLOBALS['argv'] = array_merge([\n\t\t  "/tmp/wp-cli.phar",\n\t\t  "--path=/wordpress"\n\t\t], ${f(n)});\n\n\t\t// Provide stdin, stdout, stderr streams outside of\n\t\t// the CLI SAPI.\n\t\tdefine('STDIN', fopen('php://stdin', 'rb'));\n\t\tdefine('STDOUT', fopen('php://stdout', 'wb'));\n\t\tdefine('STDERR', fopen('php://stderr', 'wb'));\n\n\t\trequire( ${f(r)} );\n\t\t`);const s=await e.run({scriptPath:"/wordpress/run-cli.php"});if(s.errors)throw new Error(s.errors);return s};const K=Object.freeze(Object.defineProperty({__proto__:null,activatePlugin:C,activateTheme:x,cp:async(e,{fromPath:t,toPath:r})=>{await e.writeFile(r,await e.readFileAsBuffer(t))},defineSiteUrl:L,defineWpConfigConsts:O,enableMultisite:async e=>{var t;await O(e,{consts:{WP_ALLOW_MULTISITE:1}});const r=new URL(await e.absoluteUrl);if(""!==r.port){let e=`The current host is ${r.host}, but WordPress multisites do not support custom ports.`;throw"localhost"===r.hostname&&(e+=" For development, you can set up a playground.test domain using the instructions at https://wordpress.github.io/wordpress-playground/contributing/code."),new Error(e)}const n=r.pathname.replace(/\/$/,"")+"/",s=`${r.protocol}//${r.hostname}${n}`;await A(e,{options:{siteurl:s,home:s}}),await I(e,{});const o=await e.documentRoot,i=(await e.run({code:`<?php\ndefine( 'WP_ADMIN', true );\nrequire_once(${f(o)} . "/wp-load.php");\n\n// Set current user to admin\n( get_users(array('role' => 'Administrator') )[0] );\n\nrequire_once(${f(o)} . "/wp-admin/includes/plugin.php");\n$plugins_root = ${f(o)} . "/wp-content/plugins";\n$plugins = glob($plugins_root . "/*");\n\n$deactivated_plugins = [];\nforeach($plugins as $plugin_path) {\n\tif (str_ends_with($plugin_path, '/index.php')) {\n\t\tcontinue;\n\t}\n\tif (!is_dir($plugin_path)) {\n\t\t$deactivated_plugins[] = substr($plugin_path, strlen($plugins_root) + 1);\n\t\tdeactivate_plugins($plugin_path);\n\t\tcontinue;\n\t}\n\t// Find plugin entry file\n\tforeach ( ( glob( $plugin_path . '/*.php' ) ?: array() ) as $file ) {\n\t\t$info = get_plugin_data( $file, false, false );\n\t\tif ( ! empty( $info['Name'] ) ) {\n\t\t\tdeactivate_plugins( $file );\n\t\t\t$deactivated_plugins[] = substr($file, strlen($plugins_root) + 1);\n\t\t\tbreak;\n\t\t}\n\t}\n}\necho json_encode($deactivated_plugins);\n`})).json,a=null==(t=(await N(e,{request:{url:"/wp-admin/network.php"}})).text.match(/name="_wpnonce"\s+value="([^"]+)"/))?void 0:t[1],c=await N(e,{request:{url:"/wp-admin/network.php",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:M({_wpnonce:a,_wp_http_referer:n+"wp-admin/network.php",sitename:"My WordPress Website Sites",email:"admin@localhost.com",submit:"Install"})}});if(200!==c.httpStatusCode)throw b.warn("WordPress response was",{response:c,text:c.text,headers:c.headers}),new Error(`Failed to enable multisite. Response code was ${c.httpStatusCode}`);await O(e,{consts:{MULTISITE:!0,SUBDOMAIN_INSTALL:!1,SITE_ID_CURRENT_SITE:1,BLOG_ID_CURRENT_SITE:1,DOMAIN_CURRENT_SITE:r.hostname,PATH_CURRENT_SITE:n}});const l=new URL(await e.absoluteUrl),p=D(l)?"scope:"+function(e){return D(e)?e.pathname.split("/")[1].split(":")[1]:null}(l):null;await e.writeFile("/internal/shared/preload/sunrise.php",`<?php\n\t$_SERVER['HTTP_HOST'] = ${f(l.hostname)};\n\t$folder = ${f(p)};\n\tif ($folder && strpos($_SERVER['REQUEST_URI'],"/$folder") === false) {\n\t\t$_SERVER['REQUEST_URI'] = "/$folder/" . ltrim($_SERVER['REQUEST_URI'], '/');\n\t}\n`),await e.writeFile("/internal/shared/mu-plugins/sunrise.php","<?php\n\t\tif ( !defined( 'BLOG_ID_CURRENT_SITE' ) ) {\n\t\t\tdefine( 'BLOG_ID_CURRENT_SITE', 1 );\n\t\t}\n"),await I(e,{});for(const d of i)await C(e,{pluginPath:d})},exportWXR:async function(e){const t=await e.request({url:"/wp-admin/export.php?download=true&content=all"});return new File([t.bytes],"export.xml")},importWordPressFiles:async(e,{wordPressFilesZip:t,pathInZip:r=""})=>{const n=await e.documentRoot;let s=p("/tmp","import");await e.mkdir(s),await U(e,{zipFile:t,extractToPath:s}),s=p(s,r);const i=p(s,"wp-content"),a=p(n,"wp-content");for(const h of o){const t=p(i,h);await z(e,t);const r=p(a,h);await e.fileExists(r)&&(await e.mkdir(d(t)),await e.mv(r,t))}const c=p(s,"wp-content","database");await e.fileExists(c)||await e.mv(p(n,"wp-content","database"),c);const l=await e.listFiles(s);for(const o of l)await z(e,p(n,o)),await e.mv(p(s,o),p(n,o));await e.rmdir(s),await L(e,{siteUrl:await e.absoluteUrl});const u=f(p(n,"wp-admin","upgrade.php"));await e.run({code:`<?php\n            $_GET['step'] = 'upgrade_db';\n            require ${u};\n            `})},importWxr:async(e,{file:t},r)=>{var n;null==(n=null==r?void 0:r.tracker)||n.setCaption("Importing content"),await F(e,{path:"/tmp/import.wxr",data:t});const s=await e.documentRoot;await e.run({code:`<?php\n\t\trequire ${f(s)} . '/wp-load.php';\n\t\trequire ${f(s)} . '/wp-admin/includes/admin.php';\n  \n\t\tkses_remove_filters();\n\t\t$admin_id = get_users(array('role' => 'Administrator') )[0]->ID;\n        wp_set_current_user( $admin_id );\n\t\t$importer = new WXR_Importer( array(\n\t\t\t'fetch_attachments' => true,\n\t\t\t'default_author' => $admin_id\n\t\t) );\n\t\t$logger = new WP_Importer_Logger_CLI();\n\t\t$importer->set_logger( $logger );\n\n\t\t// Slashes from the imported content are lost if we don't call wp_slash here.\n\t\tadd_action( 'wp_insert_post_data', function( $data ) {\n\t\t\treturn wp_slash($data);\n\t\t});\n\n\t\t$result = $importer->import( '/tmp/import.wxr' );\n\t\t`})},installPlugin:async(e,{pluginZipFile:t,ifAlreadyInstalled:r,options:n={}},s)=>{const o=W(t.name.split("/").pop()||"plugin.zip");null==s||s.tracker.setCaption(`Installing the ${o} plugin`);const{assetFolderPath:i}=await V(e,{ifAlreadyInstalled:r,zipFile:t,targetPath:`${await e.documentRoot}/wp-content/plugins`});(!("activate"in n)||n.activate)&&await C(e,{pluginPath:i,pluginName:o},s)},installTheme:B,login:I,mkdir:async(e,{path:t})=>{await e.mkdir(t)},mv:async(e,{fromPath:t,toPath:r})=>{await e.mv(t,r)},request:N,resetData:async(e,t,r)=>{var n;null==(n=null==r?void 0:r.tracker)||n.setCaption("Resetting WordPress data");const s=await e.documentRoot;await e.run({env:{DOCROOT:s},code:"<?php\n\t\trequire getenv('DOCROOT') . '/wp-load.php';\n\n\t\t$GLOBALS['@pdo']->query('DELETE FROM wp_posts WHERE id > 0');\n\t\t$GLOBALS['@pdo']->query(\"UPDATE SQLITE_SEQUENCE SET SEQ=0 WHERE NAME='wp_posts'\");\n\t\t\n\t\t$GLOBALS['@pdo']->query('DELETE FROM wp_postmeta WHERE post_id > 1');\n\t\t$GLOBALS['@pdo']->query(\"UPDATE SQLITE_SEQUENCE SET SEQ=20 WHERE NAME='wp_postmeta'\");\n\n\t\t$GLOBALS['@pdo']->query('DELETE FROM wp_comments');\n\t\t$GLOBALS['@pdo']->query(\"UPDATE SQLITE_SEQUENCE SET SEQ=0 WHERE NAME='wp_comments'\");\n\n\t\t$GLOBALS['@pdo']->query('DELETE FROM wp_commentmeta');\n\t\t$GLOBALS['@pdo']->query(\"UPDATE SQLITE_SEQUENCE SET SEQ=0 WHERE NAME='wp_commentmeta'\");\n\t\t"})},rm:R,rmdir:async(e,{path:t})=>{await e.rmdir(t)},runPHP:async(e,{code:t})=>await e.run({code:t}),runPHPWithOptions:async(e,{options:t})=>await e.run(t),runSql:async(e,{sql:t},r)=>{null==r||r.tracker.setCaption("Executing SQL Queries");const n=`/tmp/${h(36,"-_")}.sql`;await e.writeFile(n,new Uint8Array(await t.arrayBuffer()));const s=m({docroot:await e.documentRoot,sqlFilename:n}),o=await e.run({code:`<?php\n\t\trequire_once ${s.docroot} . '/wp-load.php';\n\n\t\t$handle = fopen(${s.sqlFilename}, 'r');\n\t\t$buffer = '';\n\n\t\tglobal $wpdb;\n\n\t\twhile ($bytes = fgets($handle)) {\n\t\t\t$buffer .= $bytes;\n\n\t\t\tif (!feof($handle) && substr($buffer, -1, 1) !== "\n") {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t$wpdb->query($buffer);\n\t\t\t$buffer = '';\n\t\t}\n\t`});return await R(e,{path:n}),o},runWpInstallationWizard:async(e,{options:t})=>{await e.request({url:"/wp-admin/install.php?step=2",method:"POST",body:{language:"en",prefix:"wp_",weblog_title:"My WordPress Website",user_name:t.adminPassword||"admin",admin_password:t.adminPassword||"password",admin_password2:t.adminPassword||"password",Submit:"Install WordPress",pw_weak:"1",admin_email:"admin@localhost.com"}})},setSiteOptions:A,unzip:U,updateUserMeta:async(e,{meta:t,userId:r})=>{const n=await e.documentRoot;await e.run({code:`<?php\n\t\tinclude ${f(n)} . '/wp-load.php';\n\t\t$meta = ${f(t)};\n\t\tforeach($meta as $name => $value) {\n\t\t\tupdate_user_meta(${f(r)}, $name, $value);\n\t\t}\n\t\t`})},wpCLI:G,writeFile:F,zipWpContent:async(e,{selfContained:t=!1}={})=>{const r="/tmp/wordpress-playground.zip",n=await e.documentRoot,s=p(n,"wp-content");let i=o;t&&(i=i.filter((e=>!e.startsWith("themes/twenty"))).filter((e=>"mu-plugins/sqlite-database-integration"!==e)));const a=m({zipPath:r,wpContentPath:s,documentRoot:n,exceptPaths:i.map((e=>p(n,"wp-content",e))),additionalPaths:t?{[p(n,"wp-config.php")]:"wp-config.php"}:{}});await async function(e,t){return await e.run({code:H+t})}(e,`zipDir(${a.wpContentPath}, ${a.zipPath}, array(\n\t\t\t'exclude_paths' => ${a.exceptPaths},\n\t\t\t'zip_root'      => ${a.documentRoot},\n\t\t\t'additional_paths' => ${a.additionalPaths}\n\t\t));`);const c=await e.readFileAsBuffer(r);return e.unlink(r),c}},Symbol.toStringTag,{value:"Module"}));const J=1e-5;class Q extends EventTarget{constructor({weight:e=1,caption:t="",fillTime:r=4}={}){super(),this._selfWeight=1,this._selfDone=!1,this._selfProgress=0,this._selfCaption="",this._isFilling=!1,this._subTrackers=[],this._weight=e,this._selfCaption=t,this._fillTime=r}stage(e,t=""){if(e||(e=this._selfWeight),this._selfWeight-e<-J)throw new Error(`Cannot add a stage with weight ${e} as the total weight of registered stages would exceed 1.`);this._selfWeight-=e;const r=new Q({caption:t,weight:e,fillTime:this._fillTime});return this._subTrackers.push(r),r.addEventListener("progress",(()=>this.notifyProgress())),r.addEventListener("done",(()=>{this.done&&this.notifyDone()})),r}fillSlowly({stopBeforeFinishing:e=!0}={}){if(this._isFilling)return;this._isFilling=!0;const t=this._fillTime/100;this._fillInterval=setInterval((()=>{this.set(this._selfProgress+1),e&&this._selfProgress>=99&&clearInterval(this._fillInterval)}),t)}set(e){this._selfProgress=Math.min(e,100),this.notifyProgress(),this._selfProgress+J>=100&&this.finish()}finish(){this._fillInterval&&clearInterval(this._fillInterval),this._selfDone=!0,this._selfProgress=100,this._isFilling=!1,this._fillInterval=void 0,this.notifyProgress(),this.notifyDone()}get caption(){for(let e=this._subTrackers.length-1;e>=0;e--)if(!this._subTrackers[e].done){const t=this._subTrackers[e].caption;if(t)return t}return this._selfCaption}setCaption(e){this._selfCaption=e,this.notifyProgress()}get done(){return this.progress+J>=100}get progress(){if(this._selfDone)return 100;const e=this._subTrackers.reduce(((e,t)=>e+t.progress*t.weight),this._selfProgress*this._selfWeight);return Math.round(1e4*e)/1e4}get weight(){return this._weight}get observer(){return this._progressObserver||(this._progressObserver=e=>{this.set(e)}),this._progressObserver}get loadingListener(){return this._loadingListener||(this._loadingListener=e=>{this.set(e.detail.loaded/e.detail.total*100)}),this._loadingListener}pipe(e){e.setProgress({progress:this.progress,caption:this.caption}),this.addEventListener("progress",(t=>{e.setProgress({progress:t.detail.progress,caption:t.detail.caption})})),this.addEventListener("done",(()=>{e.setLoaded()}))}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}notifyProgress(){const e=this;this.dispatchEvent(new CustomEvent("progress",{detail:{get progress(){return e.progress},get caption(){return e.caption}}}))}notifyDone(){this.dispatchEvent(new CustomEvent("done"))}}const Z={0:"No error occurred. System call completed successfully.",1:"Argument list too long.",2:"Permission denied.",3:"Address in use.",4:"Address not available.",5:"Address family not supported.",6:"Resource unavailable, or operation would block.",7:"Connection already in progress.",8:"Bad file descriptor.",9:"Bad message.",10:"Device or resource busy.",11:"Operation canceled.",12:"No child processes.",13:"Connection aborted.",14:"Connection refused.",15:"Connection reset.",16:"Resource deadlock would occur.",17:"Destination address required.",18:"Mathematics argument out of domain of function.",19:"Reserved.",20:"File exists.",21:"Bad address.",22:"File too large.",23:"Host is unreachable.",24:"Identifier removed.",25:"Illegal byte sequence.",26:"Operation in progress.",27:"Interrupted function.",28:"Invalid argument.",29:"I/O error.",30:"Socket is connected.",31:"There is a directory under that path.",32:"Too many levels of symbolic links.",33:"File descriptor value too large.",34:"Too many links.",35:"Message too large.",36:"Reserved.",37:"Filename too long.",38:"Network is down.",39:"Connection aborted by network.",40:"Network unreachable.",41:"Too many files open in system.",42:"No buffer space available.",43:"No such device.",44:"There is no such file or directory OR the parent directory does not exist.",45:"Executable file format error.",46:"No locks available.",47:"Reserved.",48:"Not enough space.",49:"No message of the desired type.",50:"Protocol not available.",51:"No space left on device.",52:"Function not supported.",53:"The socket is not connected.",54:"Not a directory or a symbolic link to a directory.",55:"Directory not empty.",56:"State not recoverable.",57:"Not a socket.",58:"Not supported, or operation not supported on socket.",59:"Inappropriate I/O control operation.",60:"No such device or address.",61:"Value too large to be stored in data type.",62:"Previous owner died.",63:"Operation not permitted.",64:"Broken pipe.",65:"Protocol error.",66:"Protocol not supported.",67:"Protocol wrong type for socket.",68:"Result too large.",69:"Read-only file system.",70:"Invalid seek.",71:"No such process.",72:"Reserved.",73:"Connection timed out.",74:"Text file busy.",75:"Cross-device link.",76:"Extension: Capabilities insufficient."};function Y(e=""){return function(t,r,n){const s=n.value;n.value=function(...t){try{return s.apply(this,t)}catch(r){const n="object"==typeof r?null==r?void 0:r.errno:null;if(n in Z){const s=Z[n],o="string"==typeof t[1]?t[1]:null,i=null!==o?e.replaceAll("{path}",o):e;throw new Error(`${i}: ${s}`,{cause:r})}throw r}}}}var X=Object.defineProperty,ee=Object.getOwnPropertyDescriptor,te=(e,t,r,n)=>{for(var s,o=n>1?void 0:n?ee(t,r):t,i=e.length-1;i>=0;i--)(s=e[i])&&(o=(n?s(t,r,o):s(o))||o);return n&&o&&X(t,r,o),o};const re=class e{static readFileAsText(t,r){return(new TextDecoder).decode(e.readFileAsBuffer(t,r))}static readFileAsBuffer(e,t){return e.readFile(t)}static writeFile(e,t,r){e.writeFile(t,r)}static unlink(e,t){e.unlink(t)}static mv(t,r,n){try{const s=t.lookupPath(r).node.mount,o=e.fileExists(t,n)?t.lookupPath(n).node.mount:t.lookupPath(d(n)).node.mount;s.mountpoint!==o.mountpoint?(e.copyRecursive(t,r,n),e.rmdir(t,r,{recursive:!0})):t.rename(r,n)}catch(s){const e=function(e){const t="object"==typeof e?null==e?void 0:e.errno:null;if(t in Z)return Z[t]}(s);throw e?new Error(`Could not move ${r} to ${n}: ${e}`,{cause:s}):s}}static rmdir(t,r,n={recursive:!0}){null!=n&&n.recursive&&e.listFiles(t,r).forEach((s=>{const o=`${r}/${s}`;e.isDir(t,o)?e.rmdir(t,o,n):e.unlink(t,o)})),t.rmdir(r)}static listFiles(t,r,n={prependPath:!1}){if(!e.fileExists(t,r))return[];try{const e=t.readdir(r).filter((e=>"."!==e&&".."!==e));if(n.prependPath){const t=r.replace(/\/$/,"");return e.map((e=>`${t}/${e}`))}return e}catch(s){return b.error(s,{path:r}),[]}}static isDir(t,r){return!!e.fileExists(t,r)&&t.isDir(t.lookupPath(r).node.mode)}static fileExists(e,t){try{return e.lookupPath(t),!0}catch{return!1}}static mkdir(e,t){e.mkdirTree(t)}static copyRecursive(t,r,n){const s=t.lookupPath(r).node;if(t.isDir(s.mode)){t.mkdirTree(n);const s=t.readdir(r).filter((e=>"."!==e&&".."!==e));for(const o of s)e.copyRecursive(t,p(r,o),p(n,o))}else t.writeFile(n,t.readFile(r))}};te([Y('Could not read "{path}"')],re,"readFileAsText",1),te([Y('Could not read "{path}"')],re,"readFileAsBuffer",1),te([Y('Could not write to "{path}"')],re,"writeFile",1),te([Y('Could not unlink "{path}"')],re,"unlink",1),te([Y('Could not remove directory "{path}"')],re,"rmdir",1),te([Y('Could not list files in "{path}"')],re,"listFiles",1),te([Y('Could not stat "{path}"')],re,"isDir",1),te([Y('Could not stat "{path}"')],re,"fileExists",1),te([Y('Could not create directory "{path}"')],re,"mkdir",1),te([Y('Could not copy files from "{path}"')],re,"copyRecursive",1);const ne={500:"Internal Server Error",502:"Bad Gateway",404:"Not Found",403:"Forbidden",401:"Unauthorized",400:"Bad Request",301:"Moved Permanently",302:"Found",307:"Temporary Redirect",308:"Permanent Redirect",204:"No Content",201:"Created",200:"OK"};class se{constructor(e,t,r,n="",s=0){this.httpStatusCode=e,this.headers=t,this.bytes=r,this.exitCode=s,this.errors=n}static forHttpCode(e,t=""){return new se(e,{},(new TextEncoder).encode(t||ne[e]||""))}static fromRawData(e){return new se(e.httpStatusCode,e.headers,e.bytes,e.errors,e.exitCode)}toRawData(){return{headers:this.headers,bytes:this.bytes,errors:this.errors,exitCode:this.exitCode,httpStatusCode:this.httpStatusCode}}get json(){return JSON.parse(this.text)}get text(){return(new TextDecoder).decode(this.bytes)}}!function(){var e;typeof process<"u"&&"node"===(null==(e=process.release)?void 0:e.name)||(typeof window<"u"||typeof WorkerGlobalScope<"u"&&(self,WorkerGlobalScope))}();typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"&&self;function oe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}const{hasOwnProperty:ie}=Object.prototype;ReadableStream.prototype[Symbol.asyncIterator]||(ReadableStream.prototype[Symbol.asyncIterator]=async function*(){const e=this.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)return;yield r}}finally{e.releaseLock()}},ReadableStream.prototype.iterate=ReadableStream.prototype[Symbol.asyncIterator]);const ae=["8.3","8.2","8.1","8.0","7.4","7.3","7.2","7.1","7.0"],ce=ae[0],le=["iconv","mbstring","xml-bundle","gd"],pe={"kitchen-sink":le,light:[]},de=["vfs","literal","wordpress.org/themes","wordpress.org/plugins","url"];function ue(e){return e&&"object"==typeof e&&"string"==typeof e.resource&&de.includes(e.resource)}class he{static create(e,{semaphore:t,progress:r}){let n;switch(e.resource){case"vfs":n=new fe(e,r);break;case"literal":n=new me(e,r);break;case"wordpress.org/themes":n=new we(e,r);break;case"wordpress.org/plugins":n=new $e(e,r);break;case"url":n=new ve(e,r);break;default:throw new Error(`Invalid resource: ${e}`)}return n=new Ee(n),t&&(n=new Pe(n,t)),n}setPlayground(e){this.playground=e}get isAsync(){return!1}}class fe extends he{constructor(e,t){super(),this.resource=e,this.progress=t}async resolve(){var e;const t=await this.playground.readFileAsBuffer(this.resource.path);return null==(e=this.progress)||e.set(100),new File([t],this.name)}get name(){return this.resource.path.split("/").pop()||""}}class me extends he{constructor(e,t){super(),this.resource=e,this.progress=t}async resolve(){var e;return null==(e=this.progress)||e.set(100),new File([this.resource.contents],this.resource.name)}get name(){return this.resource.name}}class ye extends he{constructor(e){super(),this.progress=e}async resolve(){var e,t;null==(e=this.progress)||e.setCaption(this.caption);const r=this.getURL();try{let e=await fetch(r);if(!e.ok)throw new Error(`Could not download "${r}"`);if(e=await function(e,t){const r=e.headers.get("content-length")||"",n=parseInt(r,10)||5242880;function s(e,r){t(new CustomEvent("progress",{detail:{loaded:e,total:r}}))}return new Response(new ReadableStream({async start(t){if(!e.body)return void t.close();const r=e.body.getReader();let o=0;for(;;)try{const{done:e,value:i}=await r.read();if(i&&(o+=i.byteLength),e){s(o,o),t.close();break}s(o,n),t.enqueue(i)}catch(i){b.error({e:i}),t.error(i);break}}}),{status:e.status,statusText:e.statusText,headers:e.headers})}(e,(null==(t=this.progress)?void 0:t.loadingListener)??ge),200!==e.status)throw new Error(`Could not download "${r}"`);return new File([await e.blob()],this.name)}catch(n){throw new Error(`Could not download "${r}".\n\t\t\t\tCheck if the URL is correct and the server is reachable.\n\t\t\t\tIf it is reachable, the server might be blocking the request.\n\t\t\t\tCheck the browser console and network tabs for more information.\n\n\t\t\t\t## Does the console show the error "No 'Access-Control-Allow-Origin' header"?\n\n\t\t\t\tThis means the server that hosts your file does not allow requests from other sites\n\t\t\t\t(cross-origin requests, or CORS).\tYou need to move the asset to a server that allows\n\t\t\t\tcross-origin file downloads. Learn more about CORS at\n\t\t\t\thttps://developer.mozilla.org/en-US/docs/Web/HTTP/CORS.\n\n\t\t\t\tIf your file is on GitHub, load it from "raw.githubusercontent.com".\n\t\t\t\tHere's how to do that:\n\n\t\t\t\t1. Start with the original GitHub URL of the file. For example:\n\t\t\t\thttps://github.com/username/repository/blob/branch/filename.\n\t\t\t\t2. Replace "github.com" with "raw.githubusercontent.com".\n\t\t\t\t3. Remove the "/blob/" part of the URL.\n\n\t\t\t\tThe resulting URL should look like this:\n\t\t\t\thttps://raw.githubusercontent.com/username/repository/branch/filename\n\n\t\t\t\tError:\n\t\t\t\t${n}`)}}get caption(){return`Downloading ${this.name}`}get name(){try{return new URL(this.getURL(),"http://example.com").pathname.split("/").pop()}catch{return this.getURL()}}get isAsync(){return!0}}const ge=()=>{};class ve extends ye{constructor(e,t){super(t),this.resource=e}getURL(){return this.resource.url}get caption(){return this.resource.caption??super.caption}}class we extends ye{constructor(e,t){super(t),this.resource=e}get name(){return W(this.resource.slug)}getURL(){return`https://downloads.wordpress.org/theme/${_e(this.resource.slug)}`}}class $e extends ye{constructor(e,t){super(t),this.resource=e}get name(){return W(this.resource.slug)}getURL(){return`https://downloads.wordpress.org/plugin/${_e(this.resource.slug)}`}}function _e(e){return!e||e.endsWith(".zip")?e:e+".latest-stable.zip"}class be extends he{constructor(e){super(),this.resource=e}async resolve(){return this.resource.resolve()}async setPlayground(e){return this.resource.setPlayground(e)}get progress(){return this.resource.progress}set progress(e){this.resource.progress=e}get name(){return this.resource.name}get isAsync(){return this.resource.isAsync}}class Ee extends be{async resolve(){return this.promise||(this.promise=super.resolve()),this.promise}}class Pe extends be{constructor(e,t){super(e),this.semaphore=t}async resolve(){return this.isAsync?this.semaphore.run((()=>super.resolve())):super.resolve()}}var Se={exports:{}},ke={},Te={},Ce={},xe={},Re={},Ne={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(t){if(super(),!e.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");this.str=t}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class n extends t{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce(((e,t)=>`${e}${t}`),"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce(((e,t)=>(t instanceof r&&(e[t.str]=(e[t.str]||0)+1),e)),{})}}function s(e,...t){const r=[e[0]];let s=0;for(;s<t.length;)a(r,t[s]),r.push(e[++s]);return new n(r)}e._Code=n,e.nil=new n(""),e._=s;const o=new n("+");function i(e,...t){const r=[l(e[0])];let s=0;for(;s<t.length;)r.push(o),a(r,t[s]),r.push(o,l(e[++s]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===o){const r=c(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new n(r)}function a(e,t){t instanceof n?e.push(...t._items):t instanceof r?e.push(t):e.push(function(e){return"number"==typeof e||"boolean"==typeof e||null===e?e:l(Array.isArray(e)?e.join(","):e)}(t))}function c(e,t){return'""'===t?e:'""'===e?t:"string"==typeof e?t instanceof r||'"'!==e[e.length-1]?void 0:"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0:"string"!=typeof t||'"'!==t[0]||e instanceof r?void 0:`"${e}${t.slice(1)}`}function l(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.str=i,e.addCodeArg=a,e.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:i`${e}${t}`},e.stringify=function(e){return new n(l(e))},e.safeStringify=l,e.getProperty=function(t){return"string"==typeof t&&e.IDENTIFIER.test(t)?new n(`.${t}`):s`[${t}]`},e.getEsmExportName=function(t){if("string"==typeof t&&e.IDENTIFIER.test(t))return new n(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)},e.regexpCode=function(e){return new n(e.toString())}}(Ne);var je={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=Ne;class r extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}var n,s;(s=n=e.UsedValueState||(e.UsedValueState={}))[s.Started=0]="Started",s[s.Completed=1]="Completed",e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof t.Name?e:this.name(e)}name(e){return new t.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if(null!==(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)&&void 0!==r&&r.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}e.Scope=o;class i extends t.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=t._`.${new t.Name(r)}[${n}]`}}e.ValueScopeName=i;const a=t._`\n`;e.ValueScope=class extends o{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?a:t.nil}}get(){return this._scope}name(e){return new i(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const n=this.toName(e),{prefix:s}=n,o=null!==(r=t.key)&&void 0!==r?r:t.ref;let i=this._values[s];if(i){const e=i.get(o);if(e)return e}else i=this._values[s]=new Map;i.set(o,n);const a=this._scope[s]||(this._scope[s]=[]),c=a.length;return a[c]=t.ref,n.setValue(t,{property:s,itemIndex:c}),n}getValue(e,t){const r=this._values[e];if(r)return r.get(t)}scopeRefs(e,r=this._values){return this._reduceValues(r,(r=>{if(void 0===r.scopePath)throw new Error(`CodeGen: name "${r}" has no value`);return t._`${e}${r.scopePath}`}))}scopeCode(e=this._values,t,r){return this._reduceValues(e,(e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code}),t,r)}_reduceValues(s,o,i={},a){let c=t.nil;for(const l in s){const p=s[l];if(!p)continue;const d=i[l]=i[l]||new Map;p.forEach((s=>{if(d.has(s))return;d.set(s,n.Started);let i=o(s);if(i){const r=this.opts.es5?e.varKinds.var:e.varKinds.const;c=t._`${c}${r} ${s} = ${i};${this.opts._n}`}else{if(!(i=null==a?void 0:a(s)))throw new r(s);c=t._`${c}${i}${this.opts._n}`}d.set(s,n.Completed)}))}return c}}}(je),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=Ne,r=je;var n=Ne;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var s=je;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(e,t){return this}}class i extends o{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){const n=e?r.varKinds.var:this.varKind,s=void 0===this.rhs?"":` = ${this.rhs}`;return`${n} ${this.name}${s};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=x(this.rhs,e,t)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class a extends o{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof t.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=x(this.rhs,e,r),this}get names(){return C(this.lhs instanceof t.Name?{}:{...this.lhs.names},this.rhs)}}class c extends a{constructor(e,t,r,n){super(e,r,n),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class l extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}}class p extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}}class d extends o{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class u extends o{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){return this.code=x(this.code,e,t),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class h extends o{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce(((t,r)=>t+r.render(e)),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:r}=this;let n=r.length;for(;n--;){const s=r[n];s.optimizeNames(e,t)||(R(e,s.names),r.splice(n,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce(((e,t)=>T(e,t.names)),{})}}class f extends h{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class m extends h{}class y extends f{}y.kind="else";class g extends f{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new y(e):e}return t?!1===e?t instanceof g?t:t.nodes:this.nodes.length?this:new g(N(e),t instanceof g?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=x(this.condition,e,t),this}get names(){const e=super.names;return C(e,this.condition),this.else&&T(e,this.else.names),e}}g.kind="if";class v extends f{}v.kind="for";class w extends v{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=x(this.iteration,e,t),this}get names(){return T(super.names,this.iteration.names)}}class $ extends v{constructor(e,t,r,n){super(),this.varKind=e,this.name=t,this.from=r,this.to=n}render(e){const t=e.es5?r.varKinds.var:this.varKind,{name:n,from:s,to:o}=this;return`for(${t} ${n}=${s}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){const e=C(super.names,this.from);return C(e,this.to)}}class _ extends v{constructor(e,t,r,n){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=n}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=x(this.iterable,e,t),this}get names(){return T(super.names,this.iterable.names)}}class b extends f{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}}b.kind="func";class E extends h{render(e){return"return "+super.render(e)}}E.kind="return";class P extends f{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,n;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(n=this.finally)||void 0===n||n.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&T(e,this.catch.names),this.finally&&T(e,this.finally.names),e}}class S extends f{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}S.kind="catch";class k extends f{render(e){return"finally"+super.render(e)}}k.kind="finally";function T(e,t){for(const r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function C(e,r){return r instanceof t._CodeOrName?T(e,r.names):e}function x(e,r,n){return e instanceof t.Name?o(e):(s=e)instanceof t._Code&&s._items.some((e=>e instanceof t.Name&&1===r[e.str]&&void 0!==n[e.str]))?new t._Code(e._items.reduce(((e,r)=>(r instanceof t.Name&&(r=o(r)),r instanceof t._Code?e.push(...r._items):e.push(r),e)),[])):e;var s;function o(e){const t=n[e.str];return void 0===t||1!==r[e.str]?e:(delete r[e.str],t)}}function R(e,t){for(const r in t)e[r]=(e[r]||0)-(t[r]||0)}function N(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:t._`!${A(e)}`}e.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new r.Scope({parent:e}),this._nodes=[new m]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,n){const s=this._scope.toName(t);return void 0!==r&&n&&(this._constants[s.str]=r),this._leafNode(new i(e,s,r)),s}const(e,t,n){return this._def(r.varKinds.const,e,t,n)}let(e,t,n){return this._def(r.varKinds.let,e,t,n)}var(e,t,n){return this._def(r.varKinds.var,e,t,n)}assign(e,t,r){return this._leafNode(new a(e,t,r))}add(t,r){return this._leafNode(new c(t,e.operators.ADD,r))}code(e){return"function"==typeof e?e():e!==t.nil&&this._leafNode(new u(e)),this}object(...e){const r=["{"];for(const[n,s]of e)r.length>1&&r.push(","),r.push(n),(n!==s||this.opts.es5)&&(r.push(":"),(0,t.addCodeArg)(r,s));return r.push("}"),new t._Code(r)}if(e,t,r){if(this._blockNode(new g(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new g(e))}else(){return this._elseNode(new y)}endIf(){return this._endBlockNode(g,y)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new w(e),t)}forRange(e,t,n,s,o=(this.opts.es5?r.varKinds.var:r.varKinds.let)){const i=this._scope.toName(e);return this._for(new $(o,i,t,n),(()=>s(i)))}forOf(e,n,s,o=r.varKinds.const){const i=this._scope.toName(e);if(this.opts.es5){const e=n instanceof t.Name?n:this.var("_arr",n);return this.forRange("_i",0,t._`${e}.length`,(r=>{this.var(i,t._`${e}[${r}]`),s(i)}))}return this._for(new _("of",o,i,n),(()=>s(i)))}forIn(e,n,s,o=(this.opts.es5?r.varKinds.var:r.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,t._`Object.keys(${n})`,s);const i=this._scope.toName(e);return this._for(new _("in",o,i,n),(()=>s(i)))}endFor(){return this._endBlockNode(v)}label(e){return this._leafNode(new l(e))}break(e){return this._leafNode(new p(e))}return(e){const t=new E;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(E)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');const n=new P;if(this._blockNode(n),this.code(e),t){const e=this.name("e");this._currNode=n.catch=new S(e),t(e)}return r&&(this._currNode=n.finally=new k,this.code(r)),this._endBlockNode(S,k)}throw(e){return this._leafNode(new d(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,r=t.nil,n,s){return this._blockNode(new b(e,r,n)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(b)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof g))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},e.not=N;const j=I(e.operators.AND);e.and=function(...e){return e.reduce(j)};const O=I(e.operators.OR);function I(e){return(r,n)=>r===t.nil?n:n===t.nil?r:t._`${A(r)} ${e} ${A(n)}`}function A(e){return e instanceof t.Name?e:t._`(${e})`}e.or=function(...e){return e.reduce(O)}}(Re);var Oe={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=Re,r=Ne;function n(e,t=e.schema){const{opts:r,self:n}=e;if(!r.strictSchema||"boolean"==typeof t)return;const s=n.RULES.keywords;for(const o in t)s[o]||h(e,`unknown keyword: "${o}"`)}function s(e,t){if("boolean"==typeof e)return!e;for(const r in e)if(t[r])return!0;return!1}function o(e){return"number"==typeof e?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}function i(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function a({mergeNames:e,mergeToName:r,mergeValues:n,resultToName:s}){return(o,i,a,c)=>{const l=void 0===a?i:a instanceof t.Name?(i instanceof t.Name?e(o,i,a):r(o,i,a),a):i instanceof t.Name?(r(o,a,i),i):n(i,a);return c!==t.Name||l instanceof t.Name?l:s(o,l)}}function c(e,r){if(!0===r)return e.var("props",!0);const n=e.var("props",t._`{}`);return void 0!==r&&l(e,n,r),n}function l(e,r,n){Object.keys(n).forEach((n=>e.assign(t._`${r}${(0,t.getProperty)(n)}`,!0)))}e.toHash=function(e){const t={};for(const r of e)t[r]=!0;return t},e.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(n(e,t),!s(t,e.self.RULES.all))},e.checkUnknownRules=n,e.schemaHasRules=s,e.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const r in e)if("$ref"!==r&&t.all[r])return!0;return!1},e.schemaRefOrVal=function({topSchemaRef:e,schemaPath:r},n,s,o){if(!o){if("number"==typeof n||"boolean"==typeof n)return n;if("string"==typeof n)return t._`${n}`}return t._`${e}${r}${(0,t.getProperty)(s)}`},e.unescapeFragment=function(e){return i(decodeURIComponent(e))},e.escapeFragment=function(e){return encodeURIComponent(o(e))},e.escapeJsonPointer=o,e.unescapeJsonPointer=i,e.eachItem=function(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)},e.mergeEvaluated={props:a({mergeNames:(e,r,n)=>e.if(t._`${n} !== true && ${r} !== undefined`,(()=>{e.if(t._`${r} === true`,(()=>e.assign(n,!0)),(()=>e.assign(n,t._`${n} || {}`).code(t._`Object.assign(${n}, ${r})`)))})),mergeToName:(e,r,n)=>e.if(t._`${n} !== true`,(()=>{!0===r?e.assign(n,!0):(e.assign(n,t._`${n} || {}`),l(e,n,r))})),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:c}),items:a({mergeNames:(e,r,n)=>e.if(t._`${n} !== true && ${r} !== undefined`,(()=>e.assign(n,t._`${r} === true ? true : ${n} > ${r} ? ${n} : ${r}`))),mergeToName:(e,r,n)=>e.if(t._`${n} !== true`,(()=>e.assign(n,!0===r||t._`${n} > ${r} ? ${n} : ${r}`))),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},e.evaluatedPropsToName=c,e.setEvaluated=l;const p={};var d,u;function h(e,t,r=e.opts.strictSchema){if(r){if(t=`strict mode: ${t}`,!0===r)throw new Error(t);e.self.logger.warn(t)}}e.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:p[t.code]||(p[t.code]=new r._Code(t.code))})},(u=d=e.Type||(e.Type={}))[u.Num=0]="Num",u[u.Str=1]="Str",e.getErrorPath=function(e,r,n){if(e instanceof t.Name){const s=r===d.Num;return n?s?t._`"[" + ${e} + "]"`:t._`"['" + ${e} + "']"`:s?t._`"/" + ${e}`:t._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return n?(0,t.getProperty)(e).toString():"/"+o(e)},e.checkStrictMode=h}(Oe);var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});const Ae=Re,De={data:new Ae.Name("data"),valCxt:new Ae.Name("valCxt"),instancePath:new Ae.Name("instancePath"),parentData:new Ae.Name("parentData"),parentDataProperty:new Ae.Name("parentDataProperty"),rootData:new Ae.Name("rootData"),dynamicAnchors:new Ae.Name("dynamicAnchors"),vErrors:new Ae.Name("vErrors"),errors:new Ae.Name("errors"),this:new Ae.Name("this"),self:new Ae.Name("self"),scope:new Ae.Name("scope"),json:new Ae.Name("json"),jsonPos:new Ae.Name("jsonPos"),jsonLen:new Ae.Name("jsonLen"),jsonPart:new Ae.Name("jsonPart")};Ie.default=De,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=Re,r=Oe,n=Ie;function s(e,r){const s=e.const("err",r);e.if(t._`${n.default.vErrors} === null`,(()=>e.assign(n.default.vErrors,t._`[${s}]`)),t._`${n.default.vErrors}.push(${s})`),e.code(t._`${n.default.errors}++`)}function o(e,r){const{gen:n,validateName:s,schemaEnv:o}=e;o.$async?n.throw(t._`new ${e.ValidationError}(${r})`):(n.assign(t._`${s}.errors`,r),n.return(!1))}e.keywordError={message:({keyword:e})=>t.str`must pass "${e}" keyword validation`},e.keyword$DataError={message:({keyword:e,schemaType:r})=>r?t.str`"${e}" keyword must be ${r} ($data)`:t.str`"${e}" keyword is invalid ($data)`},e.reportError=function(r,n=e.keywordError,i,c){const{it:l}=r,{gen:p,compositeRule:d,allErrors:u}=l,h=a(r,n,i);c??(d||u)?s(p,h):o(l,t._`[${h}]`)},e.reportExtraError=function(t,r=e.keywordError,i){const{it:c}=t,{gen:l,compositeRule:p,allErrors:d}=c;s(l,a(t,r,i)),p||d||o(c,n.default.vErrors)},e.resetErrorsCount=function(e,r){e.assign(n.default.errors,r),e.if(t._`${n.default.vErrors} !== null`,(()=>e.if(r,(()=>e.assign(t._`${n.default.vErrors}.length`,r)),(()=>e.assign(n.default.vErrors,null)))))},e.extendErrors=function({gen:e,keyword:r,schemaValue:s,data:o,errsCount:i,it:a}){if(void 0===i)throw new Error("ajv implementation error");const c=e.name("err");e.forRange("i",i,n.default.errors,(i=>{e.const(c,t._`${n.default.vErrors}[${i}]`),e.if(t._`${c}.instancePath === undefined`,(()=>e.assign(t._`${c}.instancePath`,(0,t.strConcat)(n.default.instancePath,a.errorPath)))),e.assign(t._`${c}.schemaPath`,t.str`${a.errSchemaPath}/${r}`),a.opts.verbose&&(e.assign(t._`${c}.schema`,s),e.assign(t._`${c}.data`,o))}))};const i={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function a(e,r,s){const{createErrors:o}=e.it;return!1===o?t._`{}`:function(e,r,s={}){const{gen:o,it:a}=e,p=[c(a,s),l(e,s)];return function(e,{params:r,message:s},o){const{keyword:a,data:c,schemaValue:l,it:p}=e,{opts:d,propertyName:u,topSchemaRef:h,schemaPath:f}=p;o.push([i.keyword,a],[i.params,"function"==typeof r?r(e):r||t._`{}`]),d.messages&&o.push([i.message,"function"==typeof s?s(e):s]),d.verbose&&o.push([i.schema,l],[i.parentSchema,t._`${h}${f}`],[n.default.data,c]),u&&o.push([i.propertyName,u])}(e,r,p),o.object(...p)}(e,r,s)}function c({errorPath:e},{instancePath:s}){const o=s?t.str`${e}${(0,r.getErrorPath)(s,r.Type.Str)}`:e;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,o)]}function l({keyword:e,it:{errSchemaPath:n}},{schemaPath:s,parentSchema:o}){let a=o?n:t.str`${n}/${e}`;return s&&(a=t.str`${a}${(0,r.getErrorPath)(s,r.Type.Str)}`),[i.schemaPath,a]}}(xe),Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.boolOrEmptySchema=Ce.topBoolOrEmptySchema=void 0;const Me=xe,Fe=Re,Le=Ie,qe={message:"boolean schema is false"};function Ue(e,t){const{gen:r,data:n}=e,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,Me.reportError)(s,qe,void 0,t)}Ce.topBoolOrEmptySchema=function(e){const{gen:t,schema:r,validateName:n}=e;!1===r?Ue(e,!1):"object"==typeof r&&!0===r.$async?t.return(Le.default.data):(t.assign(Fe._`${n}.errors`,null),t.return(!0))},Ce.boolOrEmptySchema=function(e,t){const{gen:r,schema:n}=e;!1===n?(r.var(t,!1),Ue(e)):r.var(t,!0)};var ze={},Ve={};Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.getRules=Ve.isJSONType=void 0;const We=new Set(["string","number","integer","boolean","null","object","array"]);Ve.isJSONType=function(e){return"string"==typeof e&&We.has(e)},Ve.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}};var Be={};function He(e,t){return t.rules.some((t=>Ge(e,t)))}function Ge(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some((t=>void 0!==e[t])))}Object.defineProperty(Be,"__esModule",{value:!0}),Be.shouldUseRule=Be.shouldUseGroup=Be.schemaHasRulesForType=void 0,Be.schemaHasRulesForType=function({schema:e,self:t},r){const n=t.RULES.types[r];return n&&!0!==n&&He(e,n)},Be.shouldUseGroup=He,Be.shouldUseRule=Ge,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=Ve,r=Be,n=xe,s=Re,o=Oe;var i,a;function c(e){const r=Array.isArray(e)?e:e?[e]:[];if(r.every(t.isJSONType))return r;throw new Error("type must be JSONType or JSONType[]: "+r.join(","))}(a=i=e.DataType||(e.DataType={}))[a.Correct=0]="Correct",a[a.Wrong=1]="Wrong",e.getSchemaTypes=function(e){const t=c(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},e.getJSONTypes=c,e.coerceAndCheckDataType=function(e,t){const{gen:n,data:o,opts:a}=e,c=function(e,t){return t?e.filter((e=>l.has(e)||"array"===t&&"array"===e)):[]}(t,a.coerceTypes),p=t.length>0&&!(0===c.length&&1===t.length&&(0,r.schemaHasRulesForType)(e,t[0]));if(p){const r=d(t,o,a.strictNumbers,i.Wrong);n.if(r,(()=>{c.length?function(e,t,r){const{gen:n,data:o,opts:i}=e,a=n.let("dataType",s._`typeof ${o}`),c=n.let("coerced",s._`undefined`);"array"===i.coerceTypes&&n.if(s._`${a} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,(()=>n.assign(o,s._`${o}[0]`).assign(a,s._`typeof ${o}`).if(d(t,o,i.strictNumbers),(()=>n.assign(c,o))))),n.if(s._`${c} !== undefined`);for(const s of r)(l.has(s)||"array"===s&&"array"===i.coerceTypes)&&p(s);function p(e){switch(e){case"string":return void n.elseIf(s._`${a} == "number" || ${a} == "boolean"`).assign(c,s._`"" + ${o}`).elseIf(s._`${o} === null`).assign(c,s._`""`);case"number":return void n.elseIf(s._`${a} == "boolean" || ${o} === null
              || (${a} == "string" && ${o} && ${o} == +${o})`).assign(c,s._`+${o}`);case"integer":return void n.elseIf(s._`${a} === "boolean" || ${o} === null
              || (${a} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(c,s._`+${o}`);case"boolean":return void n.elseIf(s._`${o} === "false" || ${o} === 0 || ${o} === null`).assign(c,!1).elseIf(s._`${o} === "true" || ${o} === 1`).assign(c,!0);case"null":return n.elseIf(s._`${o} === "" || ${o} === 0 || ${o} === false`),void n.assign(c,null);case"array":n.elseIf(s._`${a} === "string" || ${a} === "number"
              || ${a} === "boolean" || ${o} === null`).assign(c,s._`[${o}]`)}}n.else(),h(e),n.endIf(),n.if(s._`${c} !== undefined`,(()=>{n.assign(o,c),function({gen:e,parentData:t,parentDataProperty:r},n){e.if(s._`${t} !== undefined`,(()=>e.assign(s._`${t}[${r}]`,n)))}(e,c)}))}(e,t,c):h(e)}))}return p};const l=new Set(["string","number","integer","boolean","null"]);function p(e,t,r,n=i.Correct){const o=n===i.Correct?s.operators.EQ:s.operators.NEQ;let a;switch(e){case"null":return s._`${t} ${o} null`;case"array":a=s._`Array.isArray(${t})`;break;case"object":a=s._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":a=c(s._`!(${t} % 1) && !isNaN(${t})`);break;case"number":a=c();break;default:return s._`typeof ${t} ${o} ${e}`}return n===i.Correct?a:(0,s.not)(a);function c(e=s.nil){return(0,s.and)(s._`typeof ${t} == "number"`,e,r?s._`isFinite(${t})`:s.nil)}}function d(e,t,r,n){if(1===e.length)return p(e[0],t,r,n);let i;const a=(0,o.toHash)(e);if(a.array&&a.object){const e=s._`typeof ${t} != "object"`;i=a.null?e:s._`!${t} || ${e}`,delete a.null,delete a.array,delete a.object}else i=s.nil;a.number&&delete a.integer;for(const o in a)i=(0,s.and)(i,p(o,t,r,n));return i}e.checkDataType=p,e.checkDataTypes=d;const u={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?s._`{type: ${e}}`:s._`{type: ${t}}`};function h(e){const t=function(e){const{gen:t,data:r,schema:n}=e,s=(0,o.schemaRefOrVal)(e,n,"type");return{gen:t,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:e}}(e);(0,n.reportError)(t,u)}e.reportTypeError=h}(ze);var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.assignDefaults=void 0;const Je=Re,Qe=Oe;function Ze(e,t,r){const{gen:n,compositeRule:s,data:o,opts:i}=e;if(void 0===r)return;const a=Je._`${o}${(0,Je.getProperty)(t)}`;if(s)return void(0,Qe.checkStrictMode)(e,`default is ignored for: ${a}`);let c=Je._`${a} === undefined`;"empty"===i.useDefaults&&(c=Je._`${c} || ${a} === null || ${a} === ""`),n.if(c,Je._`${a} = ${(0,Je.stringify)(r)}`)}Ke.assignDefaults=function(e,t){const{properties:r,items:n}=e.schema;if("object"===t&&r)for(const s in r)Ze(e,s,r[s].default);else"array"===t&&Array.isArray(n)&&n.forEach(((t,r)=>Ze(e,r,t.default)))};var Ye={},Xe={};Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.validateUnion=Xe.validateArray=Xe.usePattern=Xe.callValidateCode=Xe.schemaProperties=Xe.allSchemaProperties=Xe.noPropertyInData=Xe.propertyInData=Xe.isOwnProperty=Xe.hasPropFunc=Xe.reportMissingProp=Xe.checkMissingProp=Xe.checkReportMissingProp=void 0;const et=Re,tt=Oe,rt=Ie,nt=Oe;function st(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:et._`Object.prototype.hasOwnProperty`})}function ot(e,t,r){return et._`${st(e)}.call(${t}, ${r})`}function it(e,t,r,n){const s=et._`${t}${(0,et.getProperty)(r)} === undefined`;return n?(0,et.or)(s,(0,et.not)(ot(e,t,r))):s}function at(e){return e?Object.keys(e).filter((e=>"__proto__"!==e)):[]}Xe.checkReportMissingProp=function(e,t){const{gen:r,data:n,it:s}=e;r.if(it(r,n,t,s.opts.ownProperties),(()=>{e.setParams({missingProperty:et._`${t}`},!0),e.error()}))},Xe.checkMissingProp=function({gen:e,data:t,it:{opts:r}},n,s){return(0,et.or)(...n.map((n=>(0,et.and)(it(e,t,n,r.ownProperties),et._`${s} = ${n}`))))},Xe.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},Xe.hasPropFunc=st,Xe.isOwnProperty=ot,Xe.propertyInData=function(e,t,r,n){const s=et._`${t}${(0,et.getProperty)(r)} !== undefined`;return n?et._`${s} && ${ot(e,t,r)}`:s},Xe.noPropertyInData=it,Xe.allSchemaProperties=at,Xe.schemaProperties=function(e,t){return at(t).filter((r=>!(0,tt.alwaysValidSchema)(e,t[r])))},Xe.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:o},it:i},a,c,l){const p=l?et._`${e}, ${t}, ${n}${s}`:t,d=[[rt.default.instancePath,(0,et.strConcat)(rt.default.instancePath,o)],[rt.default.parentData,i.parentData],[rt.default.parentDataProperty,i.parentDataProperty],[rt.default.rootData,rt.default.rootData]];i.opts.dynamicRef&&d.push([rt.default.dynamicAnchors,rt.default.dynamicAnchors]);const u=et._`${p}, ${r.object(...d)}`;return c!==et.nil?et._`${a}.call(${c}, ${u})`:et._`${a}(${u})`};const ct=et._`new RegExp`;Xe.usePattern=function({gen:e,it:{opts:t}},r){const n=t.unicodeRegExp?"u":"",{regExp:s}=t.code,o=s(r,n);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:et._`${"new RegExp"===s.code?ct:(0,nt.useFunc)(e,s)}(${r}, ${n})`})},Xe.validateArray=function(e){const{gen:t,data:r,keyword:n,it:s}=e,o=t.name("valid");if(s.allErrors){const e=t.let("valid",!0);return i((()=>t.assign(e,!1))),e}return t.var(o,!0),i((()=>t.break())),o;function i(s){const i=t.const("len",et._`${r}.length`);t.forRange("i",0,i,(r=>{e.subschema({keyword:n,dataProp:r,dataPropType:tt.Type.Num},o),t.if((0,et.not)(o),s)}))}},Xe.validateUnion=function(e){const{gen:t,schema:r,keyword:n,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some((e=>(0,tt.alwaysValidSchema)(s,e)))&&!s.opts.unevaluated)return;const o=t.let("valid",!1),i=t.name("_valid");t.block((()=>r.forEach(((r,s)=>{const a=e.subschema({keyword:n,schemaProp:s,compositeRule:!0},i);t.assign(o,et._`${o} || ${i}`),e.mergeValidEvaluated(a,i)||t.if((0,et.not)(o))})))),e.result(o,(()=>e.reset()),(()=>e.error(!0)))},Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.validateKeywordUsage=Ye.validSchemaType=Ye.funcKeywordCode=Ye.macroKeywordCode=void 0;const lt=Re,pt=Ie,dt=Xe,ut=xe;function ht(e){const{gen:t,data:r,it:n}=e;t.if(n.parentData,(()=>t.assign(r,lt._`${n.parentData}[${n.parentDataProperty}]`)))}function ft(e,t,r){if(void 0===r)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:(0,lt.stringify)(r)})}Ye.macroKeywordCode=function(e,t){const{gen:r,keyword:n,schema:s,parentSchema:o,it:i}=e,a=t.macro.call(i.self,s,o,i),c=ft(r,n,a);!1!==i.opts.validateSchema&&i.self.validateSchema(a,!0);const l=r.name("valid");e.subschema({schema:a,schemaPath:lt.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},l),e.pass(l,(()=>e.error(!0)))},Ye.funcKeywordCode=function(e,t){var r;const{gen:n,keyword:s,schema:o,parentSchema:i,$data:a,it:c}=e;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(c,t);const l=!a&&t.compile?t.compile.call(c.self,o,i,c):t.validate,p=ft(n,s,l),d=n.let("valid");function u(r=(t.async?lt._`await `:lt.nil)){const s=c.opts.passContext?pt.default.this:pt.default.self,o=!("compile"in t&&!a||!1===t.schema);n.assign(d,lt._`${r}${(0,dt.callValidateCode)(e,p,s,o)}`,t.modifying)}function h(e){var r;n.if((0,lt.not)(null!==(r=t.valid)&&void 0!==r?r:d),e)}e.block$data(d,(function(){if(!1===t.errors)u(),t.modifying&&ht(e),h((()=>e.error()));else{const r=t.async?function(){const e=n.let("ruleErrs",null);return n.try((()=>u(lt._`await `)),(t=>n.assign(d,!1).if(lt._`${t} instanceof ${c.ValidationError}`,(()=>n.assign(e,lt._`${t}.errors`)),(()=>n.throw(t))))),e}():function(){const e=lt._`${p}.errors`;return n.assign(e,null),u(lt.nil),e}();t.modifying&&ht(e),h((()=>function(e,t){const{gen:r}=e;r.if(lt._`Array.isArray(${t})`,(()=>{r.assign(pt.default.vErrors,lt._`${pt.default.vErrors} === null ? ${t} : ${pt.default.vErrors}.concat(${t})`).assign(pt.default.errors,lt._`${pt.default.vErrors}.length`),(0,ut.extendErrors)(e)}),(()=>e.error()))}(e,r)))}})),e.ok(null!==(r=t.valid)&&void 0!==r?r:d)},Ye.validSchemaType=function(e,t,r=!1){return!t.length||t.some((t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&typeof e>"u"))},Ye.validateKeywordUsage=function({schema:e,opts:t,self:r,errSchemaPath:n},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");const i=s.dependencies;if(null!=i&&i.some((t=>!Object.prototype.hasOwnProperty.call(e,t))))throw new Error(`parent schema must have dependencies of ${o}: ${i.join(",")}`);if(s.validateSchema&&!s.validateSchema(e[o])){const e=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}};var mt={};Object.defineProperty(mt,"__esModule",{value:!0}),mt.extendSubschemaMode=mt.extendSubschemaData=mt.getSubschema=void 0;const yt=Re,gt=Oe;mt.getSubschema=function(e,{keyword:t,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:o,topSchemaRef:i}){if(void 0!==t&&void 0!==n)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){const n=e.schema[t];return void 0===r?{schema:n,schemaPath:yt._`${e.schemaPath}${(0,yt.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:n[r],schemaPath:yt._`${e.schemaPath}${(0,yt.getProperty)(t)}${(0,yt.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,gt.escapeFragment)(r)}`}}if(void 0!==n){if(void 0===s||void 0===o||void 0===i)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:i,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')},mt.extendSubschemaData=function(e,t,{dataProp:r,dataPropType:n,data:s,dataTypes:o,propertyName:i}){if(void 0!==s&&void 0!==r)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:a}=t;if(void 0!==r){const{errorPath:s,dataPathArr:o,opts:i}=t;c(a.let("data",yt._`${t.data}${(0,yt.getProperty)(r)}`,!0)),e.errorPath=yt.str`${s}${(0,gt.getErrorPath)(r,n,i.jsPropertySyntax)}`,e.parentDataProperty=yt._`${r}`,e.dataPathArr=[...o,e.parentDataProperty]}if(void 0!==s){c(s instanceof yt.Name?s:a.let("data",s,!0)),void 0!==i&&(e.propertyName=i)}function c(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,r]}o&&(e.dataTypes=o)},mt.extendSubschemaMode=function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:o}){void 0!==n&&(e.compositeRule=n),void 0!==s&&(e.createErrors=s),void 0!==o&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=r};var vt={},wt=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(s=n;0!=s--;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=n;0!=s--;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;0!=s--;){var i=o[s];if(!e(t[i],r[i]))return!1}return!0}return t!=t&&r!=r},$t={exports:{}},_t=$t.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),bt(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};function bt(e,t,r,n,s,o,i,a,c,l){if(n&&"object"==typeof n&&!Array.isArray(n)){for(var p in t(n,s,o,i,a,c,l),n){var d=n[p];if(Array.isArray(d)){if(p in _t.arrayKeywords)for(var u=0;u<d.length;u++)bt(e,t,r,d[u],s+"/"+p+"/"+u,o,s,p,n,u)}else if(p in _t.propsKeywords){if(d&&"object"==typeof d)for(var h in d)bt(e,t,r,d[h],s+"/"+p+"/"+Et(h),o,s,p,n,h)}else(p in _t.keywords||e.allKeys&&!(p in _t.skipKeywords))&&bt(e,t,r,d,s+"/"+p,o,s,p,n)}r(n,s,o,i,a,c,l)}}function Et(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}_t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},_t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},_t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},_t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};var Pt=$t.exports;Object.defineProperty(vt,"__esModule",{value:!0}),vt.getSchemaRefs=vt.resolveUrl=vt.normalizeId=vt._getFullPath=vt.getFullPath=vt.inlineRef=void 0;const St=Oe,kt=wt,Tt=Pt,Ct=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);vt.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!Rt(e):!!t&&Nt(e)<=t)};const xt=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Rt(e){for(const t in e){if(xt.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(Rt)||"object"==typeof r&&Rt(r))return!0}return!1}function Nt(e){let t=0;for(const r in e){if("$ref"===r)return 1/0;if(t++,!Ct.has(r)&&("object"==typeof e[r]&&(0,St.eachItem)(e[r],(e=>t+=Nt(e))),t===1/0))return 1/0}return t}function jt(e,t="",r){!1!==r&&(t=At(t));const n=e.parse(t);return Ot(e,n)}function Ot(e,t){return e.serialize(t).split("#")[0]+"#"}vt.getFullPath=jt,vt._getFullPath=Ot;const It=/#\/?$/;function At(e){return e?e.replace(It,""):""}vt.normalizeId=At,vt.resolveUrl=function(e,t,r){return r=At(r),e.resolve(t,r)};const Dt=/^[a-z_][-a-z0-9._]*$/i;vt.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};const{schemaId:r,uriResolver:n}=this.opts,s=At(e[r]||t),o={"":s},i=jt(n,s,!1),a={},c=new Set;return Tt(e,{allKeys:!0},((e,t,n,s)=>{if(void 0===s)return;const d=i+t;let u=o[s];function h(t){const r=this.opts.uriResolver.resolve;if(t=At(u?r(u,t):t),c.has(t))throw p(t);c.add(t);let n=this.refs[t];return"string"==typeof n&&(n=this.refs[n]),"object"==typeof n?l(e,n.schema,t):t!==At(d)&&("#"===t[0]?(l(e,a[t],t),a[t]=e):this.refs[t]=d),t}function f(e){if("string"==typeof e){if(!Dt.test(e))throw new Error(`invalid anchor "${e}"`);h.call(this,`#${e}`)}}"string"==typeof e[r]&&(u=h.call(this,e[r])),f.call(this,e.$anchor),f.call(this,e.$dynamicAnchor),o[t]=u})),a;function l(e,t,r){if(void 0!==t&&!kt(e,t))throw p(r)}function p(e){return new Error(`reference "${e}" resolves to more than one schema`)}},Object.defineProperty(Te,"__esModule",{value:!0}),Te.getData=Te.KeywordCxt=Te.validateFunctionCode=void 0;const Mt=Ce,Ft=ze,Lt=Be,qt=ze,Ut=Ke,zt=Ye,Vt=mt,Wt=Re,Bt=Ie,Ht=vt,Gt=Oe,Kt=xe;function Jt({gen:e,validateName:t,schema:r,schemaEnv:n,opts:s},o){s.code.es5?e.func(t,Wt._`${Bt.default.data}, ${Bt.default.valCxt}`,n.$async,(()=>{e.code(Wt._`"use strict"; ${Qt(r,s)}`),function(e,t){e.if(Bt.default.valCxt,(()=>{e.var(Bt.default.instancePath,Wt._`${Bt.default.valCxt}.${Bt.default.instancePath}`),e.var(Bt.default.parentData,Wt._`${Bt.default.valCxt}.${Bt.default.parentData}`),e.var(Bt.default.parentDataProperty,Wt._`${Bt.default.valCxt}.${Bt.default.parentDataProperty}`),e.var(Bt.default.rootData,Wt._`${Bt.default.valCxt}.${Bt.default.rootData}`),t.dynamicRef&&e.var(Bt.default.dynamicAnchors,Wt._`${Bt.default.valCxt}.${Bt.default.dynamicAnchors}`)}),(()=>{e.var(Bt.default.instancePath,Wt._`""`),e.var(Bt.default.parentData,Wt._`undefined`),e.var(Bt.default.parentDataProperty,Wt._`undefined`),e.var(Bt.default.rootData,Bt.default.data),t.dynamicRef&&e.var(Bt.default.dynamicAnchors,Wt._`{}`)}))}(e,s),e.code(o)})):e.func(t,Wt._`${Bt.default.data}, ${function(e){return Wt._`{${Bt.default.instancePath}="", ${Bt.default.parentData}, ${Bt.default.parentDataProperty}, ${Bt.default.rootData}=${Bt.default.data}${e.dynamicRef?Wt._`, ${Bt.default.dynamicAnchors}={}`:Wt.nil}}={}`}(s)}`,n.$async,(()=>e.code(Qt(r,s)).code(o)))}function Qt(e,t){const r="object"==typeof e&&e[t.schemaId];return r&&(t.code.source||t.code.process)?Wt._`/*# sourceURL=${r} */`:Wt.nil}function Zt(e,t){Xt(e)&&(er(e),Yt(e))?function(e,t){const{schema:r,gen:n,opts:s}=e;s.$comment&&r.$comment&&rr(e),function(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,Ht.resolveUrl)(e.opts.uriResolver,e.baseId,t))}(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const o=n.const("_errs",Bt.default.errors);tr(e,o),n.var(t,Wt._`${o} === ${Bt.default.errors}`)}(e,t):(0,Mt.boolOrEmptySchema)(e,t)}function Yt({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function Xt(e){return"boolean"!=typeof e.schema}function er(e){(0,Gt.checkUnknownRules)(e),function(e){const{schema:t,errSchemaPath:r,opts:n,self:s}=e;t.$ref&&n.ignoreKeywordsWithRef&&(0,Gt.schemaHasRulesButRef)(t,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function tr(e,t){if(e.opts.jtd)return nr(e,[],!1,t);const r=(0,Ft.getSchemaTypes)(e.schema);nr(e,r,!(0,Ft.coerceAndCheckDataType)(e,r),t)}function rr({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:s}){const o=r.$comment;if(!0===s.$comment)e.code(Wt._`${Bt.default.self}.logger.log(${o})`);else if("function"==typeof s.$comment){const r=Wt.str`${n}/$comment`,s=e.scopeValue("root",{ref:t.root});e.code(Wt._`${Bt.default.self}.opts.$comment(${o}, ${r}, ${s}.schema)`)}}function nr(e,t,r,n){const{gen:s,schema:o,data:i,allErrors:a,opts:c,self:l}=e,{RULES:p}=l;function d(l){(0,Lt.shouldUseGroup)(o,l)&&(l.type?(s.if((0,qt.checkDataType)(l.type,i,c.strictNumbers)),sr(e,l),1===t.length&&t[0]===l.type&&r&&(s.else(),(0,qt.reportTypeError)(e)),s.endIf()):sr(e,l),a||s.if(Wt._`${Bt.default.errors} === ${n||0}`))}!o.$ref||!c.ignoreKeywordsWithRef&&(0,Gt.schemaHasRulesButRef)(o,p)?(c.jtd||function(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(function(e,t){if(t.length){if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach((t=>{ir(e.dataTypes,t)||ar(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)})),function(e,t){const r=[];for(const n of e.dataTypes)ir(t,n)?r.push(n):t.includes("integer")&&"number"===n&&r.push("integer");e.dataTypes=r}(e,t)}}(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&ar(e,"use allowUnionTypes to allow union type keyword")}(e,t),function(e,t){const r=e.self.RULES.all;for(const n in r){const s=r[n];if("object"==typeof s&&(0,Lt.shouldUseRule)(e.schema,s)){const{type:r}=s.definition;r.length&&!r.some((e=>or(t,e)))&&ar(e,`missing type "${r.join(",")}" for keyword "${n}"`)}}}(e,e.dataTypes))}(e,t),s.block((()=>{for(const e of p.rules)d(e);d(p.post)}))):s.block((()=>lr(e,"$ref",p.all.$ref.definition)))}function sr(e,t){const{gen:r,schema:n,opts:{useDefaults:s}}=e;s&&(0,Ut.assignDefaults)(e,t.type),r.block((()=>{for(const r of t.rules)(0,Lt.shouldUseRule)(n,r)&&lr(e,r.keyword,r.definition,t.type)}))}function or(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function ir(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function ar(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,(0,Gt.checkStrictMode)(e,t,e.opts.strictTypes)}Te.validateFunctionCode=function(e){Xt(e)&&(er(e),Yt(e))?function(e){const{schema:t,opts:r,gen:n}=e;Jt(e,(()=>{r.$comment&&t.$comment&&rr(e),function(e){const{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strictSchema&&(0,Gt.checkStrictMode)(e,"default is ignored in the schema root")}(e),n.let(Bt.default.vErrors,null),n.let(Bt.default.errors,0),r.unevaluated&&function(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",Wt._`${r}.evaluated`),t.if(Wt._`${e.evaluated}.dynamicProps`,(()=>t.assign(Wt._`${e.evaluated}.props`,Wt._`undefined`))),t.if(Wt._`${e.evaluated}.dynamicItems`,(()=>t.assign(Wt._`${e.evaluated}.items`,Wt._`undefined`)))}(e),tr(e),function(e){const{gen:t,schemaEnv:r,validateName:n,ValidationError:s,opts:o}=e;r.$async?t.if(Wt._`${Bt.default.errors} === 0`,(()=>t.return(Bt.default.data)),(()=>t.throw(Wt._`new ${s}(${Bt.default.vErrors})`))):(t.assign(Wt._`${n}.errors`,Bt.default.vErrors),o.unevaluated&&function({gen:e,evaluated:t,props:r,items:n}){r instanceof Wt.Name&&e.assign(Wt._`${t}.props`,r),n instanceof Wt.Name&&e.assign(Wt._`${t}.items`,n)}(e),t.return(Wt._`${Bt.default.errors} === 0`))}(e)}))}(e):Jt(e,(()=>(0,Mt.topBoolOrEmptySchema)(e)))};class cr{constructor(e,t,r){if((0,zt.validateKeywordUsage)(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Gt.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",ur(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,zt.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",Bt.default.errors))}result(e,t,r){this.failResult((0,Wt.not)(e),t,r)}failResult(e,t,r){this.gen.if(e),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,Wt.not)(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(Wt._`${t} !== undefined && (${(0,Wt.or)(this.invalid$data(),e)})`)}error(e,t,r){if(t)return this.setParams(t),this._error(e,r),void this.setParams({});this._error(e,r)}_error(e,t){(e?Kt.reportExtraError:Kt.reportError)(this,this.def.error,t)}$dataError(){(0,Kt.reportError)(this,this.def.$dataError||Kt.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,Kt.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=Wt.nil){this.gen.block((()=>{this.check$data(e,r),t()}))}check$data(e=Wt.nil,t=Wt.nil){if(!this.$data)return;const{gen:r,schemaCode:n,schemaType:s,def:o}=this;r.if((0,Wt.or)(Wt._`${n} === undefined`,t)),e!==Wt.nil&&r.assign(e,!0),(s.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==Wt.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:r,def:n,it:s}=this;return(0,Wt.or)(function(){if(r.length){if(!(t instanceof Wt.Name))throw new Error("ajv implementation error");const e=Array.isArray(r)?r:[r];return Wt._`${(0,qt.checkDataTypes)(e,t,s.opts.strictNumbers,qt.DataType.Wrong)}`}return Wt.nil}(),function(){if(n.validateSchema){const r=e.scopeValue("validate$data",{ref:n.validateSchema});return Wt._`!${r}(${t})`}return Wt.nil}())}subschema(e,t){const r=(0,Vt.getSubschema)(this.it,e);(0,Vt.extendSubschemaData)(r,this.it,e),(0,Vt.extendSubschemaMode)(r,e);const n={...this.it,...r,items:void 0,props:void 0};return Zt(n,t),n}mergeEvaluated(e,t){const{it:r,gen:n}=this;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=Gt.mergeEvaluated.props(n,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=Gt.mergeEvaluated.items(n,e.items,r.items,t)))}mergeValidEvaluated(e,t){const{it:r,gen:n}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return n.if(t,(()=>this.mergeEvaluated(e,Wt.Name))),!0}}function lr(e,t,r,n){const s=new cr(e,r,t);"code"in r?r.code(s,n):s.$data&&r.validate?(0,zt.funcKeywordCode)(s,r):"macro"in r?(0,zt.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,zt.funcKeywordCode)(s,r)}Te.KeywordCxt=cr;const pr=/^\/(?:[^~]|~0|~1)*$/,dr=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ur(e,{dataLevel:t,dataNames:r,dataPathArr:n}){let s,o;if(""===e)return Bt.default.rootData;if("/"===e[0]){if(!pr.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);s=e,o=Bt.default.rootData}else{const i=dr.exec(e);if(!i)throw new Error(`Invalid JSON-pointer: ${e}`);const a=+i[1];if(s=i[2],"#"===s){if(a>=t)throw new Error(c("property/index",a));return n[t-a]}if(a>t)throw new Error(c("data",a));if(o=r[t-a],!s)return o}let i=o;const a=s.split("/");for(const l of a)l&&(o=Wt._`${o}${(0,Wt.getProperty)((0,Gt.unescapeJsonPointer)(l))}`,i=Wt._`${i} && ${o}`);return i;function c(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}Te.getData=ur;var hr={};Object.defineProperty(hr,"__esModule",{value:!0});class fr extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}hr.default=fr;var mr={};Object.defineProperty(mr,"__esModule",{value:!0});const yr=vt;class gr extends Error{constructor(e,t,r,n){super(n||`can't resolve reference ${r} from id ${t}`),this.missingRef=(0,yr.resolveUrl)(e,t,r),this.missingSchema=(0,yr.normalizeId)((0,yr.getFullPath)(e,this.missingRef))}}mr.default=gr;var vr={};Object.defineProperty(vr,"__esModule",{value:!0}),vr.resolveSchema=vr.getCompilingSchema=vr.resolveRef=vr.compileSchema=vr.SchemaEnv=void 0;const wr=Re,$r=hr,_r=Ie,br=vt,Er=Oe,Pr=Te;class Sr{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,br.normalizeId)(null==r?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function kr(e){const t=Cr.call(this,e);if(t)return t;const r=(0,br.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:o}=this.opts,i=new wr.CodeGen(this.scope,{es5:n,lines:s,ownProperties:o});let a;e.$async&&(a=i.scopeValue("Error",{ref:$r.default,code:wr._`require("ajv/dist/runtime/validation_error").default`}));const c=i.scopeName("validate");e.validateName=c;const l={gen:i,allErrors:this.opts.allErrors,data:_r.default.data,parentData:_r.default.parentData,parentDataProperty:_r.default.parentDataProperty,dataNames:[_r.default.data],dataPathArr:[wr.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,wr.stringify)(e.schema)}:{ref:e.schema}),validateName:c,ValidationError:a,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:wr.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:wr._`""`,opts:this.opts,self:this};let p;try{this._compilations.add(e),(0,Pr.validateFunctionCode)(l),i.optimize(this.opts.code.optimize);const t=i.toString();p=`${i.scopeRefs(_r.default.scope)}return ${t}`,this.opts.code.process&&(p=this.opts.code.process(p,e));const r=new Function(`${_r.default.self}`,`${_r.default.scope}`,p)(this,this.scope.get());if(this.scope.value(c,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:c,validateCode:t,scopeValues:i._values}),this.opts.unevaluated){const{props:e,items:t}=l;r.evaluated={props:e instanceof wr.Name?void 0:e,items:t instanceof wr.Name?void 0:t,dynamicProps:e instanceof wr.Name,dynamicItems:t instanceof wr.Name},r.source&&(r.source.evaluated=(0,wr.stringify)(r.evaluated))}return e.validate=r,e}catch(d){throw delete e.validate,delete e.validateName,p&&this.logger.error("Error compiling schema, function code:",p),d}finally{this._compilations.delete(e)}}function Tr(e){return(0,br.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:kr.call(this,e)}function Cr(e){for(const t of this._compilations)if(xr(t,e))return t}function xr(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function Rr(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||Nr.call(this,e,t)}function Nr(e,t){const r=this.opts.uriResolver.parse(t),n=(0,br._getFullPath)(this.opts.uriResolver,r);let s=(0,br.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&n===s)return Or.call(this,r,e);const o=(0,br.normalizeId)(n),i=this.refs[o]||this.schemas[o];if("string"==typeof i){const t=Nr.call(this,e,i);return"object"!=typeof(null==t?void 0:t.schema)?void 0:Or.call(this,r,t)}if("object"==typeof(null==i?void 0:i.schema)){if(i.validate||kr.call(this,i),o===(0,br.normalizeId)(t)){const{schema:t}=i,{schemaId:r}=this.opts,n=t[r];return n&&(s=(0,br.resolveUrl)(this.opts.uriResolver,s,n)),new Sr({schema:t,schemaId:r,root:e,baseId:s})}return Or.call(this,r,i)}}vr.SchemaEnv=Sr,vr.compileSchema=kr,vr.resolveRef=function(e,t,r){var n;r=(0,br.resolveUrl)(this.opts.uriResolver,t,r);const s=e.refs[r];if(s)return s;let o=Rr.call(this,e,r);if(void 0===o){const s=null===(n=e.localRefs)||void 0===n?void 0:n[r],{schemaId:i}=this.opts;s&&(o=new Sr({schema:s,schemaId:i,root:e,baseId:t}))}return void 0!==o?e.refs[r]=Tr.call(this,o):void 0},vr.getCompilingSchema=Cr,vr.resolveSchema=Nr;const jr=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Or(e,{baseId:t,schema:r,root:n}){var s;if("/"!==(null===(s=e.fragment)||void 0===s?void 0:s[0]))return;for(const a of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;const e=r[(0,Er.unescapeFragment)(a)];if(void 0===e)return;const n="object"==typeof(r=e)&&r[this.opts.schemaId];!jr.has(a)&&n&&(t=(0,br.resolveUrl)(this.opts.uriResolver,t,n))}let o;if("boolean"!=typeof r&&r.$ref&&!(0,Er.schemaHasRulesButRef)(r,this.RULES)){const e=(0,br.resolveUrl)(this.opts.uriResolver,t,r.$ref);o=Nr.call(this,n,e)}const{schemaId:i}=this.opts;return o=o||new Sr({schema:r,schemaId:i,root:n,baseId:t}),o.schema!==o.root.schema?o:void 0}const Ir={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1};var Ar={},Dr={exports:{}};(function(e){function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,s=1;s<n;++s)t[s]=t[s].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function s(e){return e.toUpperCase()}function o(e){return null!=e?e instanceof Array?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}function i(e,t){var r=e;if(t)for(var n in t)r[n]=t[n];return r}function a(e){var n="[A-Za-z]",s="[0-9]",o=t(s,"[A-Fa-f]"),i=r(r("%[EFef]"+o+"%"+o+o+"%"+o+o)+"|"+r("%[89A-Fa-f]"+o+"%"+o+o)+"|"+r("%"+o+o)),a="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",c=t("[\\:\\/\\?\\#\\[\\]\\@]",a),l=e?"[\\uE000-\\uF8FF]":"[]",p=t(n,s,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]");r(n+t(n,s,"[\\+\\-\\.]")+"*"),r(r(i+"|"+t(p,a,"[\\:]"))+"*");var d=r(r("25[0-5]")+"|"+r("2[0-4]"+s)+"|"+r("1"+s+s)+"|"+r("0?[1-9]"+s)+"|0?0?"+s),u=r(d+"\\."+d+"\\."+d+"\\."+d),h=r(o+"{1,4}"),f=r(r(h+"\\:"+h)+"|"+u),m=r(r(h+"\\:")+"{6}"+f),y=r("\\:\\:"+r(h+"\\:")+"{5}"+f),g=r(r(h)+"?\\:\\:"+r(h+"\\:")+"{4}"+f),v=r(r(r(h+"\\:")+"{0,1}"+h)+"?\\:\\:"+r(h+"\\:")+"{3}"+f),w=r(r(r(h+"\\:")+"{0,2}"+h)+"?\\:\\:"+r(h+"\\:")+"{2}"+f),$=r(r(r(h+"\\:")+"{0,3}"+h)+"?\\:\\:"+h+"\\:"+f),_=r(r(r(h+"\\:")+"{0,4}"+h)+"?\\:\\:"+f),b=r(r(r(h+"\\:")+"{0,5}"+h)+"?\\:\\:"+h),E=r(r(r(h+"\\:")+"{0,6}"+h)+"?\\:\\:"),P=r([m,y,g,v,w,$,_,b,E].join("|")),S=r(r(p+"|"+i)+"+");r("[vV]"+o+"+\\."+t(p,a,"[\\:]")+"+"),r(r(i+"|"+t(p,a))+"*");var k=r(i+"|"+t(p,a,"[\\:\\@]"));return r(r(i+"|"+t(p,a,"[\\@]"))+"+"),r(r(k+"|"+t("[\\/\\?]",l))+"*"),{NOT_SCHEME:new RegExp(t("[^]",n,s,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",p,a),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",p,a),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",p,a),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",p,a),"g"),NOT_QUERY:new RegExp(t("[^\\%]",p,a,"[\\:\\@\\/\\?]",l),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",p,a,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",p,a),"g"),UNRESERVED:new RegExp(p,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",p,c),"g"),PCT_ENCODED:new RegExp(i,"g"),IPV4ADDRESS:new RegExp("^("+u+")$"),IPV6ADDRESS:new RegExp("^\\[?("+P+")"+r(r("\\%25|\\%(?!"+o+"{2})")+"("+S+")")+"?\\]?$")}}var c=a(!1),l=a(!0),p=function(){function e(e,t){var r=[],n=!0,s=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(c){s=!0,o=c}finally{try{!n&&a.return&&a.return()}finally{if(s)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},u=2147483647,h=36,f=1,m=26,y=38,g=700,v=72,w=128,$="-",_=/^xn--/,b=/[^\0-\x7E]/,E=/[\x2E\u3002\uFF0E\uFF61]/g,P={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=h-f,k=Math.floor,T=String.fromCharCode;function C(e){throw new RangeError(P[e])}function x(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}function R(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+x((e=e.replace(E,".")).split("."),t).join(".")}function N(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&s)<<10)+(1023&o)+65536):(t.push(s),r--)}else t.push(s)}return t}var j=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:h},O=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},I=function(e,t,r){var n=0;for(e=r?k(e/g):e>>1,e+=k(e/t);e>S*m>>1;n+=h)e=k(e/S);return k(n+(S+1)*e/(e+y))},A=function(e){var t=[],r=e.length,n=0,s=w,o=v,i=e.lastIndexOf($);i<0&&(i=0);for(var a=0;a<i;++a)e.charCodeAt(a)>=128&&C("not-basic"),t.push(e.charCodeAt(a));for(var c=i>0?i+1:0;c<r;){for(var l=n,p=1,d=h;;d+=h){c>=r&&C("invalid-input");var y=j(e.charCodeAt(c++));(y>=h||y>k((u-n)/p))&&C("overflow"),n+=y*p;var g=d<=o?f:d>=o+m?m:d-o;if(y<g)break;var _=h-g;p>k(u/_)&&C("overflow"),p*=_}var b=t.length+1;o=I(n-l,b,0==l),k(n/b)>u-s&&C("overflow"),s+=k(n/b),n%=b,t.splice(n++,0,s)}return String.fromCodePoint.apply(String,t)},D=function(e){var t=[],r=(e=N(e)).length,n=w,s=0,o=v,i=!0,a=!1,c=void 0;try{for(var l,p=e[Symbol.iterator]();!(i=(l=p.next()).done);i=!0){var d=l.value;d<128&&t.push(T(d))}}catch(H){a=!0,c=H}finally{try{!i&&p.return&&p.return()}finally{if(a)throw c}}var y=t.length,g=y;for(y&&t.push($);g<r;){var _=u,b=!0,E=!1,P=void 0;try{for(var S,x=e[Symbol.iterator]();!(b=(S=x.next()).done);b=!0){var R=S.value;R>=n&&R<_&&(_=R)}}catch(H){E=!0,P=H}finally{try{!b&&x.return&&x.return()}finally{if(E)throw P}}var j=g+1;_-n>k((u-s)/j)&&C("overflow"),s+=(_-n)*j,n=_;var A=!0,D=!1,M=void 0;try{for(var F,L=e[Symbol.iterator]();!(A=(F=L.next()).done);A=!0){var q=F.value;if(q<n&&++s>u&&C("overflow"),q==n){for(var U=s,z=h;;z+=h){var V=z<=o?f:z>=o+m?m:z-o;if(U<V)break;var W=U-V,B=h-V;t.push(T(O(V+W%B,0))),U=k(W/B)}t.push(T(O(U,0))),o=I(s,j,g==y),s=0,++g}}}catch(H){D=!0,M=H}finally{try{!A&&L.return&&L.return()}finally{if(D)throw M}}++s,++n}return t.join("")},M=function(e){return R(e,(function(e){return _.test(e)?A(e.slice(4).toLowerCase()):e}))},F=function(e){return R(e,(function(e){return b.test(e)?"xn--"+D(e):e}))},L={version:"2.1.0",ucs2:{decode:N,encode:function(e){return String.fromCodePoint.apply(String,d(e))}},decode:A,encode:D,toASCII:F,toUnicode:M},q={};function U(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function z(e){for(var t="",r=0,n=e.length;r<n;){var s=parseInt(e.substr(r+1,2),16);if(s<128)t+=String.fromCharCode(s),r+=3;else if(s>=194&&s<224){if(n-r>=6){var o=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&s)<<6|63&o)}else t+=e.substr(r,6);r+=6}else if(s>=224){if(n-r>=9){var i=parseInt(e.substr(r+4,2),16),a=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&s)<<12|(63&i)<<6|63&a)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function V(e,t){function r(e){var r=z(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,U).replace(t.PCT_ENCODED,s)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,U).replace(t.PCT_ENCODED,s)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,U).replace(t.PCT_ENCODED,s)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,U).replace(t.PCT_ENCODED,s)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,U).replace(t.PCT_ENCODED,s)),e}function W(e){return e.replace(/^0*(.*)/,"$1")||"0"}function B(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=p(r,2)[1];return n?n.split(".").map(W).join("."):e}function H(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=p(r,3),s=n[1],o=n[2];if(s){for(var i=s.toLowerCase().split("::").reverse(),a=p(i,2),c=a[0],l=a[1],d=l?l.split(":").map(W):[],u=c.split(":").map(W),h=t.IPV4ADDRESS.test(u[u.length-1]),f=h?7:8,m=u.length-f,y=Array(f),g=0;g<f;++g)y[g]=d[g]||u[m+g]||"";h&&(y[f-1]=B(y[f-1],t));var v=y.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],w=void 0;if(v&&v.length>1){var $=y.slice(0,v.index),_=y.slice(v.index+v.length);w=$.join(":")+"::"+_.join(":")}else w=y.join(":");return o&&(w+="%"+o),w}return e}var G=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,K=void 0==="".match(/(){0}/)[1];function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?l:c;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var s=e.match(G);if(s){K?(r.scheme=s[1],r.userinfo=s[3],r.host=s[4],r.port=parseInt(s[5],10),r.path=s[6]||"",r.query=s[7],r.fragment=s[8],isNaN(r.port)&&(r.port=s[5])):(r.scheme=s[1]||void 0,r.userinfo=-1!==e.indexOf("@")?s[3]:void 0,r.host=-1!==e.indexOf("//")?s[4]:void 0,r.port=parseInt(s[5],10),r.path=s[6]||"",r.query=-1!==e.indexOf("?")?s[7]:void 0,r.fragment=-1!==e.indexOf("#")?s[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?s[4]:void 0)),r.host&&(r.host=H(B(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var o=q[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)V(r,n);else{if(r.host&&(t.domainHost||o&&o.domainHost))try{r.host=L.toASCII(r.host.replace(n.PCT_ENCODED,z).toLowerCase())}catch(i){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+i}V(r,c)}o&&o.parse&&o.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function Q(e,t){var r=!1!==t.iri?l:c,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(H(B(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),("number"==typeof e.port||"string"==typeof e.port)&&(n.push(":"),n.push(String(e.port))),n.length?n.join(""):void 0}var Z=/^\.\.?\//,Y=/^\/\.(\/|$)/,X=/^\/\.\.(\/|$)/,ee=/^\/?(?:.|\n)*?(?=\/|$)/;function te(e){for(var t=[];e.length;)if(e.match(Z))e=e.replace(Z,"");else if(e.match(Y))e=e.replace(Y,"/");else if(e.match(X))e=e.replace(X,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(ee);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?l:c,n=[],s=q[(t.scheme||e.scheme||"").toLowerCase()];if(s&&s.serialize&&s.serialize(e,t),e.host&&!r.IPV6ADDRESS.test(e.host)&&(t.domainHost||s&&s.domainHost))try{e.host=t.iri?L.toUnicode(e.host):L.toASCII(e.host.replace(r.PCT_ENCODED,z).toLowerCase())}catch(a){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+a}V(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var o=Q(e,t);if(void 0!==o&&("suffix"!==t.reference&&n.push("//"),n.push(o),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var i=e.path;!t.absolutePath&&(!s||!s.absolutePath)&&(i=te(i)),void 0===o&&(i=i.replace(/^\/\//,"/%2F")),n.push(i)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function ne(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={};return arguments[3]||(e=J(re(e,r),r),t=J(re(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(n.scheme=t.scheme,n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=te(t.path||""),n.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=te(t.path||""),n.query=t.query):(t.path?("/"===t.path.charAt(0)?n.path=te(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?n.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:n.path=t.path:n.path="/"+t.path,n.path=te(n.path)),n.query=t.query):(n.path=e.path,void 0!==t.query?n.query=t.query:n.query=e.query),n.userinfo=e.userinfo,n.host=e.host,n.port=e.port),n.scheme=e.scheme),n.fragment=t.fragment,n}function se(e,t,r){var n=i({scheme:"null"},r);return re(ne(J(e,n),J(t,n),n,!0),n)}function oe(e,t){return"string"==typeof e?e=re(J(e,t),t):"object"===n(e)&&(e=J(re(e,t),t)),e}function ie(e,t,r){return"string"==typeof e?e=re(J(e,r),r):"object"===n(e)&&(e=re(e,r)),"string"==typeof t?t=re(J(t,r),r):"object"===n(t)&&(t=re(t,r)),e===t}function ae(e,t){return e&&e.toString().replace(t&&t.iri?l.ESCAPE:c.ESCAPE,U)}function ce(e,t){return e&&e.toString().replace(t&&t.iri?l.PCT_ENCODED:c.PCT_ENCODED,z)}var le={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return(e.port===(r?443:80)||""===e.port)&&(e.port=void 0),e.path||(e.path="/"),e}},pe={scheme:"https",domainHost:le.domainHost,parse:le.parse,serialize:le.serialize};function de(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var ue={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=de(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if((e.port===(de(e)?443:80)||""===e.port)&&(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),n=p(r,2),s=n[0],o=n[1];e.path=s&&"/"!==s?s:void 0,e.query=o,e.resourceName=void 0}return e.fragment=void 0,e}},he={scheme:"wss",domainHost:ue.domainHost,parse:ue.parse,serialize:ue.serialize},fe={},me="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",ye="[0-9A-Fa-f]",ge=r(r("%[EFef]"+ye+"%"+ye+ye+"%"+ye+ye)+"|"+r("%[89A-Fa-f]"+ye+"%"+ye+ye)+"|"+r("%"+ye+ye)),ve="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",we=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),$e="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",_e=new RegExp(me,"g"),be=new RegExp(ge,"g"),Ee=new RegExp(t("[^]",ve,"[\\.]",'[\\"]',we),"g"),Pe=new RegExp(t("[^]",me,$e),"g"),Se=Pe;function ke(e){var t=z(e);return t.match(_e)?t:e}var Te={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var s=!1,o={},i=r.query.split("&"),a=0,c=i.length;a<c;++a){var l=i[a].split("=");switch(l[0]){case"to":for(var p=l[1].split(","),d=0,u=p.length;d<u;++d)n.push(p[d]);break;case"subject":r.subject=ce(l[1],t);break;case"body":r.body=ce(l[1],t);break;default:s=!0,o[ce(l[0],t)]=ce(l[1],t)}}s&&(r.headers=o)}r.query=void 0;for(var h=0,f=n.length;h<f;++h){var m=n[h].split("@");if(m[0]=ce(m[0]),t.unicodeSupport)m[1]=ce(m[1],t).toLowerCase();else try{m[1]=L.toASCII(ce(m[1],t).toLowerCase())}catch(y){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+y}n[h]=m.join("@")}return r},serialize:function(e,t){var r=e,n=o(e.to);if(n){for(var i=0,a=n.length;i<a;++i){var c=String(n[i]),l=c.lastIndexOf("@"),p=c.slice(0,l).replace(be,ke).replace(be,s).replace(Ee,U),d=c.slice(l+1);try{d=t.iri?L.toUnicode(d):L.toASCII(ce(d,t).toLowerCase())}catch(m){r.error=r.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+m}n[i]=p+"@"+d}r.path=n.join(",")}var u=e.headers=e.headers||{};e.subject&&(u.subject=e.subject),e.body&&(u.body=e.body);var h=[];for(var f in u)u[f]!==fe[f]&&h.push(f.replace(be,ke).replace(be,s).replace(Pe,U)+"="+u[f].replace(be,ke).replace(be,s).replace(Se,U));return h.length&&(r.query=h.join("&")),r}},Ce=/^([^\:]+)\:(.*)/,xe={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(Ce),n=e;if(r){var s=t.scheme||n.scheme||"urn",o=r[1].toLowerCase(),i=r[2],a=s+":"+(t.nid||o),c=q[a];n.nid=o,n.nss=i,n.path=void 0,c&&(n=c.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,s=r+":"+(t.nid||n),o=q[s];o&&(e=o.serialize(e,t));var i=e,a=e.nss;return i.path=(n||t.nid)+":"+a,i}},Re=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Ne={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,!t.tolerant&&(!r.uuid||!r.uuid.match(Re))&&(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};q[le.scheme]=le,q[pe.scheme]=pe,q[ue.scheme]=ue,q[he.scheme]=he,q[Te.scheme]=Te,q[xe.scheme]=xe,q[Ne.scheme]=Ne,e.SCHEMES=q,e.pctEncChar=U,e.pctDecChars=z,e.parse=J,e.removeDotSegments=te,e.serialize=re,e.resolveComponents=ne,e.resolve=se,e.normalize=oe,e.equal=ie,e.escapeComponent=ae,e.unescapeComponent=ce,Object.defineProperty(e,"__esModule",{value:!0})})(Dr.exports);var Mr=Dr.exports;Object.defineProperty(Ar,"__esModule",{value:!0});const Fr=Mr;Fr.code='require("ajv/dist/runtime/uri").default',Ar.default=Fr,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=Te;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=Re;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=hr,s=mr,o=Ve,i=vr,a=Re,c=vt,l=ze,p=Oe,d=Ir,u=Ar,h=(e,t)=>new RegExp(e,t);h.code="new RegExp";const f=["removeAdditional","useDefaults","coerceTypes"],m=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),y={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},g={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function v(e){var t,r,n,s,o,i,a,c,l,p,d,f,m,y,g,v,w,$,_,b,E,P,S,k,T;const C=e.strict,x=null===(t=e.code)||void 0===t?void 0:t.optimize,R=!0===x||void 0===x?1:x||0,N=null!==(n=null===(r=e.code)||void 0===r?void 0:r.regExp)&&void 0!==n?n:h,j=null!==(s=e.uriResolver)&&void 0!==s?s:u.default;return{strictSchema:null===(i=null!==(o=e.strictSchema)&&void 0!==o?o:C)||void 0===i||i,strictNumbers:null===(c=null!==(a=e.strictNumbers)&&void 0!==a?a:C)||void 0===c||c,strictTypes:null!==(p=null!==(l=e.strictTypes)&&void 0!==l?l:C)&&void 0!==p?p:"log",strictTuples:null!==(f=null!==(d=e.strictTuples)&&void 0!==d?d:C)&&void 0!==f?f:"log",strictRequired:null!==(y=null!==(m=e.strictRequired)&&void 0!==m?m:C)&&void 0!==y&&y,code:e.code?{...e.code,optimize:R,regExp:N}:{optimize:R,regExp:N},loopRequired:null!==(g=e.loopRequired)&&void 0!==g?g:200,loopEnum:null!==(v=e.loopEnum)&&void 0!==v?v:200,meta:null===(w=e.meta)||void 0===w||w,messages:null===($=e.messages)||void 0===$||$,inlineRefs:null===(_=e.inlineRefs)||void 0===_||_,schemaId:null!==(b=e.schemaId)&&void 0!==b?b:"$id",addUsedSchema:null===(E=e.addUsedSchema)||void 0===E||E,validateSchema:null===(P=e.validateSchema)||void 0===P||P,validateFormats:null===(S=e.validateFormats)||void 0===S||S,unicodeRegExp:null===(k=e.unicodeRegExp)||void 0===k||k,int32range:null===(T=e.int32range)||void 0===T||T,uriResolver:j}}class w{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...v(e)};const{es5:t,lines:r}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:m,es5:t,lines:r}),this.logger=function(e){if(!1===e)return k;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const n=e.validateFormats;e.validateFormats=!1,this.RULES=(0,o.getRules)(),$.call(this,y,e,"NOT SUPPORTED"),$.call(this,g,e,"DEPRECATED","warn"),this._metaOpts=S.call(this),e.formats&&E.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&P.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),b.call(this),e.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:r}=this.opts;let n=d;"id"===r&&(n={...d},n.id=n.$id,delete n.$id),t&&e&&this.addMetaSchema(n,n[r],!1)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);const n=r(t);return"$async"in r||(this.errors=r.errors),n}compile(e,t){const r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:r}=this.opts;return n.call(this,e,t);async function n(e,t){await o.call(this,e.$schema);const r=this._addSchema(e,t);return r.validate||i.call(this,r)}async function o(e){e&&!this.getSchema(e)&&await n.call(this,{$ref:e},!0)}async function i(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof s.default))throw t;return a.call(this,t),await c.call(this,t.missingSchema),i.call(this,e)}}function a({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function c(e){const r=await l.call(this,e);this.refs[e]||await o.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function l(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,n=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,r,n);return this}let s;if("object"==typeof e){const{schemaId:t}=this.opts;if(s=e[t],void 0!==s&&"string"!=typeof s)throw new Error(`schema ${t} must be string`)}return t=(0,c.normalizeId)(t||s),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,t,n,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const n=this.validate(r,e);if(!n&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return n}getSchema(e){let t;for(;"string"==typeof(t=_.call(this,e));)e=t;if(void 0===t){const{schemaId:r}=this.opts,n=new i.SchemaEnv({schema:{},schemaId:r});if(t=i.resolveSchema.call(this,n,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=_.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let r=e[this.opts.schemaId];return r&&(r=(0,c.normalizeId)(r),delete this.schemas[r],delete this.refs[r]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(C.call(this,r,t),!t)return(0,p.eachItem)(r,(e=>x.call(this,e))),this;N.call(this,t);const n={...t,type:(0,l.getJSONTypes)(t.type),schemaType:(0,l.getJSONTypes)(t.schemaType)};return(0,p.eachItem)(r,0===n.type.length?e=>x.call(this,e,n):e=>n.type.forEach((t=>x.call(this,e,n,t)))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const r of t.rules){const t=r.rules.findIndex((t=>t.keyword===e));t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map((e=>`${r}${e.instancePath} ${e.message}`)).reduce(((e,r)=>e+t+r)):"No errors"}$dataMetaSchema(e,t){const r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const n of t){const t=n.split("/").slice(1);let s=e;for(const e of t)s=s[e];for(const e in r){const t=r[e];if("object"!=typeof t)continue;const{$data:n}=t.definition,o=s[e];n&&o&&(s[e]=O(o))}}return e}_removeAllSchemas(e,t){for(const r in e){const n=e[r];(!t||t.test(r))&&("string"==typeof n?delete e[r]:n&&!n.meta&&(this._cache.delete(n.schema),delete e[r]))}}_addSchema(e,t,r,n=this.opts.validateSchema,s=this.opts.addUsedSchema){let o;const{schemaId:a}=this.opts;if("object"==typeof e)o=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let l=this._cache.get(e);if(void 0!==l)return l;r=(0,c.normalizeId)(o||r);const p=c.getSchemaRefs.call(this,e,r);return l=new i.SchemaEnv({schema:e,schemaId:a,meta:t,baseId:r,localRefs:p}),this._cache.set(l.schema,l),s&&!r.startsWith("#")&&(r&&this._checkUnique(r),this.refs[r]=l),n&&this.validateSchema(e,!0),l}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):i.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{i.compileSchema.call(this,e)}finally{this.opts=t}}}function $(e,t,r,n="error"){for(const s in e){const o=s;o in t&&this.logger[n](`${r}: option ${s}. ${e[o]}`)}}function _(e){return e=(0,c.normalizeId)(e),this.schemas[e]||this.refs[e]}function b(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function E(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function P(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}function S(){const e={...this.opts};for(const t of f)delete e[t];return e}e.default=w,w.ValidationError=n.default,w.MissingRefError=s.default;const k={log(){},warn(){},error(){}};const T=/^[a-z_$][a-z0-9_$:-]*$/i;function C(e,t){const{RULES:r}=this;if((0,p.eachItem)(e,(e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!T.test(e))throw new Error(`Keyword ${e} has invalid name`)})),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function x(e,t,r){var n;const s=null==t?void 0:t.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:o}=this;let i=s?o.post:o.rules.find((({type:e})=>e===r));if(i||(i={type:r,rules:[]},o.rules.push(i)),o.keywords[e]=!0,!t)return;const a={keyword:e,definition:{...t,type:(0,l.getJSONTypes)(t.type),schemaType:(0,l.getJSONTypes)(t.schemaType)}};t.before?R.call(this,i,a,t.before):i.rules.push(a),o.all[e]=a,null===(n=t.implements)||void 0===n||n.forEach((e=>this.addKeyword(e)))}function R(e,t,r){const n=e.rules.findIndex((e=>e.keyword===r));n>=0?e.rules.splice(n,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function N(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=O(t)),e.validateSchema=this.compile(t,!0))}const j={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function O(e){return{anyOf:[e,j]}}}(ke);var Lr={},qr={},Ur={};Object.defineProperty(Ur,"__esModule",{value:!0});const zr={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Ur.default=zr;var Vr={};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.callRef=Vr.getValidate=void 0;const Wr=mr,Br=Xe,Hr=Re,Gr=Ie,Kr=vr,Jr=Oe,Qr={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:n}=e,{baseId:s,schemaEnv:o,validateName:i,opts:a,self:c}=n,{root:l}=o;if(("#"===r||"#/"===r)&&s===l.baseId)return function(){if(o===l)return Yr(e,i,o,o.$async);const r=t.scopeValue("root",{ref:l});return Yr(e,Hr._`${r}.validate`,l,l.$async)}();const p=Kr.resolveRef.call(c,l,s,r);if(void 0===p)throw new Wr.default(n.opts.uriResolver,s,r);return p instanceof Kr.SchemaEnv?function(t){const r=Zr(e,t);Yr(e,r,t,t.$async)}(p):function(n){const s=t.scopeValue("schema",!0===a.code.source?{ref:n,code:(0,Hr.stringify)(n)}:{ref:n}),o=t.name("valid"),i=e.subschema({schema:n,dataTypes:[],schemaPath:Hr.nil,topSchemaRef:s,errSchemaPath:r},o);e.mergeEvaluated(i),e.ok(o)}(p)}};function Zr(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):Hr._`${r.scopeValue("wrapper",{ref:t})}.validate`}function Yr(e,t,r,n){const{gen:s,it:o}=e,{allErrors:i,schemaEnv:a,opts:c}=o,l=c.passContext?Gr.default.this:Hr.nil;function p(e){const t=Hr._`${e}.errors`;s.assign(Gr.default.vErrors,Hr._`${Gr.default.vErrors} === null ? ${t} : ${Gr.default.vErrors}.concat(${t})`),s.assign(Gr.default.errors,Hr._`${Gr.default.vErrors}.length`)}function d(e){var t;if(!o.opts.unevaluated)return;const n=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==o.props)if(n&&!n.dynamicProps)void 0!==n.props&&(o.props=Jr.mergeEvaluated.props(s,n.props,o.props));else{const t=s.var("props",Hr._`${e}.evaluated.props`);o.props=Jr.mergeEvaluated.props(s,t,o.props,Hr.Name)}if(!0!==o.items)if(n&&!n.dynamicItems)void 0!==n.items&&(o.items=Jr.mergeEvaluated.items(s,n.items,o.items));else{const t=s.var("items",Hr._`${e}.evaluated.items`);o.items=Jr.mergeEvaluated.items(s,t,o.items,Hr.Name)}}n?function(){if(!a.$async)throw new Error("async schema referenced by sync schema");const r=s.let("valid");s.try((()=>{s.code(Hr._`await ${(0,Br.callValidateCode)(e,t,l)}`),d(t),i||s.assign(r,!0)}),(e=>{s.if(Hr._`!(${e} instanceof ${o.ValidationError})`,(()=>s.throw(e))),p(e),i||s.assign(r,!1)})),e.ok(r)}():e.result((0,Br.callValidateCode)(e,t,l),(()=>d(t)),(()=>p(t)))}Vr.getValidate=Zr,Vr.callRef=Yr,Vr.default=Qr,Object.defineProperty(qr,"__esModule",{value:!0});const Xr=Vr,en=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Ur.default,Xr.default];qr.default=en;var tn={},rn={};Object.defineProperty(rn,"__esModule",{value:!0});const nn=Re,sn=nn.operators,on={maximum:{okStr:"<=",ok:sn.LTE,fail:sn.GT},minimum:{okStr:">=",ok:sn.GTE,fail:sn.LT},exclusiveMaximum:{okStr:"<",ok:sn.LT,fail:sn.GTE},exclusiveMinimum:{okStr:">",ok:sn.GT,fail:sn.LTE}},an={message:({keyword:e,schemaCode:t})=>nn.str`must be ${on[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>nn._`{comparison: ${on[e].okStr}, limit: ${t}}`},cn={keyword:Object.keys(on),type:"number",schemaType:"number",$data:!0,error:an,code(e){const{keyword:t,data:r,schemaCode:n}=e;e.fail$data(nn._`${r} ${on[t].fail} ${n} || isNaN(${r})`)}};rn.default=cn;var ln={};Object.defineProperty(ln,"__esModule",{value:!0});const pn=Re,dn={message:({schemaCode:e})=>pn.str`must be multiple of ${e}`,params:({schemaCode:e})=>pn._`{multipleOf: ${e}}`},un={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:dn,code(e){const{gen:t,data:r,schemaCode:n,it:s}=e,o=s.opts.multipleOfPrecision,i=t.let("res"),a=o?pn._`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:pn._`${i} !== parseInt(${i})`;e.fail$data(pn._`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};ln.default=un;var hn={},fn={};function mn(e){const t=e.length;let r,n=0,s=0;for(;s<t;)n++,r=e.charCodeAt(s++),r>=55296&&r<=56319&&s<t&&(r=e.charCodeAt(s),56320==(64512&r)&&s++);return n}Object.defineProperty(fn,"__esModule",{value:!0}),fn.default=mn,mn.code='require("ajv/dist/runtime/ucs2length").default',Object.defineProperty(hn,"__esModule",{value:!0});const yn=Re,gn=Oe,vn=fn,wn={message:({keyword:e,schemaCode:t})=>yn.str`must NOT have ${"maxLength"===e?"more":"fewer"} than ${t} characters`,params:({schemaCode:e})=>yn._`{limit: ${e}}`},$n={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:wn,code(e){const{keyword:t,data:r,schemaCode:n,it:s}=e,o="maxLength"===t?yn.operators.GT:yn.operators.LT,i=!1===s.opts.unicode?yn._`${r}.length`:yn._`${(0,gn.useFunc)(e.gen,vn.default)}(${r})`;e.fail$data(yn._`${i} ${o} ${n}`)}};hn.default=$n;var _n={};Object.defineProperty(_n,"__esModule",{value:!0});const bn=Xe,En=Re,Pn={message:({schemaCode:e})=>En.str`must match pattern "${e}"`,params:({schemaCode:e})=>En._`{pattern: ${e}}`},Sn={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Pn,code(e){const{data:t,$data:r,schema:n,schemaCode:s,it:o}=e,i=o.opts.unicodeRegExp?"u":"",a=r?En._`(new RegExp(${s}, ${i}))`:(0,bn.usePattern)(e,n);e.fail$data(En._`!${a}.test(${t})`)}};_n.default=Sn;var kn={};Object.defineProperty(kn,"__esModule",{value:!0});const Tn=Re,Cn={message:({keyword:e,schemaCode:t})=>Tn.str`must NOT have ${"maxProperties"===e?"more":"fewer"} than ${t} properties`,params:({schemaCode:e})=>Tn._`{limit: ${e}}`},xn={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Cn,code(e){const{keyword:t,data:r,schemaCode:n}=e,s="maxProperties"===t?Tn.operators.GT:Tn.operators.LT;e.fail$data(Tn._`Object.keys(${r}).length ${s} ${n}`)}};kn.default=xn;var Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});const Nn=Xe,jn=Re,On=Oe,In={message:({params:{missingProperty:e}})=>jn.str`must have required property '${e}'`,params:({params:{missingProperty:e}})=>jn._`{missingProperty: ${e}}`},An={keyword:"required",type:"object",schemaType:"array",$data:!0,error:In,code(e){const{gen:t,schema:r,schemaCode:n,data:s,$data:o,it:i}=e,{opts:a}=i;if(!o&&0===r.length)return;const c=r.length>=a.loopRequired;if(i.allErrors?function(){if(c||o)e.block$data(jn.nil,l);else for(const t of r)(0,Nn.checkReportMissingProp)(e,t)}():function(){const i=t.let("missing");if(c||o){const r=t.let("valid",!0);e.block$data(r,(()=>function(r,o){e.setParams({missingProperty:r}),t.forOf(r,n,(()=>{t.assign(o,(0,Nn.propertyInData)(t,s,r,a.ownProperties)),t.if((0,jn.not)(o),(()=>{e.error(),t.break()}))}),jn.nil)}(i,r))),e.ok(r)}else t.if((0,Nn.checkMissingProp)(e,r,i)),(0,Nn.reportMissingProp)(e,i),t.else()}(),a.strictRequired){const t=e.parentSchema.properties,{definedProperties:n}=e.it;for(const e of r)if(void 0===(null==t?void 0:t[e])&&!n.has(e)){const t=i.schemaEnv.baseId+i.errSchemaPath;(0,On.checkStrictMode)(i,`required property "${e}" is not defined at "${t}" (strictRequired)`,i.opts.strictRequired)}}function l(){t.forOf("prop",n,(r=>{e.setParams({missingProperty:r}),t.if((0,Nn.noPropertyInData)(t,s,r,a.ownProperties),(()=>e.error()))}))}}};Rn.default=An;var Dn={};Object.defineProperty(Dn,"__esModule",{value:!0});const Mn=Re,Fn={message:({keyword:e,schemaCode:t})=>Mn.str`must NOT have ${"maxItems"===e?"more":"fewer"} than ${t} items`,params:({schemaCode:e})=>Mn._`{limit: ${e}}`},Ln={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Fn,code(e){const{keyword:t,data:r,schemaCode:n}=e,s="maxItems"===t?Mn.operators.GT:Mn.operators.LT;e.fail$data(Mn._`${r}.length ${s} ${n}`)}};Dn.default=Ln;var qn={},Un={};Object.defineProperty(Un,"__esModule",{value:!0});const zn=wt;zn.code='require("ajv/dist/runtime/equal").default',Un.default=zn,Object.defineProperty(qn,"__esModule",{value:!0});const Vn=ze,Wn=Re,Bn=Oe,Hn=Un,Gn={message:({params:{i:e,j:t}})=>Wn.str`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>Wn._`{i: ${e}, j: ${t}}`},Kn={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Gn,code(e){const{gen:t,data:r,$data:n,schema:s,parentSchema:o,schemaCode:i,it:a}=e;if(!n&&!s)return;const c=t.let("valid"),l=o.items?(0,Vn.getSchemaTypes)(o.items):[];function p(n,s){const o=t.name("item"),i=(0,Vn.checkDataTypes)(l,o,a.opts.strictNumbers,Vn.DataType.Wrong),p=t.const("indices",Wn._`{}`);t.for(Wn._`;${n}--;`,(()=>{t.let(o,Wn._`${r}[${n}]`),t.if(i,Wn._`continue`),l.length>1&&t.if(Wn._`typeof ${o} == "string"`,Wn._`${o} += "_"`),t.if(Wn._`typeof ${p}[${o}] == "number"`,(()=>{t.assign(s,Wn._`${p}[${o}]`),e.error(),t.assign(c,!1).break()})).code(Wn._`${p}[${o}] = ${n}`)}))}function d(n,s){const o=(0,Bn.useFunc)(t,Hn.default),i=t.name("outer");t.label(i).for(Wn._`;${n}--;`,(()=>t.for(Wn._`${s} = ${n}; ${s}--;`,(()=>t.if(Wn._`${o}(${r}[${n}], ${r}[${s}])`,(()=>{e.error(),t.assign(c,!1).break(i)}))))))}e.block$data(c,(function(){const n=t.let("i",Wn._`${r}.length`),s=t.let("j");e.setParams({i:n,j:s}),t.assign(c,!0),t.if(Wn._`${n} > 1`,(()=>(l.length>0&&!l.some((e=>"object"===e||"array"===e))?p:d)(n,s)))}),Wn._`${i} === false`),e.ok(c)}};qn.default=Kn;var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});const Qn=Re,Zn=Oe,Yn=Un,Xn={message:"must be equal to constant",params:({schemaCode:e})=>Qn._`{allowedValue: ${e}}`},es={keyword:"const",$data:!0,error:Xn,code(e){const{gen:t,data:r,$data:n,schemaCode:s,schema:o}=e;n||o&&"object"==typeof o?e.fail$data(Qn._`!${(0,Zn.useFunc)(t,Yn.default)}(${r}, ${s})`):e.fail(Qn._`${o} !== ${r}`)}};Jn.default=es;var ts={};Object.defineProperty(ts,"__esModule",{value:!0});const rs=Re,ns=Oe,ss=Un,os={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>rs._`{allowedValues: ${e}}`},is={keyword:"enum",schemaType:"array",$data:!0,error:os,code(e){const{gen:t,data:r,$data:n,schema:s,schemaCode:o,it:i}=e;if(!n&&0===s.length)throw new Error("enum must have non-empty array");const a=s.length>=i.opts.loopEnum;let c;const l=()=>c??(c=(0,ns.useFunc)(t,ss.default));let p;if(a||n)p=t.let("valid"),e.block$data(p,(function(){t.assign(p,!1),t.forOf("v",o,(e=>t.if(rs._`${l()}(${r}, ${e})`,(()=>t.assign(p,!0).break()))))}));else{if(!Array.isArray(s))throw new Error("ajv implementation error");const e=t.const("vSchema",o);p=(0,rs.or)(...s.map(((t,n)=>function(e,t){const n=s[t];return"object"==typeof n&&null!==n?rs._`${l()}(${r}, ${e}[${t}])`:rs._`${r} === ${n}`}(e,n))))}e.pass(p)}};ts.default=is,Object.defineProperty(tn,"__esModule",{value:!0});const as=ln,cs=hn,ls=_n,ps=kn,ds=Rn,us=Dn,hs=qn,fs=Jn,ms=ts,ys=[rn.default,as.default,cs.default,ls.default,ps.default,ds.default,us.default,hs.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},fs.default,ms.default];tn.default=ys;var gs={},vs={};Object.defineProperty(vs,"__esModule",{value:!0}),vs.validateAdditionalItems=void 0;const ws=Re,$s=Oe,_s={message:({params:{len:e}})=>ws.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>ws._`{limit: ${e}}`},bs={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:_s,code(e){const{parentSchema:t,it:r}=e,{items:n}=t;Array.isArray(n)?Es(e,n):(0,$s.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas')}};function Es(e,t){const{gen:r,schema:n,data:s,keyword:o,it:i}=e;i.items=!0;const a=r.const("len",ws._`${s}.length`);if(!1===n)e.setParams({len:t.length}),e.pass(ws._`${a} <= ${t.length}`);else if("object"==typeof n&&!(0,$s.alwaysValidSchema)(i,n)){const n=r.var("valid",ws._`${a} <= ${t.length}`);r.if((0,ws.not)(n),(()=>function(n){r.forRange("i",t.length,a,(t=>{e.subschema({keyword:o,dataProp:t,dataPropType:$s.Type.Num},n),i.allErrors||r.if((0,ws.not)(n),(()=>r.break()))}))}(n))),e.ok(n)}}vs.validateAdditionalItems=Es,vs.default=bs;var Ps={},Ss={};Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.validateTuple=void 0;const ks=Re,Ts=Oe,Cs=Xe,xs={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return Rs(e,"additionalItems",t);r.items=!0,!(0,Ts.alwaysValidSchema)(r,t)&&e.ok((0,Cs.validateArray)(e))}};function Rs(e,t,r=e.schema){const{gen:n,parentSchema:s,data:o,keyword:i,it:a}=e;(function(e){const{opts:n,errSchemaPath:s}=a,o=r.length,c=o===e.minItems&&(o===e.maxItems||!1===e[t]);if(n.strictTuples&&!c){const e=`"${i}" is ${o}-tuple, but minItems or maxItems/${t} are not specified or different at path "${s}"`;(0,Ts.checkStrictMode)(a,e,n.strictTuples)}})(s),a.opts.unevaluated&&r.length&&!0!==a.items&&(a.items=Ts.mergeEvaluated.items(n,r.length,a.items));const c=n.name("valid"),l=n.const("len",ks._`${o}.length`);r.forEach(((t,r)=>{(0,Ts.alwaysValidSchema)(a,t)||(n.if(ks._`${l} > ${r}`,(()=>e.subschema({keyword:i,schemaProp:r,dataProp:r},c))),e.ok(c))}))}Ss.validateTuple=Rs,Ss.default=xs,Object.defineProperty(Ps,"__esModule",{value:!0});const Ns=Ss,js={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,Ns.validateTuple)(e,"items")};Ps.default=js;var Os={};Object.defineProperty(Os,"__esModule",{value:!0});const Is=Re,As=Oe,Ds=Xe,Ms=vs,Fs={message:({params:{len:e}})=>Is.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>Is._`{limit: ${e}}`},Ls={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Fs,code(e){const{schema:t,parentSchema:r,it:n}=e,{prefixItems:s}=r;n.items=!0,!(0,As.alwaysValidSchema)(n,t)&&(s?(0,Ms.validateAdditionalItems)(e,s):e.ok((0,Ds.validateArray)(e)))}};Os.default=Ls;var qs={};Object.defineProperty(qs,"__esModule",{value:!0});const Us=Re,zs=Oe,Vs={message:({params:{min:e,max:t}})=>void 0===t?Us.str`must contain at least ${e} valid item(s)`:Us.str`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?Us._`{minContains: ${e}}`:Us._`{minContains: ${e}, maxContains: ${t}}`},Ws={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:Vs,code(e){const{gen:t,schema:r,parentSchema:n,data:s,it:o}=e;let i,a;const{minContains:c,maxContains:l}=n;o.opts.next?(i=void 0===c?1:c,a=l):i=1;const p=t.const("len",Us._`${s}.length`);if(e.setParams({min:i,max:a}),void 0===a&&0===i)return void(0,zs.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==a&&i>a)return(0,zs.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,zs.alwaysValidSchema)(o,r)){let t=Us._`${p} >= ${i}`;return void 0!==a&&(t=Us._`${t} && ${p} <= ${a}`),void e.pass(t)}o.items=!0;const d=t.name("valid");function u(){const e=t.name("_valid"),r=t.let("count",0);h(e,(()=>t.if(e,(()=>function(e){t.code(Us._`${e}++`),void 0===a?t.if(Us._`${e} >= ${i}`,(()=>t.assign(d,!0).break())):(t.if(Us._`${e} > ${a}`,(()=>t.assign(d,!1).break())),1===i?t.assign(d,!0):t.if(Us._`${e} >= ${i}`,(()=>t.assign(d,!0))))}(r)))))}function h(r,n){t.forRange("i",0,p,(t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:zs.Type.Num,compositeRule:!0},r),n()}))}void 0===a&&1===i?h(d,(()=>t.if(d,(()=>t.break())))):0===i?(t.let(d,!0),void 0!==a&&t.if(Us._`${s}.length > 0`,u)):(t.let(d,!1),u()),e.result(d,(()=>e.reset()))}};qs.default=Ws;var Bs={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=Re,r=Oe,n=Xe;e.error={message:({params:{property:e,depsCount:r,deps:n}})=>t.str`must have ${1===r?"property":"properties"} ${n} when property ${e} is present`,params:({params:{property:e,depsCount:r,deps:n,missingProperty:s}})=>t._`{property: ${e},
    missingProperty: ${s},
    depsCount: ${r},
    deps: ${n}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(e){const[t,r]=function({schema:e}){const t={},r={};for(const n in e){if("__proto__"===n)continue;(Array.isArray(e[n])?t:r)[n]=e[n]}return[t,r]}(e);o(e,t),i(e,r)}};function o(e,r=e.schema){const{gen:s,data:o,it:i}=e;if(0===Object.keys(r).length)return;const a=s.let("missing");for(const c in r){const l=r[c];if(0===l.length)continue;const p=(0,n.propertyInData)(s,o,c,i.opts.ownProperties);e.setParams({property:c,depsCount:l.length,deps:l.join(", ")}),i.allErrors?s.if(p,(()=>{for(const t of l)(0,n.checkReportMissingProp)(e,t)})):(s.if(t._`${p} && (${(0,n.checkMissingProp)(e,l,a)})`),(0,n.reportMissingProp)(e,a),s.else())}}function i(e,t=e.schema){const{gen:s,data:o,keyword:i,it:a}=e,c=s.name("valid");for(const l in t)(0,r.alwaysValidSchema)(a,t[l])||(s.if((0,n.propertyInData)(s,o,l,a.opts.ownProperties),(()=>{const t=e.subschema({keyword:i,schemaProp:l},c);e.mergeValidEvaluated(t,c)}),(()=>s.var(c,!0))),e.ok(c))}e.validatePropertyDeps=o,e.validateSchemaDeps=i,e.default=s}(Bs);var Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});const Gs=Re,Ks=Oe,Js={message:"property name must be valid",params:({params:e})=>Gs._`{propertyName: ${e.propertyName}}`},Qs={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:Js,code(e){const{gen:t,schema:r,data:n,it:s}=e;if((0,Ks.alwaysValidSchema)(s,r))return;const o=t.name("valid");t.forIn("key",n,(r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},o),t.if((0,Gs.not)(o),(()=>{e.error(!0),s.allErrors||t.break()}))})),e.ok(o)}};Hs.default=Qs;var Zs={};Object.defineProperty(Zs,"__esModule",{value:!0});const Ys=Xe,Xs=Re,eo=Ie,to=Oe,ro={message:"must NOT have additional properties",params:({params:e})=>Xs._`{additionalProperty: ${e.additionalProperty}}`},no={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:ro,code(e){const{gen:t,schema:r,parentSchema:n,data:s,errsCount:o,it:i}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:a,opts:c}=i;if(i.props=!0,"all"!==c.removeAdditional&&(0,to.alwaysValidSchema)(i,r))return;const l=(0,Ys.allSchemaProperties)(n.properties),p=(0,Ys.allSchemaProperties)(n.patternProperties);function d(e){t.code(Xs._`delete ${s}[${e}]`)}function u(n){if("all"===c.removeAdditional||c.removeAdditional&&!1===r)d(n);else{if(!1===r)return e.setParams({additionalProperty:n}),e.error(),void(a||t.break());if("object"==typeof r&&!(0,to.alwaysValidSchema)(i,r)){const r=t.name("valid");"failing"===c.removeAdditional?(h(n,r,!1),t.if((0,Xs.not)(r),(()=>{e.reset(),d(n)}))):(h(n,r),a||t.if((0,Xs.not)(r),(()=>t.break())))}}}function h(t,r,n){const s={keyword:"additionalProperties",dataProp:t,dataPropType:to.Type.Str};!1===n&&Object.assign(s,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(s,r)}t.forIn("key",s,(r=>{l.length||p.length?t.if(function(r){let s;if(l.length>8){const e=(0,to.schemaRefOrVal)(i,n.properties,"properties");s=(0,Ys.isOwnProperty)(t,e,r)}else s=l.length?(0,Xs.or)(...l.map((e=>Xs._`${r} === ${e}`))):Xs.nil;return p.length&&(s=(0,Xs.or)(s,...p.map((t=>Xs._`${(0,Ys.usePattern)(e,t)}.test(${r})`)))),(0,Xs.not)(s)}(r),(()=>u(r))):u(r)})),e.ok(Xs._`${o} === ${eo.default.errors}`)}};Zs.default=no;var so={};Object.defineProperty(so,"__esModule",{value:!0});const oo=Te,io=Xe,ao=Oe,co=Zs,lo={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:n,data:s,it:o}=e;"all"===o.opts.removeAdditional&&void 0===n.additionalProperties&&co.default.code(new oo.KeywordCxt(o,co.default,"additionalProperties"));const i=(0,io.allSchemaProperties)(r);for(const d of i)o.definedProperties.add(d);o.opts.unevaluated&&i.length&&!0!==o.props&&(o.props=ao.mergeEvaluated.props(t,(0,ao.toHash)(i),o.props));const a=i.filter((e=>!(0,ao.alwaysValidSchema)(o,r[e])));if(0===a.length)return;const c=t.name("valid");for(const d of a)l(d)?p(d):(t.if((0,io.propertyInData)(t,s,d,o.opts.ownProperties)),p(d),o.allErrors||t.else().var(c,!0),t.endIf()),e.it.definedProperties.add(d),e.ok(c);function l(e){return o.opts.useDefaults&&!o.compositeRule&&void 0!==r[e].default}function p(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},c)}}};so.default=lo;var po={};Object.defineProperty(po,"__esModule",{value:!0});const uo=Xe,ho=Re,fo=Oe,mo=Oe,yo={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:n,parentSchema:s,it:o}=e,{opts:i}=o,a=(0,uo.allSchemaProperties)(r),c=a.filter((e=>(0,fo.alwaysValidSchema)(o,r[e])));if(0===a.length||c.length===a.length&&(!o.opts.unevaluated||!0===o.props))return;const l=i.strictSchema&&!i.allowMatchingProperties&&s.properties,p=t.name("valid");!0!==o.props&&!(o.props instanceof ho.Name)&&(o.props=(0,mo.evaluatedPropsToName)(t,o.props));const{props:d}=o;function u(e){for(const t in l)new RegExp(e).test(t)&&(0,fo.checkStrictMode)(o,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function h(r){t.forIn("key",n,(n=>{t.if(ho._`${(0,uo.usePattern)(e,r)}.test(${n})`,(()=>{const s=c.includes(r);s||e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:n,dataPropType:mo.Type.Str},p),o.opts.unevaluated&&!0!==d?t.assign(ho._`${d}[${n}]`,!0):!s&&!o.allErrors&&t.if((0,ho.not)(p),(()=>t.break()))}))}))}!function(){for(const e of a)l&&u(e),o.allErrors?h(e):(t.var(p,!0),h(e),t.if(p))}()}};po.default=yo;var go={};Object.defineProperty(go,"__esModule",{value:!0});const vo=Oe,wo={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:n}=e;if((0,vo.alwaysValidSchema)(n,r))return void e.fail();const s=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),e.failResult(s,(()=>e.reset()),(()=>e.error()))},error:{message:"must NOT be valid"}};go.default=wo;var $o={};Object.defineProperty($o,"__esModule",{value:!0});const _o={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Xe.validateUnion,error:{message:"must match a schema in anyOf"}};$o.default=_o;var bo={};Object.defineProperty(bo,"__esModule",{value:!0});const Eo=Re,Po=Oe,So={message:"must match exactly one schema in oneOf",params:({params:e})=>Eo._`{passingSchemas: ${e.passing}}`},ko={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:So,code(e){const{gen:t,schema:r,parentSchema:n,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;const o=r,i=t.let("valid",!1),a=t.let("passing",null),c=t.name("_valid");e.setParams({passing:a}),t.block((function(){o.forEach(((r,n)=>{let o;(0,Po.alwaysValidSchema)(s,r)?t.var(c,!0):o=e.subschema({keyword:"oneOf",schemaProp:n,compositeRule:!0},c),n>0&&t.if(Eo._`${c} && ${i}`).assign(i,!1).assign(a,Eo._`[${a}, ${n}]`).else(),t.if(c,(()=>{t.assign(i,!0),t.assign(a,n),o&&e.mergeEvaluated(o,Eo.Name)}))}))})),e.result(i,(()=>e.reset()),(()=>e.error(!0)))}};bo.default=ko;var To={};Object.defineProperty(To,"__esModule",{value:!0});const Co=Oe,xo={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=t.name("valid");r.forEach(((t,r)=>{if((0,Co.alwaysValidSchema)(n,t))return;const o=e.subschema({keyword:"allOf",schemaProp:r},s);e.ok(s),e.mergeEvaluated(o)}))}};To.default=xo;var Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});const No=Re,jo=Oe,Oo={message:({params:e})=>No.str`must match "${e.ifClause}" schema`,params:({params:e})=>No._`{failingKeyword: ${e.ifClause}}`},Io={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Oo,code(e){const{gen:t,parentSchema:r,it:n}=e;void 0===r.then&&void 0===r.else&&(0,jo.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const s=Ao(n,"then"),o=Ao(n,"else");if(!s&&!o)return;const i=t.let("valid",!0),a=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);e.mergeEvaluated(t)}(),e.reset(),s&&o){const r=t.let("ifClause");e.setParams({ifClause:r}),t.if(a,c("then",r),c("else",r))}else s?t.if(a,c("then")):t.if((0,No.not)(a),c("else"));function c(r,n){return()=>{const s=e.subschema({keyword:r},a);t.assign(i,a),e.mergeValidEvaluated(s,i),n?t.assign(n,No._`${r}`):e.setParams({ifClause:r})}}e.pass(i,(()=>e.error(!0)))}};function Ao(e,t){const r=e.schema[t];return void 0!==r&&!(0,jo.alwaysValidSchema)(e,r)}Ro.default=Io;var Do={};Object.defineProperty(Do,"__esModule",{value:!0});const Mo=Oe,Fo={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&(0,Mo.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};Do.default=Fo,Object.defineProperty(gs,"__esModule",{value:!0});const Lo=vs,qo=Ps,Uo=Ss,zo=Os,Vo=qs,Wo=Bs,Bo=Hs,Ho=Zs,Go=so,Ko=po,Jo=go,Qo=$o,Zo=bo,Yo=To,Xo=Ro,ei=Do;gs.default=function(e=!1){const t=[Jo.default,Qo.default,Zo.default,Yo.default,Xo.default,ei.default,Bo.default,Ho.default,Wo.default,Go.default,Ko.default];return e?t.push(qo.default,zo.default):t.push(Lo.default,Uo.default),t.push(Vo.default),t};var ti={},ri={};Object.defineProperty(ri,"__esModule",{value:!0});const ni=Re,si={message:({schemaCode:e})=>ni.str`must match format "${e}"`,params:({schemaCode:e})=>ni._`{format: ${e}}`},oi={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:si,code(e,t){const{gen:r,data:n,$data:s,schema:o,schemaCode:i,it:a}=e,{opts:c,errSchemaPath:l,schemaEnv:p,self:d}=a;c.validateFormats&&(s?function(){const s=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),o=r.const("fDef",ni._`${s}[${i}]`),a=r.let("fType"),l=r.let("format");r.if(ni._`typeof ${o} == "object" && !(${o} instanceof RegExp)`,(()=>r.assign(a,ni._`${o}.type || "string"`).assign(l,ni._`${o}.validate`)),(()=>r.assign(a,ni._`"string"`).assign(l,o))),e.fail$data((0,ni.or)(!1===c.strictSchema?ni.nil:ni._`${i} && !${l}`,function(){const e=p.$async?ni._`(${o}.async ? await ${l}(${n}) : ${l}(${n}))`:ni._`${l}(${n})`,r=ni._`(typeof ${l} == "function" ? ${e} : ${l}.test(${n}))`;return ni._`${l} && ${l} !== true && ${a} === ${t} && !${r}`}()))}():function(){const s=d.formats[o];if(!s)return void function(){if(!1===c.strictSchema)return void d.logger.warn(e());throw new Error(e());function e(){return`unknown format "${o}" ignored in schema at path "${l}"`}}();if(!0===s)return;const[i,a,u]=function(e){const t=e instanceof RegExp?(0,ni.regexpCode)(e):c.code.formats?ni._`${c.code.formats}${(0,ni.getProperty)(o)}`:void 0,n=r.scopeValue("formats",{key:o,ref:e,code:t});return"object"!=typeof e||e instanceof RegExp?["string",e,n]:[e.type||"string",e.validate,ni._`${n}.validate`]}(s);i===t&&e.pass(function(){if("object"==typeof s&&!(s instanceof RegExp)&&s.async){if(!p.$async)throw new Error("async format in sync schema");return ni._`await ${u}(${n})`}return"function"==typeof a?ni._`${u}(${n})`:ni._`${u}.test(${n})`}())}())}};ri.default=oi,Object.defineProperty(ti,"__esModule",{value:!0});const ii=[ri.default];ti.default=ii;var ai={};Object.defineProperty(ai,"__esModule",{value:!0}),ai.contentVocabulary=ai.metadataVocabulary=void 0,ai.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],ai.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"],Object.defineProperty(Lr,"__esModule",{value:!0});const ci=tn,li=gs,pi=ti,di=ai,ui=[qr.default,ci.default,(0,li.default)(),pi.default,di.metadataVocabulary,di.contentVocabulary];Lr.default=ui;var hi={},fi={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))}(fi),Object.defineProperty(hi,"__esModule",{value:!0});const mi=Re,yi=fi,gi=vr,vi=Oe,wi={message:({params:{discrError:e,tagName:t}})=>e===yi.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>mi._`{error: ${e}, tag: ${r}, tagValue: ${t}}`},$i={keyword:"discriminator",type:"object",schemaType:"object",error:wi,code(e){const{gen:t,data:r,schema:n,parentSchema:s,it:o}=e,{oneOf:i}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=n.propertyName;if("string"!=typeof a)throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");const c=t.let("valid",!1),l=t.const("tag",mi._`${r}${(0,mi.getProperty)(a)}`);function p(r){const n=t.name("valid"),s=e.subschema({keyword:"oneOf",schemaProp:r},n);return e.mergeEvaluated(s,mi.Name),n}t.if(mi._`typeof ${l} == "string"`,(()=>function(){const r=function(){var e;const t={},r=c(s);let n=!0;for(let s=0;s<i.length;s++){let t=i[s];null!=t&&t.$ref&&!(0,vi.schemaHasRulesButRef)(t,o.self.RULES)&&(t=gi.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,null==t?void 0:t.$ref),t instanceof gi.SchemaEnv&&(t=t.schema));const p=null===(e=null==t?void 0:t.properties)||void 0===e?void 0:e[a];if("object"!=typeof p)throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);n=n&&(r||c(t)),l(p,s)}if(!n)throw new Error(`discriminator: "${a}" must be required`);return t;function c({required:e}){return Array.isArray(e)&&e.includes(a)}function l(e,t){if(e.const)p(e.const,t);else{if(!e.enum)throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`);for(const r of e.enum)p(r,t)}}function p(e,r){if("string"!=typeof e||e in t)throw new Error(`discriminator: "${a}" values must be unique strings`);t[e]=r}}();t.if(!1);for(const e in r)t.elseIf(mi._`${l} === ${e}`),t.assign(c,p(r[e]));t.else(),e.error(!1,{discrError:yi.DiscrError.Mapping,tag:l,tagName:a}),t.endIf()}()),(()=>e.error(!1,{discrError:yi.DiscrError.Tag,tag:l,tagName:a}))),e.ok(c)}};hi.default=$i;const _i={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const r=ke,n=Lr,s=hi,o=_i,i=["/properties"],a="http://json-schema.org/draft-07/schema";class c extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach((e=>this.addVocabulary(e))),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(o,i):o;this.addMetaSchema(e,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}e.exports=t=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var l=Te;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var p=Re;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return p._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return p.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return p.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return p.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return p.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return p.CodeGen}});var d=hr;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return d.default}});var u=mr;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return u.default}})}(Se,Se.exports);const bi=oe(Se.exports),Ei={$schema:"http://json-schema.org/schema",$ref:"#/definitions/Blueprint",definitions:{Blueprint:{type:"object",properties:{landingPage:{type:"string",description:"The URL to navigate to after the blueprint has been run."},description:{type:"string",description:"Optional description. It doesn't do anything but is exposed as a courtesy to developers who may want to document which blueprint file does what.",deprecated:"Use meta.description instead."},meta:{type:"object",properties:{title:{type:"string",description:"A clear and concise name for your Blueprint."},description:{type:"string",description:"A brief explanation of what your Blueprint offers."},author:{type:"string",description:"A GitHub username of the author of this Blueprint."},categories:{type:"array",items:{type:"string"},description:"Relevant categories to help users find your Blueprint in the future Blueprints section on WordPress.org."}},required:["title","author"],additionalProperties:!1,description:"Optional metadata. Used by the Blueprints gallery at https://github.com/WordPress/blueprints"},preferredVersions:{type:"object",properties:{php:{anyOf:[{$ref:"#/definitions/SupportedPHPVersion"},{type:"string",const:"latest"}],description:"The preferred PHP version to use. If not specified, the latest supported version will be used"},wp:{type:"string",description:"The preferred WordPress version to use. If not specified, the latest supported version will be used"}},required:["php","wp"],additionalProperties:!1,description:"The preferred PHP and WordPress versions to use."},features:{type:"object",properties:{networking:{type:"boolean",description:"Should boot with support for network request via wp_safe_remote_get?"}},additionalProperties:!1},constants:{type:"object",additionalProperties:{type:"string"},description:"PHP Constants to define on every request",deprecated:"This experimental option will change without warning.\nUse `steps` instead."},plugins:{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/definitions/FileReference"}]},description:"WordPress plugins to install and activate",deprecated:"This experimental option will change without warning.\nUse `steps` instead."},siteOptions:{type:"object",additionalProperties:{type:"string"},properties:{blogname:{type:"string",description:"The site title"}},description:"WordPress site options to define",deprecated:"This experimental option will change without warning.\nUse `steps` instead."},login:{anyOf:[{type:"boolean"},{type:"object",properties:{username:{type:"string"},password:{type:"string"}},required:["username","password"],additionalProperties:!1}],description:"User to log in as. If true, logs the user in as admin/password."},phpExtensionBundles:{type:"array",items:{$ref:"#/definitions/SupportedPHPExtensionBundle"},description:"The PHP extensions to use."},steps:{type:"array",items:{anyOf:[{$ref:"#/definitions/StepDefinition"},{type:"string"},{not:{}},{type:"boolean",const:!1},{type:"null"}]},description:"The steps to run after every other operation in this Blueprint was executed."},$schema:{type:"string"}},additionalProperties:!1},SupportedPHPVersion:{type:"string",enum:["8.3","8.2","8.1","8.0","7.4","7.3","7.2","7.1","7.0"]},FileReference:{anyOf:[{$ref:"#/definitions/VFSReference"},{$ref:"#/definitions/LiteralReference"},{$ref:"#/definitions/CoreThemeReference"},{$ref:"#/definitions/CorePluginReference"},{$ref:"#/definitions/UrlReference"}]},VFSReference:{type:"object",properties:{resource:{type:"string",const:"vfs",description:"Identifies the file resource as Virtual File System (VFS)"},path:{type:"string",description:"The path to the file in the VFS"}},required:["resource","path"],additionalProperties:!1},LiteralReference:{type:"object",properties:{resource:{type:"string",const:"literal",description:"Identifies the file resource as a literal file"},name:{type:"string",description:"The name of the file"},contents:{anyOf:[{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}}],description:"The contents of the file"}},required:["resource","name","contents"],additionalProperties:!1},CoreThemeReference:{type:"object",properties:{resource:{type:"string",const:"wordpress.org/themes",description:"Identifies the file resource as a WordPress Core theme"},slug:{type:"string",description:"The slug of the WordPress Core theme"}},required:["resource","slug"],additionalProperties:!1},CorePluginReference:{type:"object",properties:{resource:{type:"string",const:"wordpress.org/plugins",description:"Identifies the file resource as a WordPress Core plugin"},slug:{type:"string",description:"The slug of the WordPress Core plugin"}},required:["resource","slug"],additionalProperties:!1},UrlReference:{type:"object",properties:{resource:{type:"string",const:"url",description:"Identifies the file resource as a URL"},url:{type:"string",description:"The URL of the file"},caption:{type:"string",description:"Optional caption for displaying a progress message"}},required:["resource","url"],additionalProperties:!1},SupportedPHPExtensionBundle:{type:"string",enum:["kitchen-sink","light"]},StepDefinition:{type:"object",discriminator:{propertyName:"step"},required:["step"],oneOf:[{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"activatePlugin"},pluginPath:{type:"string",description:"Path to the plugin directory as absolute path (/wordpress/wp-content/plugins/plugin-name); or the plugin entry file relative to the plugins directory (plugin-name/plugin-name.php)."},pluginName:{type:"string",description:"Optional. Plugin name to display in the progress bar."}},required:["pluginPath","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"activateTheme"},themeFolderName:{type:"string",description:"The name of the theme folder inside wp-content/themes/"}},required:["step","themeFolderName"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"cp"},fromPath:{type:"string",description:"Source path"},toPath:{type:"string",description:"Target path"}},required:["fromPath","step","toPath"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"defineWpConfigConsts"},consts:{type:"object",additionalProperties:{},description:"The constants to define"},method:{type:"string",enum:["rewrite-wp-config","define-before-run"],description:"The method of defining the constants in wp-config.php. Possible values are:\n\n- rewrite-wp-config: Default. Rewrites the wp-config.php file to                      explicitly call define() with the requested                      name and value. This method alters the file                      on the disk, but it doesn't conflict with                      existing define() calls in wp-config.php.\n\n- define-before-run: Defines the constant before running the requested                      script. It doesn't alter any files on the disk, but                      constants defined this way may conflict with existing                      define() calls in wp-config.php."},virtualize:{type:"boolean",deprecated:"This option is noop and will be removed in a future version.\nThis option is only kept in here to avoid breaking Blueprint schema validation\nfor existing apps using this option."}},required:["consts","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"defineSiteUrl"},siteUrl:{type:"string",description:"The URL"}},required:["siteUrl","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"enableMultisite"}},required:["step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"importWxr"},file:{$ref:"#/definitions/FileReference",description:"The file to import"}},required:["file","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"importWordPressFiles"},wordPressFilesZip:{$ref:"#/definitions/FileReference",description:"The zip file containing the top-level WordPress files and directories."},pathInZip:{type:"string",description:"The path inside the zip file where the WordPress files are."}},required:["step","wordPressFilesZip"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},ifAlreadyInstalled:{type:"string",enum:["overwrite","skip","error"],description:"What to do if the asset already exists."},step:{type:"string",const:"installPlugin",description:"The step identifier."},pluginZipFile:{$ref:"#/definitions/FileReference",description:"The plugin zip file to install."},options:{$ref:"#/definitions/InstallPluginOptions",description:"Optional installation options."}},required:["pluginZipFile","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},ifAlreadyInstalled:{type:"string",enum:["overwrite","skip","error"],description:"What to do if the asset already exists."},step:{type:"string",const:"installTheme",description:"The step identifier."},themeZipFile:{$ref:"#/definitions/FileReference",description:"The theme zip file to install."},options:{type:"object",properties:{activate:{type:"boolean",description:"Whether to activate the theme after installing it."}},additionalProperties:!1,description:"Optional installation options."}},required:["step","themeZipFile"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"login"},username:{type:"string",description:"The user to log in as. Defaults to 'admin'."},password:{type:"string",description:"The password to log in with. Defaults to 'password'."}},required:["step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"mkdir"},path:{type:"string",description:"The path of the directory you want to create"}},required:["path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"mv"},fromPath:{type:"string",description:"Source path"},toPath:{type:"string",description:"Target path"}},required:["fromPath","step","toPath"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"resetData"}},required:["step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"request"},request:{$ref:"#/definitions/PHPRequest",description:"Request details (See /wordpress-playground/api/universal/interface/PHPRequest)"}},required:["request","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"rm"},path:{type:"string",description:"The path to remove"}},required:["path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"rmdir"},path:{type:"string",description:"The path to remove"}},required:["path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runPHP",description:"The step identifier."},code:{type:"string",description:"The PHP code to run."}},required:["code","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runPHPWithOptions"},options:{$ref:"#/definitions/PHPRunOptions",description:"Run options (See /wordpress-playground/api/universal/interface/PHPRunOptions/))"}},required:["options","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runWpInstallationWizard"},options:{$ref:"#/definitions/WordPressInstallationOptions"}},required:["options","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runSql",description:"The step identifier."},sql:{$ref:"#/definitions/FileReference",description:"The SQL to run. Each non-empty line must contain a valid SQL query."}},required:["sql","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"setSiteOptions",description:'The name of the step. Must be "setSiteOptions".'},options:{type:"object",additionalProperties:{},description:"The options to set on the site."}},required:["options","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"unzip"},zipFile:{$ref:"#/definitions/FileReference",description:"The zip file to extract"},zipPath:{type:"string",description:"The path of the zip file to extract",deprecated:"Use zipFile instead."},extractToPath:{type:"string",description:"The path to extract the zip file to"}},required:["extractToPath","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"updateUserMeta"},meta:{type:"object",additionalProperties:{},description:'An object of user meta values to set, e.g. { "first_name": "John" }'},userId:{type:"number",description:"User ID"}},required:["meta","step","userId"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"writeFile"},path:{type:"string",description:"The path of the file to write to"},data:{anyOf:[{$ref:"#/definitions/FileReference"},{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}}],description:"The data to write"}},required:["data","path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"wp-cli",description:"The step identifier."},command:{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}],description:"The WP CLI command to run."},wpCliPath:{type:"string",description:"wp-cli.phar path"}},required:["command","step"]}]},InstallPluginOptions:{type:"object",properties:{activate:{type:"boolean",description:"Whether to activate the plugin after installing it."}},additionalProperties:!1},PHPRequest:{type:"object",properties:{method:{$ref:"#/definitions/HTTPMethod",description:"Request method. Default: `GET`."},url:{type:"string",description:"Request path or absolute URL."},headers:{$ref:"#/definitions/PHPRequestHeaders",description:"Request headers."},body:{anyOf:[{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}},{type:"object",additionalProperties:{anyOf:[{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}},{type:"object",properties:{size:{type:"number"},type:{type:"string"},lastModified:{type:"number"},name:{type:"string"},webkitRelativePath:{type:"string"}},required:["lastModified","name","size","type","webkitRelativePath"],additionalProperties:!1}]}}],description:"Request body. If an object is given, the request will be encoded as multipart and sent with a `multipart/form-data` header."}},required:["url"],additionalProperties:!1},HTTPMethod:{type:"string",enum:["GET","POST","HEAD","OPTIONS","PATCH","PUT","DELETE"]},PHPRequestHeaders:{type:"object",additionalProperties:{type:"string"}},PHPRunOptions:{type:"object",properties:{relativeUri:{type:"string",description:"Request path following the domain:port part."},scriptPath:{type:"string",description:"Path of the .php file to execute."},protocol:{type:"string",description:"Request protocol."},method:{$ref:"#/definitions/HTTPMethod",description:"Request method. Default: `GET`."},headers:{$ref:"#/definitions/PHPRequestHeaders",description:"Request headers."},body:{anyOf:[{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}}],description:"Request body."},env:{type:"object",additionalProperties:{type:"string"},description:"Environment variables to set for this run."},$_SERVER:{type:"object",additionalProperties:{type:"string"},description:"$_SERVER entries to set for this run."},code:{type:"string",description:"The code snippet to eval instead of a php file."}},additionalProperties:!1},WordPressInstallationOptions:{type:"object",properties:{adminUsername:{type:"string"},adminPassword:{type:"string"}},additionalProperties:!1}}},{wpCLI:Pi,...Si}=K,ki={...Si,"wp-cli":Pi,importFile:Si.importWxr};function Ti(e,{progress:t=new Q,semaphore:r=new l({concurrency:3}),onStepCompleted:n=()=>{}}={}){var s,o,i,a,c,p,d;e={...e,steps:(e.steps||[]).filter(ji).filter(Oi)};for(const l of e.steps)"object"==typeof l&&"importFile"===l.step&&(l.step="importWxr",b.warn('The "importFile" step is deprecated. Use "importWxr" instead.'));if(e.constants&&e.steps.unshift({step:"defineWpConfigConsts",consts:e.constants}),e.siteOptions&&e.steps.unshift({step:"setSiteOptions",options:e.siteOptions}),e.plugins){const t=e.plugins.map((e=>"string"==typeof e?e.startsWith("https://")?{resource:"url",url:e}:{resource:"wordpress.org/plugins",slug:e}:e)).map((e=>({step:"installPlugin",pluginZipFile:e})));e.steps.unshift(...t)}e.login&&e.steps.push({step:"login",...!0===e.login?{username:"admin",password:"password"}:e.login}),e.phpExtensionBundles||(e.phpExtensionBundles=[]),e.phpExtensionBundles||(e.phpExtensionBundles=[]),0===e.phpExtensionBundles.length&&e.phpExtensionBundles.push("kitchen-sink");const u=null==(s=e.steps)?void 0:s.findIndex((e=>"object"==typeof e&&"wp-cli"===(null==e?void 0:e.step)));void 0!==u&&u>-1&&(e.phpExtensionBundles.includes("light")&&(e.phpExtensionBundles=e.phpExtensionBundles.filter((e=>"light"!==e)),b.warn("The wpCli step used in your Blueprint requires the iconv and mbstring PHP extensions. However, you did not specify the kitchen-sink extension bundle. Playground will override your choice and load the kitchen-sink PHP extensions bundle to prevent the WP-CLI step from failing. ")),null==(o=e.steps)||o.splice(u,0,{step:"writeFile",data:{resource:"url",url:"https://playground.wordpress.net/wp-cli.phar"},path:"/tmp/wp-cli.phar"}));const h=null==(i=e.steps)?void 0:i.findIndex((e=>"object"==typeof e&&"importWxr"===(null==e?void 0:e.step)));void 0!==h&&h>-1&&(e.phpExtensionBundles.includes("light")&&(e.phpExtensionBundles=e.phpExtensionBundles.filter((e=>"light"!==e)),b.warn("The importWxr step used in your Blueprint requires the iconv and mbstring PHP extensions. However, you did not specify the kitchen-sink extension bundle. Playground will override your choice and load the kitchen-sink PHP extensions bundle to prevent the WP-CLI step from failing. ")),null==(a=e.steps)||a.splice(h,0,{step:"installPlugin",pluginZipFile:{resource:"url",url:"https://playground.wordpress.net/wordpress-importer.zip",caption:"Downloading the WordPress Importer plugin"}}));const{valid:f,errors:m}=function(e){var t;xi=Ci.compile(Ei);const r=xi(e);if(r)return{valid:r};const n=new Set;for(const o of xi.errors)o.schemaPath.startsWith("#/properties/steps/items/anyOf")||n.add(o.instancePath);const s=null==(t=xi.errors)?void 0:t.filter((e=>!(e.schemaPath.startsWith("#/properties/steps/items/anyOf")&&n.has(e.instancePath))));return{valid:r,errors:s}}(e);if(!f){const e=new Error(`Invalid blueprint: ${m[0].message} at ${m[0].instancePath}`);throw e.errors=m,e}const y=e.steps||[],g=y.reduce(((e,t)=>{var r;return e+((null==(r=t.progress)?void 0:r.weight)||1)}),0),v=y.map((e=>function(e,{semaphore:t,rootProgressTracker:r,totalProgressWeight:n}){var s;const o=r.stage(((null==(s=e.progress)?void 0:s.weight)||1)/n),i={};for(const d of Object.keys(e)){let r=e[d];ue(r)&&(r=he.create(r,{semaphore:t})),i[d]=r}const a=async t=>{var r;try{return o.fillSlowly(),await ki[e.step](t,await async function(e){const t={};for(const r in e){const n=e[r];t[r]=n instanceof he?await n.resolve():n}return t}(i),{tracker:o,initialCaption:null==(r=e.progress)?void 0:r.caption})}finally{o.finish()}},c=Ii(i),l=Ii(i).filter((e=>e.isAsync)),p=1/(l.length+1);for(const d of l)d.progress=o.stage(p);return{run:a,step:e,resources:c}}(e,{semaphore:r,rootProgressTracker:t,totalProgressWeight:g})));return{versions:{php:Ri(null==(c=e.preferredVersions)?void 0:c.php,ae,ce),wp:(null==(p=e.preferredVersions)?void 0:p.wp)||"latest"},phpExtensions:Ni([],e.phpExtensionBundles||[]),features:{networking:(null==(d=e.features)?void 0:d.networking)??!1},run:async r=>{try{for(const{resources:e}of v)for(const t of e)t.setPlayground(r),t.isAsync&&t.resolve();for(const[e,{run:t,step:o}]of Object.entries(v))try{const e=await t(r);n(e,o)}catch(s){throw b.error(s),new Error(`Error when executing the blueprint step #${e} (${JSON.stringify(o)}) ${s instanceof Error?`: ${s.message}`:s}`,{cause:s})}}finally{try{await r.goTo(e.landingPage||"/")}catch{}t.finish()}}}}const Ci=new bi({discriminator:!0});let xi;function Ri(e,t,r){return e&&t.includes(e)?e:r}function Ni(e,t){const r=le.filter((t=>e.includes(t))),n=t.flatMap((e=>e in pe?pe[e]:[]));return Array.from(new Set([...r,...n]))}function ji(e){return!("object"!=typeof e||!e)}function Oi(e){return!["setPhpIniEntry","request"].includes(e.step)||(b.warn(`The "${e.step}" Blueprint is no longer supported and you can remove it from your Blueprint.`),!1)}function Ii(e){const t=[];for(const r in e){const n=e[r];n instanceof he&&t.push(n)}return t}const Ai=Symbol("Comlink.proxy"),Di=Symbol("Comlink.endpoint"),Mi=Symbol("Comlink.releaseProxy"),Fi=Symbol("Comlink.finalizer"),Li=Symbol("Comlink.thrown"),qi=e=>"object"==typeof e&&null!==e||"function"==typeof e,Ui={canHandle:e=>qi(e)&&e[Ai],serialize(e){const{port1:t,port2:r}=new MessageChannel;return Wi(e,t),[r,[r]]},deserialize:e=>(e.start(),Hi(e))},zi={canHandle:e=>qi(e)&&Li in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},Vi=new Map([["proxy",Ui],["throw",zi]]);function Wi(e,t=globalThis,r=["*"]){t.addEventListener("message",(function n(s){if(!s||!s.data)return;if(!function(e,t){for(const r of e)if(t===r||"*"===r||r instanceof RegExp&&r.test(t))return!0;return!1}(r,s.origin))return void console.warn(`Invalid origin '${s.origin}' for comlink proxy`);const{id:o,type:i,path:a}=Object.assign({path:[]},s.data),c=(s.data.argumentList||[]).map(na);let l;try{const t=a.slice(0,-1).reduce(((e,t)=>e[t]),e),r=a.reduce(((e,t)=>e[t]),e);switch(i){case"GET":l=r;break;case"SET":t[a.slice(-1)[0]]=na(s.data.value),l=!0;break;case"APPLY":l=r.apply(t,c);break;case"CONSTRUCT":l=ta(new r(...c));break;case"ENDPOINT":{const{port1:t,port2:r}=new MessageChannel;Wi(e,r),l=function(e,t){return ea.set(e,t),e}(t,[t])}break;case"RELEASE":l=void 0;break;default:return}}catch(p){l={value:p,[Li]:0}}Promise.resolve(l).catch((e=>({value:e,[Li]:0}))).then((r=>{const[s,a]=ra(r);t.postMessage(Object.assign(Object.assign({},s),{id:o}),a),"RELEASE"===i&&(t.removeEventListener("message",n),Bi(t),Fi in e&&"function"==typeof e[Fi]&&e[Fi]())})).catch((e=>{const[r,n]=ra({value:new TypeError("Unserializable return value"),[Li]:0});t.postMessage(Object.assign(Object.assign({},r),{id:o}),n)}))})),t.start&&t.start()}function Bi(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function Hi(e,t){return Zi(e,[],t)}function Gi(e){if(e)throw new Error("Proxy has been released and is not useable")}function Ki(e){return sa(e,{type:"RELEASE"}).then((()=>{Bi(e)}))}const Ji=new WeakMap,Qi="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(Ji.get(e)||0)-1;Ji.set(e,t),0===t&&Ki(e)}));function Zi(e,t=[],r=function(){}){let n=!1;const s=new Proxy(r,{get(r,o){if(Gi(n),o===Mi)return()=>{(function(e){Qi&&Qi.unregister(e)})(s),Ki(e),n=!0};if("then"===o){if(0===t.length)return{then:()=>s};const r=sa(e,{type:"GET",path:t.map((e=>e.toString()))}).then(na);return r.then.bind(r)}return Zi(e,[...t,o])},set(r,s,o){Gi(n);const[i,a]=ra(o);return sa(e,{type:"SET",path:[...t,s].map((e=>e.toString())),value:i},a).then(na)},apply(r,s,o){Gi(n);const i=t[t.length-1];if(i===Di)return sa(e,{type:"ENDPOINT"}).then(na);if("bind"===i)return Zi(e,t.slice(0,-1));const[a,c]=Xi(o);return sa(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:a},c).then(na)},construct(r,s){Gi(n);const[o,i]=Xi(s);return sa(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:o},i).then(na)}});return function(e,t){const r=(Ji.get(t)||0)+1;Ji.set(t,r),Qi&&Qi.register(e,t,e)}(s,e),s}function Yi(e){return Array.prototype.concat.apply([],e)}function Xi(e){const t=e.map(ra);return[t.map((e=>e[0])),Yi(t.map((e=>e[1])))]}const ea=new WeakMap;function ta(e){return Object.assign(e,{[Ai]:!0})}function ra(e){for(const[t,r]of Vi)if(r.canHandle(e)){const[n,s]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},s]}return[{type:"RAW",value:e},ea.get(e)||[]]}function na(e){switch(e.type){case"HANDLER":return Vi.get(e.name).deserialize(e.value);case"RAW":return e.value}}function sa(e,t,r){return new Promise((n=>{const s=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(r){!r.data||!r.data.id||r.data.id!==s||(e.removeEventListener("message",t),n(r.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:s},t),r)}))}function oa(e,t=void 0){!function(){if(aa)return;aa=!0,Vi.set("EVENT",{canHandle:e=>e instanceof CustomEvent,serialize:e=>[{detail:e.detail},[]],deserialize:e=>e}),Vi.set("FUNCTION",{canHandle:e=>"function"==typeof e,serialize(e){const{port1:t,port2:r}=new MessageChannel;return Wi(e,t),[r,[r]]},deserialize:e=>(e.start(),Hi(e))}),Vi.set("PHPResponse",{canHandle:e=>"object"==typeof e&&null!==e&&"headers"in e&&"bytes"in e&&"errors"in e&&"exitCode"in e&&"httpStatusCode"in e,serialize:e=>[e.toRawData(),[]],deserialize:e=>se.fromRawData(e)});const e=Vi.get("throw"),t=null==e?void 0:e.serialize;e.serialize=({value:e})=>{const r=t({value:e});return e.response&&(r[0].value.response=e.response),e.source&&(r[0].value.source=e.source),r}}();const r=e instanceof Worker?e:function(e,t=globalThis,r="*"){return{postMessage:(t,n)=>e.postMessage(t,r,n),addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}(e,t),n=Hi(r),s=ca(n);return new Proxy(s,{get:(e,t)=>"isConnected"===t?async()=>{for(;;)try{await ia(n.isConnected(),200);break}catch{}}:n[t]})}async function ia(e,t){return new Promise(((r,n)=>{setTimeout(n,t),e.then(r)}))}let aa=!1;function ca(e){return new Proxy(e,{get(e,t){switch(typeof e[t]){case"function":return(...r)=>e[t](...r);case"object":return null===e[t]?e[t]:ca(e[t]);case"undefined":case"number":case"string":return e[t];default:return ta(e[t])}}})}async function la({iframe:e,blueprint:t,remoteUrl:r,progressTracker:n=new Q,disableProgressBar:s,onBlueprintStepCompleted:o,onClientConnected:i=()=>{},sapiName:a,onBeforeBlueprint:c,siteSlug:l}){if(function(e){const t=new URL(e,da);if((t.origin===da||"localhost"===t.hostname)&&"/remote.html"!==t.pathname)throw new Error(`Invalid remote URL: ${t}. Expected origin to be ${da}/remote.html.`)}(r),function(e){var t,r;null!=(t=e.sandbox)&&t.length&&(null==(r=e.sandbox)||!r.contains("allow-storage-access-by-user-activation"))&&e.sandbox.add("allow-storage-access-by-user-activation")}(e),r=ua(r,{progressbar:!s}),n.setCaption("Preparing WordPress"),!t){const t=await pa(e,ua(r,{"php-extension":"kitchen-sink","site-slug":l}),n);return i(t),t}const p=Ti(t,{progress:n.stage(.5),onStepCompleted:o}),d=await pa(e,ua(r,{php:p.versions.php,wp:p.versions.wp,"sapi-name":a,"php-extension":p.phpExtensions,networking:p.features.networking?"yes":"no","site-slug":l}),n);return T(b,d),i(d),c&&await c(),await async function(e,t){await e.run(t)}(p,d),n.finish(),d}async function pa(e,t,r){await new Promise((r=>{e.src=t,e.addEventListener("load",r,!1)}));const n=oa(e.contentWindow,e.ownerDocument.defaultView);await n.isConnected(),r.pipe(n);const s=r.stage();return await n.onDownloadProgress(s.loadingListener),await n.isReady(),s.finish(),n}const da="https://playground.wordpress.net";function ua(e,t){const r=new URL(e,da),n=new URLSearchParams(r.search);for(const[s,o]of Object.entries(t))if(null!=o&&!1!==o)if(Array.isArray(o))for(const e of o)n.append(s,e.toString());else n.set(s,o.toString());return r.search=n.toString(),r.toString()}}}]);