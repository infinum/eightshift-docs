"use strict";(self.webpackChunk_eightshift_docs=self.webpackChunk_eightshift_docs||[]).push([[8256],{46358:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return u},frontMatter:function(){return r},metadata:function(){return p},toc:function(){return m}});var o=n(87462),s=n(63366),a=(n(67294),n(3905)),i=["components"],r={title:"Using multiple same components",description:"Explains how to use multiple same components inside",slug:"multiple-same-components",authors:"obradovic",date:new Date("2023-06-12T00:00:00.000Z"),tags:["eightshift","boilerplate","components","blocks"],hide_table_of_contents:!1},l=void 0,p={permalink:"/blog/multiple-same-components",source:"@site/blog/2023-06-12-multiple-same-components.md",title:"Using multiple same components",description:"Explains how to use multiple same components inside",date:"2023-06-12T00:00:00.000Z",formattedDate:"June 12, 2023",tags:[{label:"eightshift",permalink:"/blog/tags/eightshift"},{label:"boilerplate",permalink:"/blog/tags/boilerplate"},{label:"components",permalink:"/blog/tags/components"},{label:"blocks",permalink:"/blog/tags/blocks"}],readingTime:6.305,hasTruncateMarker:!0,authors:[{name:"Igor Obradovi\u0107",title:"WordPress Engineer",url:"https://github.com/iobrado",imageURL:"https://avatars.githubusercontent.com/u/23059501?v=4",key:"obradovic"}],frontMatter:{title:"Using multiple same components",description:"Explains how to use multiple same components inside",slug:"multiple-same-components",authors:"obradovic",date:"2023-06-12T00:00:00.000Z",tags:["eightshift","boilerplate","components","blocks"],hide_table_of_contents:!1},nextItem:{title:"Block Patterns",permalink:"/blog/block-patterns"}},c={authorsImageUrls:[void 0]},m=[{value:"Manifest and attributes",id:"manifest-and-attributes",level:2},{value:"The &quot;props&quot; Helper",id:"the-props-helper",level:2},{value:"A step-by-step example",id:"a-step-by-step-example",level:2},{value:"Conclusion",id:"conclusion",level:3}],d={toc:m};function u(e){var t=e.components,r=(0,s.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"From time to time, you may need to create a block or a more complex component that uses more than one instance of the same component. In this blog post, we'll explain how this works in a bit more detail."),(0,a.kt)("p",null,"An example of this use case is the Card component, which uses two heading components. You may get the general idea by just going through the code and trying to reverse-engineer it, but this example will give you a much better understanding of how it works and how to use it. First, let's cover some basics."),(0,a.kt)("h2",{id:"manifest-and-attributes"},"Manifest and attributes"),(0,a.kt)("p",null,"The way multiple same components work is by having a different key. Here is an example of the Card component:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'"components": {\n    "image": "image",\n    "intro": "heading",\n    "heading": "heading",\n    "paragraph": "paragraph",\n    "button": "button"\n},\n')),(0,a.kt)("p",null,"As you can see, one heading component has the ",(0,a.kt)("inlineCode",{parentName:"p"},"intro")," key, while the other one has the ",(0,a.kt)("inlineCode",{parentName:"p"},"heading")," key. That way the ",(0,a.kt)("strong",{parentName:"p"},"intro")," heading component is being referred to as ",(0,a.kt)("inlineCode",{parentName:"p"},"intro")," so there is no mixup with the attribute values between the two heading blocks. This can be seen when setting the default attributes:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'"cardIntroSize": {\n    "type": "string",\n    "default": "tiny"\n},\n"cardHeadingSize": {\n    "type": "string",\n    "default": "big"\n}\n')),(0,a.kt)("h2",{id:"the-props-helper"},'The "props" Helper'),(0,a.kt)("p",null,"This method does all the heavy lifting for us. It replaces the default attribute names with the ones we provide. There is both the PHP and JS version of it."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"Components::render('heading', Components::props('intro', $attributes, [\n    'selectorClass' => 'intro',\n    'blockClass' => $componentClass\n]))\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"\n<HeadingEditor\n    {...props('intro', attributes, {\n        selectorClass: 'intro',\n        blockClass: componentClass,\n    })}\n/>\n\n")),(0,a.kt)("p",null,"If you ",(0,a.kt)("inlineCode",{parentName:"p"},"var_dump")," the props helper, you\u2019ll notice the ",(0,a.kt)("inlineCode",{parentName:"p"},"prefix")," key, which is built from the names of the blocks and components used hierarchically. For example, when looking at a regular Heading component in the Card block, the prefix will be:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"cardCardHeading")," - first is the Card block name, then the Card component name and finally Heading component name."),(0,a.kt)("p",null,"The Heading component that is called Intro then has the prefix ",(0,a.kt)("inlineCode",{parentName:"p"},"cardCardIntro"),". This prefix is then added to the attribute name, which then finally results in ",(0,a.kt)("inlineCode",{parentName:"p"},"cardCardHeadingSize")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"cardCardIntroSize")," attributes, for example."),(0,a.kt)("p",null,"While at first glance it seems strange to have this naming scheme, it actually allows us to figure out the hierarchy just by looking at the attribute name."),(0,a.kt)("h2",{id:"a-step-by-step-example"},"A step-by-step example"),(0,a.kt)("p",null,"The block we'll be creating as an example will be a block which we can use for some sort of comparison or listing pros and cons. To create it, we will need the following:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"two ",(0,a.kt)("inlineCode",{parentName:"li"},"Heading")," components"),(0,a.kt)("li",{parentName:"ul"},"two ",(0,a.kt)("inlineCode",{parentName:"li"},"List")," components")),(0,a.kt)("p",null,"The easiest way to create a new block is by using the boilerplate command"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"wp boilerplate blocks use-block --name=example")),(0,a.kt)("p",null,"Once the new block is added to your project, rename it. Also, don\u2019t forget to update all file names and imports in JS."),(0,a.kt)("p",null,"We should start with ",(0,a.kt)("inlineCode",{parentName:"p"},"manifest.json"),", where we define the components we'll use and set the default attributes. For now, just define the components and their keys:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'"components": {\n    "heading": "heading",\n    "lists": "lists",\n    "secondaryHeading": "heading",\n    "secondaryLists": "lists"\n}\n')),(0,a.kt)("p",null,'The first section has the default key names, while the "duplicates" have different key names.'),(0,a.kt)("p",null,"After manifest, we can move to the JS part. As this is a fairly simple block without any advanced options or layouts, we need to add two ",(0,a.kt)("inlineCode",{parentName:"p"},"HeadingEditor")," components and two ",(0,a.kt)("inlineCode",{parentName:"p"},"ListsEditor")," components. To make styling easier, we can separate them in two ",(0,a.kt)("inlineCode",{parentName:"p"},"div")," elements. When you\u2019re finished, your code should look like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import React from 'react';\nimport { __ } from '@wordpress/i18n';\nimport { HeadingEditor } from '../../../components/heading/components/heading-editor';\nimport { ListsEditor } from '../../../components/lists/components/lists-editor';\n\nimport { props, selector } from '@eightshift/frontend-libs/scripts';\n\nexport const ComparisonEditor = ({ attributes, setAttributes }) => {\n    const {\n        blockClass,\n    } = attributes;\n\n    const comparisonPrimaryClass = selector(blockClass, blockClass, 'primary');\n\n    const comparisonSecondaryClass = selector(blockClass, blockClass, 'secondary');\n\n    return (\n        <div className={blockClass}>\n            <div className={comparisonPrimaryClass}>\n                <HeadingEditor\n                    {...props('heading', attributes, {\n                        blockClass: blockClass,\n                        setAttributes: setAttributes,\n                    })}\n                />\n\n                <ListsEditor\n                    {...props('lists', attributes, {\n                        blockClass: blockClass,\n                        setAttributes: setAttributes,\n                    })}\n                />\n            </div>\n            <div className={comparisonSecondaryClass}>\n                <HeadingEditor\n                    {...props('secondaryHeading', attributes, {\n                        selectorClass: 'secondary-heading',\n                        blockClass: blockClass,\n                        setAttributes: setAttributes,\n                    })}\n                />\n\n                <ListsEditor\n                    {...props('secondaryLists', attributes, {\n                        selectorClass: 'secondary-lists',\n                        blockClass: blockClass,\n                        setAttributes: setAttributes,\n                    })}\n                />\n            </div>\n        </div>\n    );\n};\n")),(0,a.kt)("p",null,"Note how we defined the different names with the ",(0,a.kt)("inlineCode",{parentName:"p"},"props")," helper. Additionally, we set the selector class for easier targeting of components when styling."),(0,a.kt)("p",null,"Next, we can add the options. Again, the ",(0,a.kt)("inlineCode",{parentName:"p"},"props")," helper does all the heavy lifting for us. This is how the code should look after adding all component options:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import React from 'react';\nimport { __ } from '@wordpress/i18n';\nimport { props, getOptions } from '@eightshift/frontend-libs/scripts';\nimport { HeadingOptions } from '../../../components/heading/components/heading-options';\nimport { ListsOptions } from '../../../components/lists/components/lists-options';\nimport { PanelBody } from '@wordpress/components';\nimport manifest from '../manifest.json';\n\nexport const ComparisonOptions = ({ attributes, setAttributes }) => {\n    return (\n        <PanelBody title={__('Comparison', 'eightshift')}>\n            <HeadingOptions\n                {...props('heading', attributes, {\n                    setAttributes,\n                    options: getOptions(attributes, manifest)\n                })}\n                reducedBottomSpacing\n            />\n\n            <ListsOptions\n                {...props('lists', attributes, {\n                    setAttributes,\n                    options: getOptions(attributes, manifest)\n                })}\n                reducedBottomSpacing\n            />\n\n            <HeadingOptions\n                {...props('secondaryHeading', attributes, {\n                    setAttributes,\n                    options: getOptions(attributes, manifest)\n                })}\n                label={__('Secondary Heading', 'eightshift')}\n                reducedBottomSpacing\n            />\n\n            <ListsOptions\n                {...props('secondaryLists', attributes, {\n                    setAttributes,\n                    options: getOptions(attributes, manifest)\n                })}\n                label={__('Secondary Lists', 'eightshift')}\n                reducedBottomSpacing\n            />\n        </PanelBody>\n    );\n};\n")),(0,a.kt)("p",null,"Adding the PHP part should be simple, but here is the code for reference:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\n/**\n * Template for the Comparison Block view.\n *\n * @package Eightshift\n */\n\nuse EightshiftVendor\\EightshiftLibs\\Helpers\\Components;\n\n$globalManifest = Components::getManifest(dirname(__DIR__, 2));\n$manifest = Components::getManifest(__DIR__);\n\n$blockClass = $attributes['blockClass'] ?? '';\n\n$comparisonPrimaryClass = Components::selector($blockClass, $blockClass, 'primary');\n\n$comparisonSecondaryClass = Components::selector($blockClass, $blockClass, 'secondary');\n\n$unique = Components::getUnique();\n\n?>\n\n<div class=\"<?php echo esc_attr($blockClass); ?>\">\n    <?php echo Components::outputCssVariables($attributes, $manifest, $unique, $globalManifest); ?>\n    <div class=\"<?php echo esc_attr($comparisonPrimaryClass); ?>\">\n        <?php\n            echo Components::render('heading', Components::props('heading', $attributes)),\n            Components::render('lists', Components::props('lists', $attributes));\n        ?>\n    </div>\n    <div class=\"<?php echo esc_attr($comparisonSecondaryClass); ?>\">\n        <?php\n            echo Components::render('heading', Components::props('secondaryHeading', $attributes)),\n            Components::render('lists', Components::props('secondaryLists', $attributes));\n        ?>\n    </div>\n</div>\n")),(0,a.kt)("p",null,"The block should work properly now, but the two lists look the same. To make a difference between the two, we can change the default list colors in the manifest. If we don\u2019t have the colors we want already available in the project, first we need to add them to the global manifest."),(0,a.kt)("p",null,"For a detailed explanation on how to add new colors to your project, you can read a previous blog post about ",(0,a.kt)("a",{parentName:"p",href:"/blog/modifying-blocks-color-theme#adding-new-colors-to-your-project"},"modifying blocks"),"."),(0,a.kt)("p",null,"Now we have to add these new colors to the Lists component ",(0,a.kt)("inlineCode",{parentName:"p"},"manifest.json"),". In ",(0,a.kt)("inlineCode",{parentName:"p"},"options")," key, find the ",(0,a.kt)("inlineCode",{parentName:"p"},"listsColor")," and add your new colors."),(0,a.kt)("p",null,"When the new colors are added to the Lists component, we can set these new colors as defaults by adding the following attributes in ",(0,a.kt)("inlineCode",{parentName:"p"},"manifest.json")," of our Comparison block:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'"comparisonListsColor": {\n    "type": "string",\n    "default": "green-haze"\n},\n"comparisonSecondaryListsColor": {\n    "type": "string",\n    "default": "milano-red"\n}\n')),(0,a.kt)("p",null,"The first list will now have green bullet points, and the second one will have red bullet points."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Comparison block",src:n(92912).Z,width:"1406",height:"346"})),(0,a.kt)("p",null,"Notice again how the attribute name is structured - current block name (",(0,a.kt)("strong",{parentName:"p"},"comparison"),"), component name (",(0,a.kt)("strong",{parentName:"p"},"Lists")," or ",(0,a.kt)("strong",{parentName:"p"},"SecondaryLists"),"), attribute (",(0,a.kt)("strong",{parentName:"p"},"Color"),")."),(0,a.kt)("p",null,"If you\u2019re ever in doubt of what is the exact attribute name, you can always ",(0,a.kt)("inlineCode",{parentName:"p"},"var_dump")," the ",(0,a.kt)("inlineCode",{parentName:"p"},"props")," helper for that component and you will see the full attribute names as the keys."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Array\n(\n    [prefix] => comparisonSecondaryLists\n    // ...\n    [comparisonSecondaryListsOrdered] => ul\n    [comparisonSecondaryListsSize] => body:regular\n    [comparisonSecondaryListsColor] => milano-red\n    [comparisonSecondaryListsColorOnlyMarker] =>\n    [comparisonSecondaryListsUse] => 1\n    // ...\n)\n")),(0,a.kt)("h3",{id:"conclusion"},"Conclusion"),(0,a.kt)("p",null,"Although this was a simple example, we covered the most important things to have in mind when using multiple same components in a block. For additional practice, you can add some more attributes or go through some of our pre-made blocks which use multiple same components. Some components/blocks you can look into are ",(0,a.kt)("inlineCode",{parentName:"p"},"Card")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"Quote"),"."))}u.isMDXComponent=!0},3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return u}});var o=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,o,s=function(e,t){if(null==e)return{};var n,o,s={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=o.createContext({}),p=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,l=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),d=p(n),u=s,h=d["".concat(l,".").concat(u)]||d[u]||m[u]||a;return n?o.createElement(h,i(i({ref:t},c),{},{components:n})):o.createElement(h,i({ref:t},c))}));function u(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,i=new Array(a);i[0]=d;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r.mdxType="string"==typeof e?e:s,i[1]=r;for(var p=2;p<a;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},92912:function(e,t,n){t.Z=n.p+"assets/images/comparison-block-c4a5cdba4d6bca4755f9ca274efd19b1.png"}}]);