"use strict";(self.webpackChunk_eightshift_docs=self.webpackChunk_eightshift_docs||[]).push([[87869],{38819:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>a});var o=t(74848),s=t(28453);const r={title:"Using inner blocks",description:"Various tips and useful features for your project included in Eightshift DevKit.",slug:"using-inner-blocks",authors:"obradovic",date:new Date("2024-03-07T00:00:00.000Z"),tags:["eightshift","boilerplate","inner blocks"],hide_table_of_contents:!1},i=void 0,l={permalink:"/blog/using-inner-blocks",source:"@site/blog/2024-03-07-using-inner-blocks.md",title:"Using inner blocks",description:"Various tips and useful features for your project included in Eightshift DevKit.",date:"2024-03-07T00:00:00.000Z",tags:[{inline:!0,label:"eightshift",permalink:"/blog/tags/eightshift"},{inline:!0,label:"boilerplate",permalink:"/blog/tags/boilerplate"},{inline:!0,label:"inner blocks",permalink:"/blog/tags/inner-blocks"}],readingTime:4.71,hasTruncateMarker:!0,authors:[{name:"Igor Obradovi\u0107",title:"WordPress Engineer",url:"https://github.com/iobrado",imageURL:"https://avatars.githubusercontent.com/u/23059501?v=4",key:"obradovic"}],frontMatter:{title:"Using inner blocks",description:"Various tips and useful features for your project included in Eightshift DevKit.",slug:"using-inner-blocks",authors:"obradovic",date:"2024-03-07T00:00:00.000Z",tags:["eightshift","boilerplate","inner blocks"],hide_table_of_contents:!1},unlisted:!1,prevItem:{title:"Using post templates",permalink:"/blog/using-post-templates"},nextItem:{title:"Tips & useful features",permalink:"/blog/tips-useful-features"}},c={authorsImageUrls:[void 0]},a=[{value:"Why use inner blocks?",id:"why-use-inner-blocks",level:2},{value:"Adding inner block support",id:"adding-inner-block-support",level:2},{value:"Overriding inner block attributes",id:"overriding-inner-block-attributes",level:2},{value:"overrideInnerBlockAttributes",id:"overrideinnerblockattributes",level:3},{value:"useBlockProps and useInnerBlocksProps",id:"useblockprops-and-useinnerblocksprops",level:3},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"InnerBlocks in WordPress enable the creation of nested block structures within the Gutenberg editor, allowing for the development of more complex and customizable content layouts."}),"\n",(0,o.jsx)(n.h2,{id:"why-use-inner-blocks",children:"Why use inner blocks?"}),"\n",(0,o.jsx)(n.p,{children:"Use of inner blocks allows for more flexibility when building content. Let\u2019s say you\u2019re building a simple two-column layout with image on one side and content on the other side. You can define the components that will be used (e.g. header, paragraph, list, button) and then just toggle the ones you don\u2019t need."}),"\n",(0,o.jsx)(n.p,{children:"This approach works perfectly fine when you have a strict layout and don\u2019t need larger content structure variations. Using inner blocks may introduce a bit more complexity - both for developers and content editors, but ultimately gives the editors much more freedom."}),"\n",(0,o.jsx)(n.p,{children:"Another example where inner blocks are used is the Carousel block. Using inner blocks allows you to add as many slides as you'd like in your carousel. Let\u2019s not forget about Columns and Group blocks. These also use inner blocks."}),"\n",(0,o.jsx)(n.h2,{id:"adding-inner-block-support",children:"Adding inner block support"}),"\n",(0,o.jsxs)(n.p,{children:["The example used in this blog post is a two-column Card that was made for a project. First thing that needs to be updated is the ",(0,o.jsx)(n.em,{children:(0,o.jsx)(n.strong,{children:"manifest.json"})})," file. For the sake of simplicity and not having too much code, the parts that aren\u2019t related to the inner blocks have been removed."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n\t"hasInnerBlocks": true,\n\t"innerBlocksDependency": [\n\t\t"heading",\n\t\t"paragraph"\n\t],\n\t"attributes": {\n\t\t"cardTwoColumnAllowedBlocks": {\n\t\t\t"type": "array",\n\t\t\t"items": {\n\t\t\t\t"type": "string"\n\t\t\t},\n\t\t\t"default": [\n\t\t\t\t"eightshift-boilerplate/paragraph",\n\t\t\t\t"eightshift-boilerplate/heading",\n\t\t\t\t"eightshift-boilerplate/button",\n\t\t\t\t"eightshift-boilerplate/lists"\n\t\t\t]\n\t\t}\n\t}\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"hasInnerBlocks"})," key defines that this block supports inner blocks. The ",(0,o.jsx)(n.code,{children:"innerBlocksDependency"})," is generally used to output block dependencies when adding a block via CLI, but it can also be used to add inner blocks automatically. You can see an example of using it in the Columns block ",(0,o.jsx)(n.code,{children:"editor.js"})," file."]}),"\n",(0,o.jsxs)(n.p,{children:["In case we need to limit which blocks can be added inside inner blocks, we can do so with an attribute. Usually, the attribute is named ",(0,o.jsx)(n.code,{children:"{blockName}AllowedBlocks"}),". Set the default value as an array of strings that represent block names you want to allow."]}),"\n",(0,o.jsxs)(n.p,{children:["Please note that the block names must include the block namespace! (",(0,o.jsx)(n.code,{children:"eightshift-boilerplate"})," by default, check in Global manifest)"]}),"\n",(0,o.jsxs)(n.p,{children:["Now you need to pass the allowed blocks attribute into the ",(0,o.jsx)(n.code,{children:"InnerBlocks"})," component In the ",(0,o.jsx)(n.code,{children:"{block-name}-editor.js"})," file. Here\u2019s an example of the code related only to the inner blocks:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:"import { InnerBlocks } from '@wordpress/block-editor';\nimport { BlockInserter } from '@eightshift/frontend-libs/scripts';\n\nexport const CardTwoColumnEditor = ({ attributes, setAttributes, clientId }) => {\n\n\tconst {\n\t\tcardTwoColumnAllowedBlocks,\n\t} = attributes;\n\n\treturn (\n\t\t<div className={contentClass}>\n\t\t\t<InnerBlocks\n\t\t\t\tallowedBlocks={(typeof cardTwoColumnAllowedBlocks === 'undefined') || cardTwoColumnAllowedBlocks}\n\t\t\t\torientation='vertical'\n\t\t\t\trenderAppender={() => <BlockInserter clientId={clientId} />}\n\t\t\t/>\n\t\t</div>\n\t);\n};\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"InnerBlocks"})," component comes from Gutenberg. In order to limit the allowed blocks, we need to pass the list of allowed inner blocks to the ",(0,o.jsx)(n.code,{children:"allowedBlocks"})," attribute. If your inner blocks should be laid out horizontally in the editor, instead of vertically, you can pass ",(0,o.jsx)(n.code,{children:"orientation='horizontal'"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"renderAppender"})," prop allows passing a custom block insert button. Due to relatively frequent changes in Gutenberg, a custom ",(0,o.jsx)(n.code,{children:"BlockInserter"})," element is available in Frontend libs as a replacement, and can be passed to ",(0,o.jsx)(n.code,{children:"InnerBlocks"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"Finally, to render the inner blocks in PHP, you need to add the following:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",children:"<?php\n// phpcs:ignore Eightshift.Security.ComponentsEscape.OutputNotEscaped\necho $innerBlockContent;\n?>\n"})}),"\n",(0,o.jsx)(n.p,{children:"And that\u2019s it! Your block now supports inner blocks."}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:"A block can have only one set of inner blocks."})}),"\n",(0,o.jsx)(n.h2,{id:"overriding-inner-block-attributes",children:"Overriding inner block attributes"}),"\n",(0,o.jsx)(n.p,{children:"Inner blocks behave like regular blocks, which means they also have a wrapper by default. This may not always be desired and manually removing wrapper or adding custom wrapper settings on each inner block can be tedious. That\u2019s why Eightshift DevKit offers few helpers that allow you to override inner block attributes."}),"\n",(0,o.jsxs)(n.p,{children:["Both of these helpers go to your ",(0,o.jsx)(n.code,{children:"{block-name}-block.js"})," file."]}),"\n",(0,o.jsx)(n.h3,{id:"overrideinnerblockattributes",children:"overrideInnerBlockAttributes"}),"\n",(0,o.jsx)(n.p,{children:"This helper allows you to set the attributes on all inner blocks by passing them as a third parameter. The example below shows how to disable the wrapper and hide wrapper controls."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:"import { useSelect } from '@wordpress/data';\nimport { overrideInnerBlockAttributes } from '@eightshift/frontend-libs/scripts';\n\nexport const Accordion = (props) => {\n\t// Set these attributes to all inner blocks once inserted in DOM.\n\tuseSelect((select) => {\n\t\toverrideInnerBlockAttributes(\n\t\t\tselect,\n\t\t\tprops.clientId,\n\t\t\t{\n\t\t\t\twrapperUse: false,\n\t\t\t\twrapperNoControls: true,\n\t\t\t},\n\t\t);\n\t});\n\n\treturn (\n\t\t// ...\n\t);\n};\n"})}),"\n",(0,o.jsx)(n.p,{children:"Keep in mind this helper allows you to set any attribute that the inner block supports, so you can even set a larger paragraph size and a different color, for example."}),"\n",(0,o.jsx)(n.h3,{id:"useblockprops-and-useinnerblocksprops",children:"useBlockProps and useInnerBlocksProps"}),"\n",(0,o.jsxs)(n.p,{children:["In case the default ",(0,o.jsx)(n.code,{children:"InnerBlocks"})," limits your styling and/or layout options too much, you can opt into the newer block prop hooks to implement inner blocks as well!"]}),"\n",(0,o.jsxs)(n.p,{children:["Import the ",(0,o.jsx)(n.code,{children:"useBlockProps"})," and ",(0,o.jsx)(n.code,{children:"useInnerBlocksProps"})," hooks, configure them just like regular InnerBlocks, and spread the params into an element of your choice (",(0,o.jsx)(n.code,{children:"div"})," is recommended)."]}),"\n",(0,o.jsx)(n.p,{children:"In code, it looks something like this:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:"import { useBlockProps, useInnerBlocksProps } from '@wordpress/block-editor';\n\nexport const DemoEditor = (props) => {\n\tconst blockProps = useBlockProps();\n\tconst innerBlocksProps = useInnerBlocksProps(blockProps, {\n\t\tallowedBlocks: demoAllowedBlocks,\n\t\trenderAppender: () => <BlockInserter clientId={clientId} />,\n\t});\n\n\treturn (\n\t\t<div {...innerBlocksProps} /> // Do whatever you want with this.\n\t);\n};\n"})}),"\n",(0,o.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,o.jsxs)(n.p,{children:["The best way to understand how inner blocks work is to try to build your own block that supports inner blocks and try out various options and see what kind of results you\u2019ll get. If you ever get stuck, you can refer to the official ",(0,o.jsx)(n.a,{href:"https://eightshift.com/docs/welcome",children:"Eightshift DevKit documentation"})," or check the blocks that already have inner blocks support. These blocks are:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"accordion"}),"\n",(0,o.jsx)(n.li,{children:"accordion item"}),"\n",(0,o.jsx)(n.li,{children:"columns"}),"\n",(0,o.jsx)(n.li,{children:"column"}),"\n",(0,o.jsx)(n.li,{children:"carousel"}),"\n",(0,o.jsx)(n.li,{children:"group"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var o=t(96540);const s={},r=o.createContext(s);function i(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);